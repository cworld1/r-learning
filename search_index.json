[["index.html", "R-Learning Chapter 1 Welcome 1.1 é¡¹ç›®ä»‹ç» 1.2 é¡¹ç›®è¿è¡Œ 1.3 è´¡çŒ® 1.4 é¸£è°¢ 1.5 License", " R-Learning CWorld 2023-03-20 Chapter 1 Welcome è¿™æ˜¯å…³äº CWorld å­¦ä¹  R è¯­è¨€çš„ä¸€äº›ç¬”è®°å’Œä»£ç ã€‚ç›®å‰å·²å¼€æºï¼šGithub R-Learning 1.1 é¡¹ç›®ä»‹ç» æœ¬é¡¹ç›®ä½¿ç”¨ bookdown æ„å»ºï¼ŒåŒ…å« gitbookã€epub_book å’Œ pdf_book ä¸‰ç§æ„å»ºæˆå“ã€‚ å®é™…å­¦ä¹ ä¸Šï¼Œæˆ‘ä»¬æ›´æ¨èå°†é¡¹ç›®æ‰“åŒ…ä¸‹è½½ï¼Œæˆ–ä½¿ç”¨ git clone åˆ°æœ¬åœ°æ–¹ä¾¿éšæ—¶è¿è¡Œå®ƒä»¬çš„ä»»æ„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯åå¤ä½¿ç”¨å¤åˆ¶å’Œç²˜è´´ã€‚æœ¬ç¬”è®°çš„ R ç¬”è®°æºç é’ˆå¯¹å¤§çº²è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä½¿ç”¨æ”¯æŒæ›´å‹å¥½çš„ç¼–è¾‘å™¨ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ–¹ä¾¿è¯»è€…ç†æ¸…èŠ‚ç‚¹å…³ç³»ä¸æ•°æ®ç”Ÿæˆå§‹æœ«ã€‚è¿™é‡Œæ¨èä½¿ç”¨ RStudio æˆ– Visual Studio Codeï¼Œä½†ç†è®ºä¸Šåº”è¯¥ä¹Ÿæœ‰è®©ä½ é˜…è¯»æ›´æ„‰å¿«çš„ç¼–è¾‘å™¨ï¼Œåœ¨æ­¤ä¸åšæ•·è¿°ã€‚ 1.2 é¡¹ç›®è¿è¡Œ é¦–å…ˆè¯·ä¿è¯è‡ªå·±å·²ç»æœ‰äº† R æœ¬åœ°ç¯å¢ƒï¼Œå¹¶æŠŠ RScript åŠ å…¥äº†å…¨å±€å˜é‡ã€‚ å®‰è£…è¿è¡Œä»£ç éœ€è¦çš„åŒ…ï¼š Rscript -e &#39;install.packages(c(&quot;tidyverse&quot;, &quot;nycflights13&quot;, &quot;hexbin&quot;, &quot;gapminder&quot;, &quot;Lahman&quot;, &quot;maps&quot;, &quot;feather&quot;, &quot;ggrepel&quot;))&#39; å®‰è£…æ„å»ºæœ¬ä¹¦éœ€è¦çš„åŒ…ï¼ˆå¦‚æœä½ éœ€è¦çš„è¯ï¼‰ï¼š Rscript -e &#39;install.packages(c(&quot;markdownr&quot;, &quot;bookdown&quot;))&#39; Rscript -e &#39;tinytex::install_tinytex()&#39; å¼€å§‹æ„å»ºï¼ˆå¦‚æœä½ éœ€è¦çš„è¯ï¼‰ï¼š set -ev cd book Rscript -e &quot;bookdown::render_book(&#39;index.Rmd&#39;, &#39;bookdown::gitbook&#39;)&quot; 1.3 è´¡çŒ® ç”±äºä½œè€…åªæ˜¯ä¸ªæ­£åœ¨æµ…å­¦ R çš„åˆå­¦è€…ï¼Œæ‰€ä»¥ç¬”è®°éš¾å…å­˜åœ¨æ˜æ˜¾çº°æ¼ï¼Œè¿˜è¯·è¯»è€…ä»¬å¤šå¤šæµ·æ¶µã€‚æ­¤å¤–ï¼Œä¹Ÿæ¬¢è¿è¯¸ä½ä½¿ç”¨ PR æˆ– Issues æ¥æ”¹å–„å®ƒä»¬ã€‚ 1.4 é¸£è°¢ ä¸€äº›ç”µå­æ•™æå¯¹ä½œè€…å­¦ä¹ ä¸Šå¸®åŠ©é¢‡å¤šï¼Œæ²¡æœ‰è¿™äº›èµ„æ–™ï¼Œå°±æ²¡æœ‰è¿™éƒ¨ç¬”è®°ã€‚åœ¨æ­¤å¯¹è¿™äº›æ•™æçš„åŸä½œè€…æ·±è¡¨æ„Ÿè°¢ã€‚è¯»è€…è‹¥å¯¹æ­¤é¡¹ç›®ç¬”è®°æŠ±æœ‰ç–‘æƒ‘ï¼Œä¹Ÿå¯ä»¥ä»”ç»†é˜…è¯»ä»¥ä¸‹çš„æ•™æä»¥ä½œå¼¥è¡¥ã€‚ R for Data Science R for Data Science 2 Edition R for Data Science: Exercise Solutionsï¼ˆJeffrey Arnoldï¼‰ Modern Data Science with Rï¼ˆBenjamin S. Baumer, Daniel T. Kaplan, and Nicholas J. Hortonï¼‰ bookdown: Authoring Books and Technical Documents with R Markdownï¼ˆYihui Xieï¼‰ Text Mining with Rï¼ˆJulia Silge and David Robinsonï¼‰ Rè¯­è¨€æ•™ç¨‹ï¼ˆæä¸œé£ï¼‰ å•†ä¸šæ•°æ®åˆ†æå¸ˆ-R è¯­è¨€æ•°æ®å¤„ç†ï¼ˆYufei Zhongï¼‰ 1.5 License The MIT License. æœ¬ä½œå“é‡‡ç”¨ çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®® è¿›è¡Œè®¸å¯ã€‚ "],["introduction.html", "Chapter 2 Introduction 2.1 æ•°æ®ç§‘å­¦ 2.2 ä¸€äº›å‡†å¤‡ 2.3 æ›´å¤šå­¦ä¹ é€”å¾„ 2.4 åˆè¯† R", " Chapter 2 Introduction 2.1 æ•°æ®ç§‘å­¦ data-science.png ä¸Šå›¾å±•ç¤ºäº†ä¸€å¥—å®Œæ•´çš„æ•°æ®å¤„ç†æµç¨‹ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦å¯¼å…¥æ•°æ®ï¼Œç„¶åå¯¹å…¶è¿›è¡Œæ•´ç†ã€‚ç†è§£æ•°æ®çš„æ ¸å¿ƒå°±æ˜¯è½¬æ¢ã€å¯è§†åŒ–æ•°æ®å’Œå»ºç«‹æ¨¡å‹ã€‚æœ€åæ˜¯é€šä¿¡ï¼Œç†è§£æ•°æ®çš„æœ€ç»ˆèµ°å‘ä¸€èˆ¬æ˜¯å°†æ•°æ®çš„ä¿¡æ¯è®²è¿°æˆ–åˆ†äº«ç»™ä»–äººï¼ˆæˆ–ä½ çš„ä¸Šå¸ğŸ˜ ï¼‰ã€‚ 2.2 ä¸€äº›å‡†å¤‡ 2.2.1 å®‰è£… R è¦ä¸‹è½½ Rï¼Œéœ€è¦å‰å¾€ CRANï¼Œå³ cromprehensive R archive networkã€‚CRAN ç”±åˆ†å¸ƒåœ¨ä¸–ç•Œå„åœ°çš„ä¸€ç»„é•œåƒæœåŠ¡å™¨ç»„æˆï¼Œç”¨äºåˆ†å‘ R å’Œ R çš„æ‹“å±•åŒ…ã€‚ä¸è¦è¯•å›¾é€‰æ‹©çœ‹èµ·æ¥åœ°ç‚¹ç¦»ä½ å¾ˆè¿‘çš„é•œåƒï¼Œè€Œæ˜¯ä½¿ç”¨ äº‘é•œåƒï¼Œå®ƒä¼šè‡ªåŠ¨ä¸ºä½ æ‰¾å‡ºç­”æ¡ˆã€‚ 2.2.2 å®‰è£…ç¼–è¾‘å™¨ RStudio æ˜¯ä¸€ä¸ªç”¨äº R ç¼–ç¨‹çš„é›†æˆå¼€å‘ç¯å¢ƒæˆ– IDEã€‚ä» http://www.rstudio.com/download ä¸‹è½½å¹¶å®‰è£…å®ƒã€‚ å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ VSCodeã€Pycharm ç­‰ä»»æ„ä½ å–œæ¬¢çš„ç¼–è¾‘å™¨ã€‚æ³¨æ„é‡ç‚¹ç»ä¸æ˜¯åœ¨ç¼–è¾‘å™¨ï¼Œè€Œæ˜¯åœ¨äºä½ çš„æ€ç»´ã€çŸ¥è¯†å’Œè¿ç”¨èƒ½åŠ›ã€‚å¦‚æœä½ çš„çŸ¥è¯†å‚¨å¤‡è¿˜ä¸å¤Ÿï¼Œè¯·å°½é‡é¿å…å°è¯•é‚£äº›èŠ±é‡Œèƒ¡å“¨çš„ç¼–è¾‘å™¨ã€‚RStudio ä¸“ä¸º R å®šåˆ¶ï¼Œåœ¨æ˜“ç”¨æ€§ä¸Šæ˜¯æ¯‹åº¸ç½®ç–‘çš„ã€‚ 2.2.3 ç›¸å…³åŒ… æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€è¡Œä»£ç å®‰è£…å®Œæ•´çš„ tidyverseï¼š install.packages(&quot;tidyverse&quot;) åœ¨æˆ‘ä»¬è‡ªå·±çš„è®¡ç®—æœºä¸Šï¼Œåœ¨æ§åˆ¶å°ä¸­é”®å…¥è¯¥è¡Œä»£ç ï¼Œç„¶åæŒ‰ Enter è¿è¡Œå®ƒã€‚R å°†ä» CRAN ä¸‹è½½è½¯ä»¶åŒ…å¹¶å°†å…¶å®‰è£…åˆ°æˆ‘ä»¬çš„è®¡ç®—æœºä¸Šã€‚å¦‚æœæˆ‘ä»¬åœ¨å®‰è£…æ—¶é‡åˆ°é—®é¢˜ï¼Œè¯·ç¡®ä¿æˆ‘ä»¬å·²è¿æ¥åˆ°äº’è”ç½‘ï¼Œå¹¶ä¸” https://cloud.r-project.org/ æœªè¢«é˜²ç«å¢™æˆ–ä»£ç†é˜»æ­¢ã€‚ åœ¨æœ¬é¡¹ç›®ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª tidyverse ä¹‹å¤–çš„ä¸‰ä¸ªæ•°æ®åŒ…ï¼š install.packages(c(&quot;nycflights13&quot;, &quot;gapminder&quot;, &quot;Lahman&quot;)) è¿™äº›è½¯ä»¶åŒ…æä¾›äº†æœ‰å…³èˆªç©ºå…¬å¸èˆªç­ã€ä¸–ç•Œå‘å±•å’Œæ£’çƒçš„æ•°æ®ï¼Œæˆ‘ä»¬å°†ç”¨è¿™äº›æ•°æ®æ¥è¯´æ˜å…³é”®çš„æ•°æ®ç§‘å­¦ç†å¿µã€‚ 2.3 æ›´å¤šå­¦ä¹ é€”å¾„ R for Data Science R for Data Science: Exercise Solutions 2.4 åˆè¯† R æˆ‘ä»¬å°±ä» HelloWorld å¼€å§‹å§ï¼š print(&quot;hello world!&quot;) #&gt; [1] &quot;hello world!&quot; R é‡Œæœ‰ä¸€äº›çº¦å®šä¿—æˆçš„ä»£ç å½¢å¼ã€‚å¦‚ï¼š # å‡½æ•°åé¢å¸¦æ‹¬å· sum(c(1, 2)) # å¯¹è±¡ç›´æ¥ä¹¦å†™ iris # ä¸åŠ è½½åŒ…ç›´æ¥è°ƒç”¨ dplyr::mutate(iris) # mutate() å‡½æ•° nycflights13::flights # flights æ•°æ®é›† ä¸€äº›åŸºç¡€åŠŸèƒ½åé¢å¯èƒ½ä¸ä¼šå†åå¤æåˆ°ï¼Œä½†å®ƒä»¬é€šå¸¸å¾ˆæœ‰ç”¨ï¼š library(tidyverse) # åŠ è½½ä¹‹å‰å®‰è£…çš„åŒ… tidyverse_update() # æ›´æ–° tidyverse åŒ…å†…çš„é™„å¸¦åŒ… dput(mtcars) # æŸ¥çœ‹æ•°æ®é›†ï¼ˆå¦‚ mtcarsï¼‰çš„æ›´å¤šä¿¡æ¯ sessionInfo(c(&quot;tidyverse&quot;)) # æŸ¥çœ‹æœ¬åœ° R åŠç›¸å…³ä¿¡æ¯ å¯¹ä»»ä½•ä¸œè¥¿å‰é¢åŠ ä¸€ä¸ªé—®å·ï¼Œæ–¹ä¾¿ä½ æŸ¥è¯¢è¿™äº›å‡½æ•°ã€åŒ…çš„ç›¸å…³ä¿¡æ¯ï¼ä¸è¦åå•¬å¯¹ R çš„å‘é—®ï¼Œå› ä¸ºåªæœ‰è¿™æ ·åšï¼Œä½ æ‰ä¼šçœ‹é€å®ƒçš„æ¯ä¸€ä¸ªå‚æ•°å’Œç”¨æ³•ã€‚ ?sum # æŸ¥è¯¢ sum å‡½æ•° "],["explore-intro.html", "Chapter 3 Introduction 3.1 åŸºæœ¬æ•°æ®å½¢å¼å’Œå‡½æ•° 3.2 å­¦ä¹  R è‡ªå¸¦çš„ç”»å›¾åŠŸèƒ½ 3.3 æ›´é«˜çº§çš„æ•°æ®å½¢å¼", " Chapter 3 Introduction å°½å¿«æŒæ¡æ•°æ®æ¢ç´¢çš„åŸºæœ¬å·¥å…·æ˜¯æ¢ç©¶è¯­è¨€çš„ç¬¬ä¸€è¦ä¹‰ã€‚æ•°æ®æ¢ç´¢çš„ç›®æ ‡æ˜¯ç”Ÿæˆè®¸å¤šæœ‰å‰é€”çš„æ½œåœ¨ä¿¡æ¯ï¼Œä¾¿äºä»¥åæ›´æ·±å…¥åœ°æ¢ç´¢å®ƒä»¬ã€‚ data-science-explore å¯è§†åŒ–æ˜¯ R ç¼–ç¨‹çš„é‡è¦éƒ¨åˆ†ï¼šåˆ¶ä½œä¼˜é›…ä¸”ä¿¡æ¯ä¸°å¯Œçš„ç»˜å›¾ï¼Œä»¥å¸®åŠ©ç†è§£æ•°æ®ã€‚å­¦ä¹  ggplot2 ç»˜å›¾çš„åŸºæœ¬ç»“æ„ï¼Œå°†æ•°æ®è½¬æ¢ä¸ºç»˜å›¾ã€‚ åœ¨æ•°æ®è½¬æ¢ä¸­ï¼Œä½¿ç”¨å…³é”®è°“è¯å…è®¸æˆ‘ä»¬é€‰æ‹©é‡è¦å˜é‡ã€ç­›é€‰å‡ºå…³é”®è§‚å¯Ÿç»“æœã€åˆ›å»ºæ–°å˜é‡å’Œè®¡ç®—æ‘˜è¦ã€‚ å»ºæ¨¡æ˜¯æ¢ç´¢è¿‡ç¨‹çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä½†è¿™å¹¶ä¸æ˜¯å½“ä¸‹èƒ½å¤Ÿå¼„æ¸…çš„ï¼Œå®ƒä¼šåœ¨ä»¥åçš„å­¦ä¹ ä¸­é€æ¸æ·±å…¥ã€‚ åœ¨å·¥ä½œæµä¸­ï¼šâ€œåŸºç¡€çŸ¥è¯†â€ã€â€œå·¥ä½œæµï¼šè„šæœ¬â€ å’Œ â€œå·¥ä½œæµï¼šé¡¹ç›®â€ï¼Œä½ å°†å­¦ä¹ ç¼–å†™å’Œç»„ç»‡ R ä»£ç çš„è‰¯å¥½å®è·µã€‚ ä»¥ä¸‹ä¸ºé™„åŠ å†…å®¹ï¼Œå› ä¸ºå·²çŸ¥èµ„æ–™ä¸Šè²Œä¼¼æ²¡æœ‰æåˆ°ã€‚ 3.1 åŸºæœ¬æ•°æ®å½¢å¼å’Œå‡½æ•° 3.1.1 å‘é‡ã€çŸ©é˜µä¸åˆ—è¡¨ åˆ›å»ºå·²çŸ¥æˆ–æœªçŸ¥çš„ç©ºå‘é‡ç”¨äºå­˜å‚¨ä¸€ç³»åˆ—æ•°æ®ï¼ˆå¦‚æ•´æ•°ã€å°æ•°ã€å­—ç¬¦ä¸²ï¼‰ã€‚ x &lt;- vector() # åˆ›å»ºç©ºå‘é‡ y &lt;- c(1, 2) # æ‰‹åŠ¨èµ‹å€¼ # åœ¨ R ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ â€œ:â€ æ¥åˆ›å»ºåºåˆ—å¡«å…… z &lt;- c(1:3) # è¿™é‡Œå…¶å®ç­‰ä»·äº 1, 2, 3 çŸ©é˜µæœ‰ç‚¹åƒæˆ‘ä»¬å­¦çš„è¡¨æ ¼ï¼Œè¿™ç§æ•°æ®ç»“æ„å¾ˆç±»ä¼¼äºå…¶å®ƒè¯­è¨€ä¸­çš„äºŒç»´æ•°ç»„ã€‚æ³¨æ„ä½¿ç”¨ t() å¯ä»¥è¡Œåˆ—äº’æ¢ã€‚ Matrix_transpose rownames &lt;- c(&quot;row1&quot;, &quot;row2&quot;, &quot;row3&quot;, &quot;row4&quot;) colnames &lt;- c(&quot;col1&quot;, &quot;col2&quot;, &quot;col3&quot;) m &lt;- matrix( data = c(3:14), # nrow = 4, # è®¾ç½®è¡Œæ•°ã€‚å¦‚æœä¸çŸ¥é“æ•°æ®æœ‰å¤šå°‘å…¶å®å¯ä»¥ä¸è®¾ç½® ncol = 3, # è®¾ç½®åˆ—å®½ byrow = TRUE, # è®¾ç½®ä¸º TRUE å³æŒ‰è¡Œæ’åˆ—ï¼Œåä¹‹åˆ™æŒ‰åˆ—æ’ dimnames = list(rownames, colnames) # è®¾ç½®è¡Œå’Œåˆ—çš„æ ‡é¢˜ï¼Œé»˜è®¤ä¸º NULL ) m #&gt; col1 col2 col3 #&gt; row1 3 4 5 #&gt; row2 6 7 8 #&gt; row3 9 10 11 #&gt; row4 12 13 14 t(m) #&gt; row1 row2 row3 row4 #&gt; col1 3 6 9 12 #&gt; col2 4 7 10 13 #&gt; col3 5 8 11 14 åˆ—è¡¨ä½¿ç”¨ list() åˆ›å»ºã€‚ä¸€ä¸ªåˆ—è¡¨é‡Œå¯ä»¥éšæ„æ”¾ç½®å‘é‡é‡Œèƒ½æ”¾ç½®çš„æ‰€æœ‰å…ƒç´ ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªå‘é‡ã€ä¸€ä¸ªçŸ©é˜µã€‚ list_data &lt;- list( &quot;google&quot;, matrix(c(1, 2, 3, 4, 5, 6), nrow = 2), 123.1, c(1:5) ) # è¯»å–å…ƒç´  list_data[[1]] # æ³¨æ„ä¸­æ‹¬å·åº”è¯¥ç”¨ä¸¤å±‚æ¥è·å–å¯¹åº”å…ƒç´ ã€‚ä½†å¦‚æœåªç”¨ä¸€å±‚ï¼ŒR ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä¿®æ­£ names(list_data) &lt;- c(&quot;Sites&quot;, &quot;Numbers&quot;, &quot;Lists&quot;) # ä½¿ç”¨ names() æ¥èµ‹å€¼åç§° list_data$Sites # æœ‰åç§°åå¯ä»¥ç”¨ $xx æ¥è¯»å–å¯¹åº”çš„åˆ—å…ƒç´  # æ·»åŠ  / æ›´æ–°å…ƒç´  list_data[5] &lt;- &quot;æ–°å…ƒç´ &quot; # åˆ é™¤å…ƒç´  list_data[4] &lt;- NULL # åˆå¹¶ / è½¬æ¢åˆ—è¡¨ num_list &lt;- list(1, 2) merged_list &lt;- c(num_list, list_data) # åˆå¹¶ unlist(num_list) # è½¬æ¢åˆ—è¡¨ä¸ºå‘é‡ 3.1.2 åŸºæœ¬å‡½æ•° æ•°æ®é›†å¦‚ä¸‹ï¼š age &lt;- c(10, 12, 14, 6, 8, 18) weight &lt;- c(100, 110, 120, 80, 90, 140) æ•°å­¦ä¸­ä¸€äº›å¸¸ç”¨çš„è®¡ç®—å‡½æ•° 5 %% 3 # æ±‚ä½™æ•° #&gt; [1] 2 5 %/% 3 # æ±‚æ¨¡ #&gt; [1] 1 mean(age) # æ±‚å¹³å‡å€¼ #&gt; [1] 11.33333 sd(age) # æ±‚æ ‡å‡†å·® #&gt; [1] 4.320494 cor(age, weight) # æ±‚ç›¸å…³åº¦ï¼Œæ•°å€¼åœ¨ -1 åˆ° 1ï¼Œå…¶ä¸­ 1 æ˜¯ç»å¯¹æ­£ç›¸å…³ï¼Œ0 æ˜¯å®Œå…¨ä¸ç›¸å…³ï¼Œ-1 æ˜¯ç»å¯¹è´Ÿç›¸å…³ #&gt; [1] 1 lm(age ~ weight) # æ±‚ä¸¤è€…æ„æˆçš„å›å½’ç›´çº¿æ–œç‡ï¼ˆæ³¨æ„æ³¢æµªå·è¿æ¥ï¼‰ #&gt; #&gt; Call: #&gt; lm(formula = age ~ weight) #&gt; #&gt; Coefficients: #&gt; (Intercept) weight #&gt; -10.0 0.2 3.2 å­¦ä¹  R è‡ªå¸¦çš„ç”»å›¾åŠŸèƒ½ åœ¨ R é‡Œç”»å›¾éå¸¸ç®€å•ã€‚ä»¥ä¸Šé¢çš„ age å’Œ weight ä¸ºä¾‹ï¼š # æ³¨æ„åœ¨ R é‡Œé¢ï¼Œç›¸å¯¹è·¯å¾„çš„åŸºå±‚è·¯å¾„æ˜¯ç”±å·¥ä½œåŒºè®¾å®šçš„ getwd() # è·å–å½“å‰å·¥ä½œåŒºè·¯å¾„ setwd(&quot;D:/Project/R-Project/&quot;) # è®¾ç½®å·¥ä½œåŒºè·¯å¾„ png(&quot;./data/mygraph.png&quot;) # è®¾ç½®å¥½åå°±å¯ä»¥å­˜å‚¨åˆ°ç†æƒ³ä½ç½® plot(age, weight) # ç»˜åˆ¶æ•£ç‚¹å›¾ abline(lm(age ~ weight)) # ç»˜åˆ¶å›å½’ç›´çº¿ title(&quot;å¹´é¾„ - ä½“é‡å›¾&quot;) # æ·»åŠ  # æ·»åŠ  # æ·»åŠ æ ‡é¢˜ dev.off() # ç»“æŸç”»å›¾å¹¶ä¿å­˜ å®é™…è¿è¡Œç”Ÿæˆçš„å›¾ï¼š mygraph 3.3 æ›´é«˜çº§çš„æ•°æ®å½¢å¼ dataframe æ˜¯ä¸€ç³»åˆ—å‘é‡æ•°æ®çš„é›†åˆï¼š data.frame( a = c(1:3), b = c(6:8) ) #&gt; a b #&gt; 1 1 6 #&gt; 2 2 7 #&gt; 3 3 8 tibble ä¸ dataframe éå¸¸ç›¸ä¼¼ï¼Œç”šè‡³æ˜¯ä½¿ç”¨ dataframe å‚¨å­˜çš„ã€‚tibble æ˜¯ tidyverse ç³»åˆ—çš„ä¸“ç”¨æ•°æ®é›†æ ¼å¼ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯å¹²å‡€ã€æ–¹ä¾¿æ•°æ®å¤„ç†ã€‚ library(tidyverse) # ä½ å¯ä»¥è·Ÿ data.frame ä¸€æ ·ç›´æ¥åŠ å…¥æ•°ç»„ï¼š tibble( sex = c(&quot;male&quot;, &quot;female&quot;, &quot;male&quot;), response = c(1, 2, 1) ) #&gt; # A tibble: 3 Ã— 2 #&gt; sex response #&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 male 1 #&gt; 2 female 2 #&gt; 3 male 1 # ä¹Ÿå¯ä»¥åƒæ˜¯æ­£å¸¸ä¹¦å†™è¡¨æ ¼é‚£æ ·ï¼ tribble( ~sex, ~response, &quot;male&quot;, 1, &quot;female&quot;, 2, &quot;male&quot;, 1 ) #&gt; # A tibble: 3 Ã— 2 #&gt; sex response #&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 male 1 #&gt; 2 female 2 #&gt; 3 male 1 "],["data-visualisation.html", "Chapter 4 Data visualisation 4.1 åˆè¯† ggplot 4.2 ç¾å­¦æ˜ å°„ 4.3 ä¿®æ”¹æ ·å¼ 4.4 å¤šç»„ç”»å›¾ 4.5 å åŠ ä¸å‚æ•° 4.6 å…¶ä»–å¸¸è§å›¾ 4.7 åæ ‡ç³»ç›¸å…³ 4.8 ç»˜åˆ¶ diamonds æ•°æ®åˆ†æå›¾ 4.9 ç ”ç©¶ mpgcars æ•°æ®é›†", " Chapter 4 Data visualisation library(tidyverse) # æ–¹ä¾¿ä½¿ç”¨å…¶ä¸­çš„ ggplot2 4.1 åˆè¯† ggplot view(mpg) # ä½¿ç”¨ view() å‡½æ•°å¯ä»¥æ–¹ä¾¿è§‚å¯Ÿå¯¹åº”æ•°æ®é›† head(mpg) # å¯ä»¥åœ¨æ§åˆ¶å°æ‰“å°æ•°æ®é›†å¤´éƒ¨ä¿¡æ¯ï¼ˆå‰åè¡Œï¼‰ #&gt; # A tibble: 6 Ã— 11 #&gt; manufacturer model displ year cyl trans drv cty hwy fl class #&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 audi a4 1.8 1999 4 auto(l5) f 18 29 p compaâ€¦ #&gt; 2 audi a4 1.8 1999 4 manual(m5) f 21 29 p compaâ€¦ #&gt; 3 audi a4 2 2008 4 manual(m6) f 20 31 p compaâ€¦ #&gt; 4 audi a4 2 2008 4 auto(av) f 21 30 p compaâ€¦ #&gt; 5 audi a4 2.8 1999 6 auto(l5) f 16 26 p compaâ€¦ #&gt; 6 audi a4 2.8 1999 6 manual(m5) f 18 26 p compaâ€¦ åˆ— displï¼šæ±½è½¦çš„å‘åŠ¨æœºå°ºå¯¸ï¼Œä»¥å‡ä¸ºå•ä½ã€‚ åˆ— hwyï¼šæ±½è½¦åœ¨é«˜é€Ÿå…¬è·¯ä¸Šçš„ç‡ƒæ²¹æ•ˆç‡ï¼Œä»¥è‹±é‡Œ / åŠ ä»‘ï¼ˆmpgï¼‰ä¸ºå•ä½ ggplot(data = mpg) + # ç»Ÿä¸€è®¾ç½®æƒ³è¦å¤„ç†çš„æ•°æ®é›† # ç»˜åˆ¶ pointï¼Œmapping å±æ€§ç”¨æ¥è®¾ç½®ç›¸å…³çš„ x è½´å’Œ y è½´å‚æ•° geom_point(mapping = aes(x = displ, y = hwy)) 4.2 ç¾å­¦æ˜ å°„ ä½¿ç”¨é¢œè‰²æ˜ å°„ï¼š ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, color = class)) ä½¿ç”¨å¤§å°æ˜ å°„ï¼ˆä¸å»ºè®®ï¼‰ï¼š ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, size = class)) #&gt; Warning: Using size for a discrete variable is not advised. ä½¿ç”¨å½¢çŠ¶æ˜ å°„ï¼ˆæ³¨æ„æœ€å¤šåªæ”¯æŒ 6 ç§ï¼‰ï¼š ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, shape = class)) #&gt; Warning: The shape palette can deal with a maximum of 6 discrete values because #&gt; more than 6 becomes difficult to discriminate; you have 7. Consider #&gt; specifying shapes manually if you must have them. #&gt; Warning: Removed 62 rows containing missing values (`geom_point()`). ä½¿ç”¨é€æ˜åº¦æ˜ å°„ï¼ˆä¸å»ºè®®ï¼‰ï¼š ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, alpha = class)) #&gt; Warning: Using alpha for a discrete variable is not advised. 4.3 ä¿®æ”¹æ ·å¼ ä¾‹å¦‚é¢œè‰²ï¼š ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy), color = &quot;blue&quot;) æ”¯æŒå‚æ•°ï¼šcolorï¼Œshapeï¼Œfillï¼Œstrokeï¼ˆç‚¹çš„ç²—ç»†ï¼‰ï¼Œlinetype ç­‰ã€‚åŒæ—¶ï¼Œæ ·å¼å‚æ•°æ”¯æŒå˜é‡ã€‚æ³¨æ„ shape å¡«å†™æ—¶æ˜¯å¡«å†™æ•°å­—ï¼Œæœ‰ 21 ç§ã€‚ R æœ‰ 25 ä¸ªå†…ç½®å½¢çŠ¶ï¼Œè¿™äº›å½¢çŠ¶ç”±æ•°å­—æ ‡è¯†ã€‚æœ‰ä¸€äº›çœ‹ä¼¼é‡å¤çš„ï¼šä¾‹å¦‚ï¼Œ0ã€15 å’Œ 22 éƒ½æ˜¯æ­£æ–¹å½¢ã€‚ä¸åŒä¹‹å¤„åœ¨äºâ€œé¢œè‰²â€å’Œâ€œå¡«å……â€ç¾å­¦çš„ç›¸äº’ä½œç”¨ã€‚ç©ºå¿ƒå½¢çŠ¶ï¼ˆ0â€“14ï¼‰å…·æœ‰ç”±â€œé¢œè‰²â€ç¡®å®šçš„è¾¹æ¡†;å›ºä½“å½¢çŠ¶ï¼ˆ15â€“20ï¼‰å¡«å……æœ‰â€œé¢œè‰²â€;å¡«å……çš„å½¢çŠ¶ï¼ˆ21â€“24ï¼‰å…·æœ‰â€œé¢œè‰²â€è¾¹æ¡†ï¼Œå¹¶ç”¨â€œå¡«å……â€å¡«å……å¡«å……ã€‚ 4.4 å¤šç»„ç”»å›¾ ç®€å•åˆ†ç»„ï¼ˆåˆ†ç‰‡ï¼‰ï¼š ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_wrap(~class, nrow = 3) # ä»¥ class åˆ†ç±»ï¼Œä¸‰åˆ—ï¼Œä¸é™åˆ¶è¡Œ è‡ªå®šä¹‰æ¡ä»¶åˆ†ç»„ï¼š ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_grid(drv ~ cyl) # ä»¥ drv ä¸º x è½´ï¼Œcyl ä¸º y è½´ 4.5 å åŠ ä¸å‚æ•° mapping ä¸ºé»˜è®¤æ¥æ”¶å†…å®¹ï¼Œå¯ä»¥çœç•¥ï¼š ggplot(data = mpg) + geom_point(aes(x = displ, y = hwy)) + geom_smooth(aes(x = displ, y = hwy)) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; å…¶ä¸­ mapping å†™åœ¨åŸºæœ¬é…ç½®é¡¹ä¸­ï¼Œæ–¹ä¾¿ç»˜å›¾è‡ªåŠ¨è°ƒç”¨ ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + geom_point() + geom_smooth() #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; ç»˜å›¾æ—¶ä½¿ç”¨è‡ªå®šä¹‰ data è¦†ç›–é»˜è®¤ data é…ç½®ï¼ˆfilter ä¸ºç­›é€‰æ•°æ®ï¼‰ï¼š ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + geom_point(color = &quot;blue&quot;) + geom_smooth(data = filter(mpg, class == &quot;subcompact&quot;)) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; 4.6 å…¶ä»–å¸¸è§å›¾ 4.6.1 å›å½’æ›²çº¿å›¾ å›å½’æ›²çº¿æœ‰å®ƒä¸“é—¨çš„é…ç½®é¡¹ï¼Œå…¶ä¸­ show legend ç”¨äºæ§åˆ¶ç°å®å›¾ä¾‹æ˜¾ç¤ºä¸å¦ï¼Œse æ§åˆ¶è‡ªä¿¡æŒ‡æ•°ï¼ˆåŠé€æ˜å¸¦ï¼‰æ˜¾ç¤ºä¸å¦ï¼š ggplot(data = mpg) + geom_smooth( mapping = aes(x = displ, y = hwy, color = drv), show.legend = FALSE, se = FALSE ) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; 4.6.2 æ¡å½¢å›¾ ggplot(data = diamonds) + geom_bar(mapping = aes(x = cut, colour = cut)) # colour ä¸ºæè¾¹é¢œè‰² ggplot(data = diamonds) + geom_bar(mapping = aes(x = cut, fill = cut)) # fill ä¸ºå¡«å……é¢œè‰² ä½†å¦‚æœ fill ä½¿ç”¨çš„æ˜¯å…¶ä»–å˜é‡ï¼Œä¼šå¯¼è‡´ä¸åŒæ•°æ®é‡å é®æŒ¡ ggplot(data = diamonds) + geom_bar(mapping = aes(x = cut, fill = clarity)) è§£å†³æ–¹æ¡ˆ 1ï¼šé™ä½é€æ˜åº¦ ggplot(data = diamonds, mapping = aes(x = cut, fill = clarity)) + geom_bar(alpha = 1 / 5, position = &quot;identity&quot;) è§£å†³æ–¹æ¡ˆ 2ï¼šç›´æ¥æ”¹ä¸º colour æ ·å¼ï¼Œå¹¶å°† fill è®¾ç½®ä¸º NA ggplot(data = diamonds, mapping = aes(x = cut, colour = clarity)) + geom_bar(fill = NA, position = &quot;identity&quot;) è§£å†³æ–¹æ¡ˆ 3ï¼šposition æ”¹ç”¨ fill ä¸ºé¢‘ç‡å›¾ï¼ˆæ–¹ä¾¿è§‚å¯Ÿæ¯”ä¾‹ï¼‰ ggplot(data = diamonds, mapping = aes(x = cut, fill = clarity)) + geom_bar(position = &quot;fill&quot;) è§£å†³æ–¹æ¡ˆ 4ï¼šposition æ”¹ç”¨ dodge ä¸ºåˆ†æŸ±å›¾ ggplot(data = diamonds, mapping = aes(x = cut, fill = clarity)) + geom_bar(position = &quot;dodge&quot;) 4.6.3 Summary çº¿æ¡ä¿¡æ¯å›¾ è¿™ç§å›¾ä¸å¤ªå¸¸ç”¨ï¼Œå› ä¸º boxplot å›¾æ‹¥æœ‰å®ƒçš„æ‰€æœ‰ç‰¹æ€§ï¼Œç”šè‡³åšå¾—æ›´å¥½ï¼š ggplot(data = diamonds) + stat_summary( mapping = aes(x = cut, y = depth), fun.max = max, # ä¸Šé™æœ€å¤§å€¼ fun.min = min, # ä¸‹é™ä¸ºæœ€å°å€¼ fun.y = mean # æ ‡ç‚¹ä¸ºå¹³å‡æ•° ) #&gt; Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0. #&gt; â„¹ Please use the `fun` argument instead. #&gt; This warning is displayed once every 8 hours. #&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #&gt; generated. 4.7 åæ ‡ç³»ç›¸å…³ å¯¹è°ƒåæ ‡è½´ï¼š ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + geom_boxplot() + coord_flip() æ ¹æ®ç›¸å…³å›¾åƒé™åˆ¶å›¾å½¢çš„çºµæ¨ªæ¯”ä¾‹ï¼š nz &lt;- map_data(&quot;nz&quot;) # ä» map_data é‡Œè°ƒç”¨æŸå›½çš„åœ°å›¾ ggplot(nz, aes(long, lat, group = group)) + geom_polygon(fill = &quot;white&quot;, colour = &quot;black&quot;) + coord_quickmap() # è¿™é‡Œä¼šä½¿å›¾è¡¨ä»¥æ­£ç¡®çš„æ¨ªçºµæ¯”æ˜¾ç¤ºï¼Œé˜²æ­¢å›¾åƒæ‹‰ä¼¸æ‰­æ›² æåæ ‡åŒ–ï¼š ggplot(data = diamonds) + geom_bar( mapping = aes(x = cut, fill = cut), show.legend = FALSE, # éšè—å›¾ä¾‹ï¼ŒåŸå› æ˜¯ x è½´é»˜è®¤å·²ç»å¸¦æŒ‡ç¤ºäº† width = 1 ) + coord_polar() # è®¾ç½®ä¸ºæåæ ‡ï¼ˆæœ‰ç‚¹åƒåœ†é¥¼å›¾ï¼‰ 4.8 ç»˜åˆ¶ diamonds æ•°æ®åˆ†æå›¾ åŸé¢˜ç›®ï¼šRecreate the R code necessary to generate the following graphs. å»ºç«‹åˆ—è¡¨ï¼Œç»˜åˆ¶å¥½ 6 å¼ å›¾å¹¶è£…é…è¿›å»ï¼š p &lt;- list() p[[1]] &lt;- ggplot(mpg, aes(x = displ, y = hwy)) + geom_point() + geom_smooth(se = FALSE) # æ³¨æ„åŒ…å«å›å½’æ›²çº¿ p[[2]] &lt;- ggplot(mpg, aes(x = displ, y = hwy)) + geom_smooth(mapping = aes(group = drv), se = FALSE) + # ä»¥ drv åˆ†ç»„ä½œå‡ºå¤šæ¡å›å½’çº¿ geom_point() p[[3]] &lt;- ggplot(mpg, aes(x = displ, y = hwy, colour = drv)) + # å…¨å±€ä»¥ drv åˆ†ç±»æ·»åŠ ç€è‰² geom_point() + geom_smooth(se = FALSE) p[[4]] &lt;- ggplot(mpg, aes(x = displ, y = hwy)) + geom_point(aes(colour = drv)) + geom_smooth(se = FALSE) # å¦‚æœåªè¦æ€»çš„å›å½’çº¿ï¼Œå°±ä¸è¦æŠŠ colour å˜é‡å¯¹ smooth è¿›è¡Œåº”ç”¨ p[[5]] &lt;- ggplot(mpg, aes(x = displ, y = hwy)) + geom_point(aes(colour = drv)) + geom_smooth(aes(linetype = drv), se = FALSE) # ä¸ä»¥é¢œè‰²åˆ†ç»„ç±»ä¼¼ï¼Œè¿™é‡Œåªæ˜¯æ”¹ç”¨çº¿æ¡æ ·å¼ p[[6]] &lt;- ggplot(mpg, aes(x = displ, y = hwy)) + geom_point(size = 4, color = &quot;white&quot;) + geom_point(aes(colour = drv)) # è¿™é‡Œæ˜¯ä¸¤å¹…éå¸¸ç›¸ä¼¼çš„å›¾é‡å çš„æ•ˆæœã€‚æ³¨æ„åç”»çš„å›¾ä¼˜å…ˆæ˜¾ç¤º éšå³ä½¿ç”¨å¸ƒå±€é€å¼ å±•ç¤ºï¼š library(grid) # å¼•ç”¨ä¸€ä¸‹å¸ƒå±€åŒ… grid.newpage() # æ–°å»ºå¸ƒå±€åŒ… pushViewport(viewport(layout = grid.layout(3, 2))) # è®¾ç½® 2x3 å¸ƒå±€ print(p[[1]], vp = viewport(layout.pos.row = 1, layout.pos.col = 1)) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; print(p[[2]], vp = viewport(layout.pos.row = 1, layout.pos.col = 2)) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; print(p[[3]], vp = viewport(layout.pos.row = 2, layout.pos.col = 1)) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; print(p[[4]], vp = viewport(layout.pos.row = 2, layout.pos.col = 2)) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; print(p[[5]], vp = viewport(layout.pos.row = 3, layout.pos.col = 1)) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; print(p[[6]], vp = viewport(layout.pos.row = 3, layout.pos.col = 2)) 4.9 ç ”ç©¶ mpgcars æ•°æ®é›† ä»”ç»†è§‚å¯Ÿæ•°æ®é›†ä¼šå‘ç° displ å’Œ hwy æ˜¯ç»è¿‡å››èˆäº”å…¥çš„ï¼Œåœ¨å®é™…å›¾è¡¨ä¸Šå¾ˆå¤šç‚¹ä¼šäº§ç”Ÿé‡å ï¼š ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + geom_point(alpha = 1 / 5) å¯¹ position æ·»åŠ  jitter å€¼å¯ä»¥æ‰‹åŠ¨æ·»åŠ  â€œæ•°æ®å™ªç‚¹â€ï¼Œä»è€Œæ›´å¥½åœ°çœ‹åˆ°æ•°æ®å…¨è²Œï¼ˆå°½ç®¡ä¼šæ”¹å˜æ•°å€¼å¯¼è‡´å›¾è¡¨ä¸é‚£ä¹ˆå‡†ç¡®ï¼‰ï¼š ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy), position = &quot;jitter&quot;) "],["workflow-basics.html", "Chapter 5 Workflow: basics", " Chapter 5 Workflow: basics åœ¨ R é‡Œï¼Œä½ ç”šè‡³èƒ½å½“è®¡ç®—å™¨ï¼š 1 / 200 * 30 #&gt; [1] 0.15 (59 + 73 + 2) / 3 #&gt; [1] 44.66667 sin(pi / 2) #&gt; [1] 1 æ³¨æ„èµ‹å€¼è¯­å¥åº”å½“ç”¨ â€œ&lt;-â€ï¼š x &lt;- 3 * 4 b &lt;- x â€œ=â€ ç”¨äºå®šä¹‰å‡½æ•°æ‰€æŒ‡å®šçš„å‚æ•°ã€‚è™½ç„¶é”™è¯¯çš„ä¹¦å†™ä¸ä¼šå¯¼è‡´æŠ¥é”™ï¼Œä½†å¯¹äºä»£ç çš„é˜…è¯»é‡å½±å“é¢‡å¤§ã€‚ å‘½åä¸Šï¼ŒR ä¸€èˆ¬ä½¿ç”¨å­—æ¯å¼€å¤´ï¼Œå­—ç¬¦åªèƒ½ä½¿ç”¨ â€œ.â€ å’Œ â€œ_â€ï¼š i_use_snake_case # æ¨èçš„å‘½åæ³•åˆ™ otherPeopleUseCamelCase some.people.use.periods æ­¤å¤–ï¼ŒR å…è®¸åœ¨èµ‹å€¼è¯­å¥æ‰“æ‹¬å·ç”¨äºè¿”å›èµ‹å€¼å†…å®¹ã€‚è¿™ä¸ C è¯­è¨€éå¸¸ç±»ä¼¼ï¼š (y &lt;- seq(1, 10, length.out = 5)) # è¿”å›ä¸€ä¸ªå‘é‡ï¼Œå…ƒç´ å‡åŒ€åœ°åˆ†å¸ƒä» 1 åˆ° 10ï¼Œå…± 5 ä¸ª #&gt; [1] 1.00 3.25 5.50 7.75 10.00 "],["transform.html", "Chapter 6 Data transformation 6.1 æŸ¥çœ‹ flights æ•°æ®é›† 6.2 è¿‡æ»¤ filter() 6.3 æ’åˆ— arange() 6.4 é€‰æ‹© select() 6.5 é‡å‘½å rename() 6.6 æ·»åŠ æ–°å˜é‡ mutate() ä¸ transmute() 6.7 åˆ†ç»„æ‘˜è¦ summarise() 6.8 å…¶ä»–å¤„ç†æ•°æ®åŠŸèƒ½ 6.9 åˆ†æ flights æ•°æ®é›†", " Chapter 6 Data transformation å¯è§†åŒ–æ˜¯ç”Ÿæˆå¯ä»¥ç›´æ¥è§‚å¯Ÿçš„æ•°æ®å±•ç¤ºå½¢å¼çš„é‡è¦å·¥å…·ï¼Œä½†æˆ‘ä»¬å´å¾ˆå°‘èƒ½ä»¥æ‰€éœ€çš„æ­£ç¡®å½¢å¼è·å–æ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦åˆ›å»ºä¸€äº›æ–°çš„å˜é‡æˆ–æ‘˜è¦ï¼Œæˆ–æ˜¯çº¯ç²¹åœ°åªæƒ³é‡å‘½åå˜é‡æˆ–å¯¹è§‚æµ‹å€¼é‡æ–°æ’åºã€‚ library(nycflights13) library(tidyverse) 6.1 æŸ¥çœ‹ flights æ•°æ®é›† åœ¨åé¢çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æŒç»­å…³æ³¨æ¥è‡ª nycflights13 çš„æ•°æ®é›† flightsã€‚ å®ƒåŒ…å« 2013 å¹´ä»çº½çº¦å¸‚å‡ºå‘çš„å…± 336,776 ä¸ªèˆªç­ã€‚ flights #&gt; # A tibble: 336,776 Ã— 19 #&gt; year month day dep_time sched_deâ€¦Â¹ dep_dâ€¦Â² arr_tâ€¦Â³ schedâ€¦â´ arr_dâ€¦âµ carrier #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 2013 1 1 517 515 2 830 819 11 UA #&gt; 2 2013 1 1 533 529 4 850 830 20 UA #&gt; 3 2013 1 1 542 540 2 923 850 33 AA #&gt; 4 2013 1 1 544 545 -1 1004 1022 -18 B6 #&gt; 5 2013 1 1 554 600 -6 812 837 -25 DL #&gt; 6 2013 1 1 554 558 -4 740 728 12 UA #&gt; 7 2013 1 1 555 600 -5 913 854 19 B6 #&gt; 8 2013 1 1 557 600 -3 709 723 -14 EV #&gt; 9 2013 1 1 557 600 -3 838 846 -8 B6 #&gt; 10 2013 1 1 558 600 -2 753 745 8 AA #&gt; # â€¦ with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, #&gt; # origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, #&gt; # minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names #&gt; # Â¹â€‹sched_dep_time, Â²â€‹dep_delay, Â³â€‹arr_time, â´â€‹sched_arr_time, âµâ€‹arr_delay åˆ—åç§°ä¸‹å­—æ¯ç¼©å†™ä»£è¡¨è¯¥åˆ—çš„æ•°æ®ç±»å‹ï¼š - intï¼šæ•´æ•° - dblï¼šåŒç²¾åº¦æˆ–å®æ•° - chrï¼šå­—ç¬¦å‘é‡æˆ–å­—ç¬¦ä¸² - dttmï¼šæ—¥æœŸæ—¶é—´ï¼ˆæ—¥æœŸ + æ—¶é—´ï¼‰ æ­¤å¤–è¿˜æœ‰ï¼š - lglï¼šä»…åŒ…å«é€»è¾‘è¯ï¼ˆTRUE / FALSEï¼‰ - fctrï¼šå› å­ï¼ˆfactorï¼‰ï¼Œè¡¨ç¤ºå…·æœ‰å›ºå®šå¯èƒ½å€¼çš„åˆ†ç±»å˜é‡ - dateï¼šæ—¥æœŸ tidyverse è¿˜é™„å¸¦äº†ä¸€äº›ç¥å¥‡çš„åŠŸèƒ½ï¼Œå¦‚ filterã€arrangeã€selectã€renameã€mutate å’Œ summarise ç­‰ã€‚ä¸‹é¢æˆ‘ä»¬å°†é€ä¸ªå­¦ä¹ å®ƒä»¬ã€‚ 6.2 è¿‡æ»¤ filter() # ç­›é€‰æœˆä»½ä¸º 1ï¼Œå¤©æ•°ä¸º 1 çš„ filter(flights, month == 1, day == 1) #&gt; # A tibble: 842 Ã— 19 #&gt; year month day dep_time sched_deâ€¦Â¹ dep_dâ€¦Â² arr_tâ€¦Â³ schedâ€¦â´ arr_dâ€¦âµ carrier #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 2013 1 1 517 515 2 830 819 11 UA #&gt; 2 2013 1 1 533 529 4 850 830 20 UA #&gt; 3 2013 1 1 542 540 2 923 850 33 AA #&gt; 4 2013 1 1 544 545 -1 1004 1022 -18 B6 #&gt; 5 2013 1 1 554 600 -6 812 837 -25 DL #&gt; 6 2013 1 1 554 558 -4 740 728 12 UA #&gt; 7 2013 1 1 555 600 -5 913 854 19 B6 #&gt; 8 2013 1 1 557 600 -3 709 723 -14 EV #&gt; 9 2013 1 1 557 600 -3 838 846 -8 B6 #&gt; 10 2013 1 1 558 600 -2 753 745 8 AA #&gt; # â€¦ with 832 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, #&gt; # origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, #&gt; # minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names #&gt; # Â¹â€‹sched_dep_time, Â²â€‹dep_delay, Â³â€‹arr_time, â´â€‹sched_arr_time, âµâ€‹arr_delay # ç­›é€‰æœˆä»½ä¸º 12 ä¸”å¤©æ•°ä¸º 25 çš„ï¼ˆåœ£è¯èŠ‚ï¼‰ filter(flights, month == 12 &amp; day == 25) #&gt; # A tibble: 719 Ã— 19 #&gt; year month day dep_time sched_deâ€¦Â¹ dep_dâ€¦Â² arr_tâ€¦Â³ schedâ€¦â´ arr_dâ€¦âµ carrier #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 2013 12 25 456 500 -4 649 651 -2 US #&gt; 2 2013 12 25 524 515 9 805 814 -9 UA #&gt; 3 2013 12 25 542 540 2 832 850 -18 AA #&gt; 4 2013 12 25 546 550 -4 1022 1027 -5 B6 #&gt; 5 2013 12 25 556 600 -4 730 745 -15 AA #&gt; 6 2013 12 25 557 600 -3 743 752 -9 DL #&gt; 7 2013 12 25 557 600 -3 818 831 -13 DL #&gt; 8 2013 12 25 559 600 -1 855 856 -1 B6 #&gt; 9 2013 12 25 559 600 -1 849 855 -6 B6 #&gt; 10 2013 12 25 600 600 0 850 846 4 B6 #&gt; # â€¦ with 709 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, #&gt; # origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, #&gt; # minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names #&gt; # Â¹â€‹sched_dep_time, Â²â€‹dep_delay, Â³â€‹arr_time, â´â€‹sched_arr_time, âµâ€‹arr_delay # ç­›é€‰å‡ºæœˆä»½ä¸º12ï¼Œå¤©æ•°ä¸º 11 æˆ–è€… 12 çš„ filter(flights, month == 12, day == 11 | day == 12) #&gt; # A tibble: 1,922 Ã— 19 #&gt; year month day dep_time sched_deâ€¦Â¹ dep_dâ€¦Â² arr_tâ€¦Â³ schedâ€¦â´ arr_dâ€¦âµ carrier #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 2013 12 11 459 500 -1 651 651 0 US #&gt; 2 2013 12 11 517 515 2 825 814 11 UA #&gt; 3 2013 12 11 542 545 -3 841 832 9 UA #&gt; 4 2013 12 11 544 540 4 838 850 -12 AA #&gt; 5 2013 12 11 544 550 -6 1021 1027 -6 B6 #&gt; 6 2013 12 11 552 600 -8 927 915 12 AA #&gt; 7 2013 12 11 552 600 -8 712 717 -5 EV #&gt; 8 2013 12 11 553 600 -7 644 701 -17 US #&gt; 9 2013 12 11 554 600 -6 753 755 -2 DL #&gt; 10 2013 12 11 554 600 -6 656 659 -3 US #&gt; # â€¦ with 1,912 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, #&gt; # origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, #&gt; # minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names #&gt; # Â¹â€‹sched_dep_time, Â²â€‹dep_delay, Â³â€‹arr_time, â´â€‹sched_arr_time, âµâ€‹arr_delay # ç­›é€‰å‡ºæœˆä»½ä¸º12ï¼Œå¤©æ•°ä¸º 10 æˆ–è€… 11 æˆ–è€… 12 çš„ filter(flights, month == 12, day %in% c(10, 11, 12)) # æ³¨æ„ â€œåŒ…å«äºâ€ è¡¨ç¤ºçš„æ–¹æ³• #&gt; # A tibble: 2,865 Ã— 19 #&gt; year month day dep_time sched_deâ€¦Â¹ dep_dâ€¦Â² arr_tâ€¦Â³ schedâ€¦â´ arr_dâ€¦âµ carrier #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 2013 12 10 7 2359 8 451 445 6 B6 #&gt; 2 2013 12 10 7 2359 8 446 437 9 B6 #&gt; 3 2013 12 10 11 2245 86 119 2353 86 B6 #&gt; 4 2013 12 10 211 2359 132 651 440 131 B6 #&gt; 5 2013 12 10 457 500 -3 701 651 10 US #&gt; 6 2013 12 10 528 515 13 830 814 16 UA #&gt; 7 2013 12 10 543 545 -2 907 832 35 UA #&gt; 8 2013 12 10 548 550 -2 1022 1027 -5 B6 #&gt; 9 2013 12 10 549 540 9 854 850 4 AA #&gt; 10 2013 12 10 551 600 -9 920 856 24 B6 #&gt; # â€¦ with 2,855 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, #&gt; # origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, #&gt; # minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names #&gt; # Â¹â€‹sched_dep_time, Â²â€‹dep_delay, Â³â€‹arr_time, â´â€‹sched_arr_time, âµâ€‹arr_delay # æ·»åŠ å‡½æ•°å‚æ•° na.rm = TRUE æ¥å‰”é™¤æ•°æ®ï¼Œis.na æ¥åˆ¤æ–­æ˜¯å¦ä¸º NAï¼ˆè¿™æ˜¯é€šç”¨çš„ï¼‰ filter(flights, month == 1, na.rm = TRUE) #&gt; # A tibble: 27,004 Ã— 19 #&gt; year month day dep_time sched_deâ€¦Â¹ dep_dâ€¦Â² arr_tâ€¦Â³ schedâ€¦â´ arr_dâ€¦âµ carrier #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 2013 1 1 517 515 2 830 819 11 UA #&gt; 2 2013 1 1 533 529 4 850 830 20 UA #&gt; 3 2013 1 1 542 540 2 923 850 33 AA #&gt; 4 2013 1 1 544 545 -1 1004 1022 -18 B6 #&gt; 5 2013 1 1 554 600 -6 812 837 -25 DL #&gt; 6 2013 1 1 554 558 -4 740 728 12 UA #&gt; 7 2013 1 1 555 600 -5 913 854 19 B6 #&gt; 8 2013 1 1 557 600 -3 709 723 -14 EV #&gt; 9 2013 1 1 557 600 -3 838 846 -8 B6 #&gt; 10 2013 1 1 558 600 -2 753 745 8 AA #&gt; # â€¦ with 26,994 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, #&gt; # origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, #&gt; # minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names #&gt; # Â¹â€‹sched_dep_time, Â²â€‹dep_delay, Â³â€‹arr_time, â´â€‹sched_arr_time, âµâ€‹arr_delay 6.2.1 æ¯”è¾ƒ å¯¹äºæ¯”è¾ƒå¤§å°ï¼Œæˆ‘ä»¬æœ‰ &gt;ã€&gt;=ã€&lt;ã€&lt;=ã€!= å’Œ ==ã€‚æ³¨æ„è¿™é‡Œçš„ç­‰äºç”¨äº†ä¸¤ä¸ªç­‰äºç¬¦å·è¡¨ç¤ºï¼ˆè¿™ä¸å¾ˆå¤šè¯­è¨€ä¿æŒä¸€è‡´ï¼‰ã€‚å¦‚æœå†™æˆäº†ä¸€ä¸ªï¼ŒR é€šå¸¸ä¼š â€œæœºæ™ºåœ°â€ æé†’ä½ ï¼š filter(flights, month = 1) #&gt; Error in `filter()`: #&gt; ! We detected a named input. #&gt; i This usually means that you&#39;ve used `=` instead of `==`. #&gt; i Did you mean `month == 1`? #&gt; Backtrace: #&gt; 1. dplyr::filter(flights, month = 1) #&gt; 2. dplyr:::filter.data.frame(flights, month = 1) æ³¨æ„ï¼šåœ¨æ¯”è¾ƒæ•°æ®æ—¶ä½ å¯èƒ½ä¼šé‡åˆ°æµ®ç‚¹æ•°ï¼Œå¯¼è‡´ç»“æœå¯èƒ½ä¸ç¬¦åˆå¸¸ç†ï¼š sqrt(2)^2 == 2 #&gt; [1] FALSE 1 / 49 * 49 == 1 #&gt; [1] FALSE è¯·ä½¿ç”¨ near() å‡½æ•°è§£å†³è¿™ä¸ªé—®é¢˜ï¼š near(sqrt(2)^2, 2) #&gt; [1] TRUE near(1 / 49 * 49, 1) #&gt; [1] TRUE 6.2.2 é€»è¾‘è¿ç®—ç¬¦ R æä¾›äº†é€»è¾‘è¿ç®—ç¬¦ &amp;ã€| å’Œ nor()ï¼Œåœ¨å˜é‡å‰åŠ æ„Ÿå¹å·è¡¨ç¤ºç›¸åã€‚ å®Œæ•´çš„å¸ƒå°”è¿ç®—é›†ã€‚â€œxâ€æ˜¯å·¦è¾¹çš„åœ†åœˆï¼Œâ€œyâ€æ˜¯å³è¾¹çš„åœ†åœˆï¼Œé˜´å½±åŒºåŸŸæ˜¾ç¤ºæ¯ä¸ªæ“ä½œå‘˜é€‰æ‹©çš„éƒ¨åˆ†ã€‚ 6.2.3 ç¼ºå¤±å€¼ R åœ¨æ•°æ®ç¼ºå¤±æ—¶ä¼šç”¨ NA è¡¨ç¤ºã€‚ä½†æ³¨æ„å®ƒå¹¶ä¸æ˜¯å•çº¯åœ°è¡¨ç¤º 0ã€‚å°å¿ƒåœ¨æ¯”è¾ƒæ—¶å®ƒä¼šä¼ æŸ“ï¼ NA &gt; 5 #&gt; [1] NA 10 == NA #&gt; [1] NA NA + 10 #&gt; [1] NA NA / 2 #&gt; [1] NA NA == NA #&gt; [1] NA æˆ‘ä»¬éœ€è¦äººæ€§åœ°ä»£å…¥è¿›å»çœ‹å¾…è¿™ä¸ªé—®é¢˜ã€‚è¿™é‡Œæœ‰ä¸ªå¾ˆå¥½çš„èŒƒä¾‹ï¼š # Let x be Mary&#39;s age. We don&#39;t know how old she is. x &lt;- NA # Let y be John&#39;s age. We don&#39;t know how old he is. y &lt;- NA # Are John and Mary the same age? x == y #&gt; [1] NA # We don&#39;t know! 6.3 æ’åˆ— arange() # æŒ‰ç…§å¹´æœˆæ—¥æ’åº arrange(flights, year, month, day) #&gt; # A tibble: 336,776 Ã— 19 #&gt; year month day dep_time sched_deâ€¦Â¹ dep_dâ€¦Â² arr_tâ€¦Â³ schedâ€¦â´ arr_dâ€¦âµ carrier #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 2013 1 1 517 515 2 830 819 11 UA #&gt; 2 2013 1 1 533 529 4 850 830 20 UA #&gt; 3 2013 1 1 542 540 2 923 850 33 AA #&gt; 4 2013 1 1 544 545 -1 1004 1022 -18 B6 #&gt; 5 2013 1 1 554 600 -6 812 837 -25 DL #&gt; 6 2013 1 1 554 558 -4 740 728 12 UA #&gt; 7 2013 1 1 555 600 -5 913 854 19 B6 #&gt; 8 2013 1 1 557 600 -3 709 723 -14 EV #&gt; 9 2013 1 1 557 600 -3 838 846 -8 B6 #&gt; 10 2013 1 1 558 600 -2 753 745 8 AA #&gt; # â€¦ with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, #&gt; # origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, #&gt; # minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names #&gt; # Â¹â€‹sched_dep_time, Â²â€‹dep_delay, Â³â€‹arr_time, â´â€‹sched_arr_time, âµâ€‹arr_delay # åå‘æ’åºã€‚æ³¨æ„æ— è®ºæ­£åå‘ï¼ŒNA å€¼éƒ½æ€»æ˜¯è¢«æ’åˆ°æœ«å°¾ï¼š arrange(flights, desc(dep_delay)) #&gt; # A tibble: 336,776 Ã— 19 #&gt; year month day dep_time sched_deâ€¦Â¹ dep_dâ€¦Â² arr_tâ€¦Â³ schedâ€¦â´ arr_dâ€¦âµ carrier #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 2013 1 9 641 900 1301 1242 1530 1272 HA #&gt; 2 2013 6 15 1432 1935 1137 1607 2120 1127 MQ #&gt; 3 2013 1 10 1121 1635 1126 1239 1810 1109 MQ #&gt; 4 2013 9 20 1139 1845 1014 1457 2210 1007 AA #&gt; 5 2013 7 22 845 1600 1005 1044 1815 989 MQ #&gt; 6 2013 4 10 1100 1900 960 1342 2211 931 DL #&gt; 7 2013 3 17 2321 810 911 135 1020 915 DL #&gt; 8 2013 6 27 959 1900 899 1236 2226 850 DL #&gt; 9 2013 7 22 2257 759 898 121 1026 895 DL #&gt; 10 2013 12 5 756 1700 896 1058 2020 878 AA #&gt; # â€¦ with 336,766 more rows, 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, #&gt; # origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, #&gt; # minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names #&gt; # Â¹â€‹sched_dep_time, Â²â€‹dep_delay, Â³â€‹arr_time, â´â€‹sched_arr_time, âµâ€‹arr_delay 6.4 é€‰æ‹© select() æ³¨æ„ä¸€äº›æ–¹ä¾¿çš„åŒ¹é…è§„åˆ™ï¼š starts_with(\"abc\")ï¼šåŒ¹é…ä»¥ â€œabcâ€ å¼€å¤´çš„åç§°ã€‚ ends_with(\"xyz\")ï¼šåŒ¹é…ä»¥ â€œxyzâ€ ç»“å°¾çš„åç§°ã€‚ contains(\"ijk\")ï¼šåŒ¹é…åŒ…å« â€œijkâ€ çš„åç§°ã€‚ matches(\"(.)\\\\1\")ï¼šé€‰æ‹©ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å˜é‡ã€‚ num_range(\"x\", 1:3)ï¼šåŒ¹é… x1ã€x2å’Œ x3ã€‚ # é€‰å‡ºå¹´æœˆæ—¥ select(flights, year, month, day) #&gt; # A tibble: 336,776 Ã— 3 #&gt; year month day #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 2013 1 1 #&gt; 2 2013 1 1 #&gt; 3 2013 1 1 #&gt; 4 2013 1 1 #&gt; 5 2013 1 1 #&gt; 6 2013 1 1 #&gt; 7 2013 1 1 #&gt; 8 2013 1 1 #&gt; 9 2013 1 1 #&gt; 10 2013 1 1 #&gt; # â€¦ with 336,766 more rows select(flights, year:day) #&gt; # A tibble: 336,776 Ã— 3 #&gt; year month day #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 2013 1 1 #&gt; 2 2013 1 1 #&gt; 3 2013 1 1 #&gt; 4 2013 1 1 #&gt; 5 2013 1 1 #&gt; 6 2013 1 1 #&gt; 7 2013 1 1 #&gt; 8 2013 1 1 #&gt; 9 2013 1 1 #&gt; 10 2013 1 1 #&gt; # â€¦ with 336,766 more rows # é€‰å‡ºé™¤å¹´æœˆæ—¥ä»¥åŠ flight çš„æ‰€æœ‰åˆ— select(flights, -c(year:day, flight)) # æœ‰æ—¶ c å¯ä»¥çœç•¥æ‰ #&gt; # A tibble: 336,776 Ã— 15 #&gt; dep_time schedâ€¦Â¹ dep_dâ€¦Â² arr_tâ€¦Â³ schedâ€¦â´ arr_dâ€¦âµ carrier tailnum origin dest #&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 517 515 2 830 819 11 UA N14228 EWR IAH #&gt; 2 533 529 4 850 830 20 UA N24211 LGA IAH #&gt; 3 542 540 2 923 850 33 AA N619AA JFK MIA #&gt; 4 544 545 -1 1004 1022 -18 B6 N804JB JFK BQN #&gt; 5 554 600 -6 812 837 -25 DL N668DN LGA ATL #&gt; 6 554 558 -4 740 728 12 UA N39463 EWR ORD #&gt; 7 555 600 -5 913 854 19 B6 N516JB EWR FLL #&gt; 8 557 600 -3 709 723 -14 EV N829AS LGA IAD #&gt; 9 557 600 -3 838 846 -8 B6 N593JB JFK MCO #&gt; 10 558 600 -2 753 745 8 AA N3ALAA LGA ORD #&gt; # â€¦ with 336,766 more rows, 5 more variables: air_time &lt;dbl&gt;, distance &lt;dbl&gt;, #&gt; # hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable names #&gt; # Â¹â€‹sched_dep_time, Â²â€‹dep_delay, Â³â€‹arr_time, â´â€‹sched_arr_time, âµâ€‹arr_delay # é€‰å‡ºç»“å°¾ä¸º delay ç›¸å…³çš„åˆ— select(flights, ends_with(&quot;delay&quot;)) #&gt; # A tibble: 336,776 Ã— 2 #&gt; dep_delay arr_delay #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2 11 #&gt; 2 4 20 #&gt; 3 2 33 #&gt; 4 -1 -18 #&gt; 5 -6 -25 #&gt; 6 -4 12 #&gt; 7 -5 19 #&gt; 8 -3 -14 #&gt; 9 -3 -8 #&gt; 10 -2 8 #&gt; # â€¦ with 336,766 more rows # é€‰å‡ºå¼€å¤´ä¸º sched ç›¸å…³çš„åˆ— select(flights, starts_with(&quot;sched&quot;)) #&gt; # A tibble: 336,776 Ã— 2 #&gt; sched_dep_time sched_arr_time #&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 515 819 #&gt; 2 529 830 #&gt; 3 540 850 #&gt; 4 545 1022 #&gt; 5 600 837 #&gt; 6 558 728 #&gt; 7 600 854 #&gt; 8 600 723 #&gt; 9 600 846 #&gt; 10 600 745 #&gt; # â€¦ with 336,766 more rows # é€‰å‡ºåŒ…å« sched ç›¸å…³çš„åˆ— select(flights, contains(&quot;sched&quot;)) #&gt; # A tibble: 336,776 Ã— 2 #&gt; sched_dep_time sched_arr_time #&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 515 819 #&gt; 2 529 830 #&gt; 3 540 850 #&gt; 4 545 1022 #&gt; 5 600 837 #&gt; 6 558 728 #&gt; 7 600 854 #&gt; 8 600 723 #&gt; 9 600 846 #&gt; 10 600 745 #&gt; # â€¦ with 336,766 more rows # é€‰å‡ºçš„æ•°æ®ä¸åŒ…å«å¸¦ schedçš„åˆ—ï¼Œæ­¤å¤–å…¶ä»–éƒ½åŒ…å« select(flights, -contains(&quot;sched&quot;), everything()) #&gt; # A tibble: 336,776 Ã— 19 #&gt; year month day dep_time dep_delay arr_time arr_deâ€¦Â¹ carrier flight tailnum #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; #&gt; 1 2013 1 1 517 2 830 11 UA 1545 N14228 #&gt; 2 2013 1 1 533 4 850 20 UA 1714 N24211 #&gt; 3 2013 1 1 542 2 923 33 AA 1141 N619AA #&gt; 4 2013 1 1 544 -1 1004 -18 B6 725 N804JB #&gt; 5 2013 1 1 554 -6 812 -25 DL 461 N668DN #&gt; 6 2013 1 1 554 -4 740 12 UA 1696 N39463 #&gt; 7 2013 1 1 555 -5 913 19 B6 507 N516JB #&gt; 8 2013 1 1 557 -3 709 -14 EV 5708 N829AS #&gt; 9 2013 1 1 557 -3 838 -8 B6 79 N593JB #&gt; 10 2013 1 1 558 -2 753 8 AA 301 N3ALAA #&gt; # â€¦ with 336,766 more rows, 9 more variables: origin &lt;chr&gt;, dest &lt;chr&gt;, #&gt; # air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, #&gt; # sched_dep_time &lt;int&gt;, sched_arr_time &lt;int&gt;, and abbreviated variable name #&gt; # Â¹â€‹arr_delay 6.5 é‡å‘½å rename() ä¸€èˆ¬ç”¨å¾—å¾ˆå°‘ï¼Œä½†æœ‰æ—¶å¾ˆåˆšéœ€ã€‚å…¶å®å®ƒæ˜¯ select() çš„å˜ä½“ï¼š rename(flights, tail_num = tailnum) 6.6 æ·»åŠ æ–°å˜é‡ mutate() ä¸ transmute() # ç”Ÿæˆä¼˜åŒ–ç‰ˆçš„ flights æ•°æ®é›† flights_sml &lt;- select(flights, year:day, ends_with(&quot;delay&quot;), distance, air_time) mutate( flights_sml, gain = dep_delay - arr_delay, speed_min = distance / air_time, # è®¡ç®—å‡ºçš„æ–°æ•°æ® speed_sec = speed_min * 60 # ä»åˆšç”Ÿæˆçš„æ•°æ®ä¸­å¥—æ–°æ•°æ® ) #&gt; # A tibble: 336,776 Ã— 10 #&gt; year month day dep_delay arr_delay distance air_time gain speedâ€¦Â¹ speedâ€¦Â² #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2013 1 1 2 11 1400 227 -9 6.17 370. #&gt; 2 2013 1 1 4 20 1416 227 -16 6.24 374. #&gt; 3 2013 1 1 2 33 1089 160 -31 6.81 408. #&gt; 4 2013 1 1 -1 -18 1576 183 17 8.61 517. #&gt; 5 2013 1 1 -6 -25 762 116 19 6.57 394. #&gt; 6 2013 1 1 -4 12 719 150 -16 4.79 288. #&gt; 7 2013 1 1 -5 19 1065 158 -24 6.74 404. #&gt; 8 2013 1 1 -3 -14 229 53 11 4.32 259. #&gt; 9 2013 1 1 -3 -8 944 140 5 6.74 405. #&gt; 10 2013 1 1 -2 8 733 138 -10 5.31 319. #&gt; # â€¦ with 336,766 more rows, and abbreviated variable names Â¹â€‹speed_min, #&gt; # Â²â€‹speed_sec # ç”Ÿæˆæ•°æ®ä¸­ä¸åŒ…å«æ—§æ•°æ®ï¼Œåº”è¯¥ä½¿ç”¨ transmute transmute( flights_sml, gain = dep_delay - arr_delay, speed_min = distance / air_time, # è®¡ç®—å‡ºçš„æ–°æ•°æ® speed_sec = speed_min * 60 # ä»åˆšç”Ÿæˆçš„æ•°æ®ä¸­å¥—æ–°æ•°æ® ) #&gt; # A tibble: 336,776 Ã— 3 #&gt; gain speed_min speed_sec #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 -9 6.17 370. #&gt; 2 -16 6.24 374. #&gt; 3 -31 6.81 408. #&gt; 4 17 8.61 517. #&gt; 5 19 6.57 394. #&gt; 6 -16 4.79 288. #&gt; 7 -24 6.74 404. #&gt; 8 11 4.32 259. #&gt; 9 5 6.74 405. #&gt; 10 -10 5.31 319. #&gt; # â€¦ with 336,766 more rows 6.7 åˆ†ç»„æ‘˜è¦ summarise() æ³¨æ„å…³æ³¨ç®¡é“ç¬¦å·ï¼š%&gt;% # x %&gt;% f(y) å³ä¸º f(x, y) msleep %&gt;% count(order, sort = TRUE) # ä¸Šé¢çš„ç­‰åŒäºä¸‹é¢çš„ count(msleep, order, sort = T) æ³¨æ„å•çº¯çš„ summarize å¹¶æ²¡æœ‰å¤ªå¤§çš„ç”¨å¤„ï¼š summarise( flights, delay = mean(dep_delay, na.rm = TRUE) # meanï¼Œå–å‡å€¼ï¼Œna.rm å¿½ç•¥ç©ºå€¼ ) #&gt; # A tibble: 1 Ã— 1 #&gt; delay #&gt; &lt;dbl&gt; #&gt; 1 12.6 æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬é…åˆ group_by ä½¿ç”¨ï¼š by_day &lt;- group_by(flights, year, month, day) # åˆ†ç»„ç»†èŠ‚åˆ°å¹´æœˆæ—¥ summarise( by_day, delay = mean(dep_delay, na.rm = TRUE) # ç»„å†…çš„ [delay] æ ‡ç­¾è¿½åŠ ï¼ŒæŒ‰ç…§ç®—æ³•åˆ†ç»„è¿”å›å€¼ ) #&gt; `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;. You can override using the #&gt; `.groups` argument. #&gt; # A tibble: 365 Ã— 4 #&gt; # Groups: year, month [12] #&gt; year month day delay #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; #&gt; 1 2013 1 1 11.5 #&gt; 2 2013 1 2 13.9 #&gt; 3 2013 1 3 11.0 #&gt; 4 2013 1 4 8.95 #&gt; 5 2013 1 5 5.73 #&gt; 6 2013 1 6 7.15 #&gt; 7 2013 1 7 5.42 #&gt; 8 2013 1 8 2.55 #&gt; 9 2013 1 9 2.28 #&gt; 10 2013 1 10 2.84 #&gt; # â€¦ with 355 more rows # ä½¿ç”¨ç®¡é“ç¬¦ &quot;%&gt;%&quot; ç²¾ç®€ä»£ç  group_by(flights, year, month, day) %&gt;% summarise(delay = mean(dep_delay, na.rm = TRUE)) #&gt; `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;. You can override using the #&gt; `.groups` argument. #&gt; # A tibble: 365 Ã— 4 #&gt; # Groups: year, month [12] #&gt; year month day delay #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; #&gt; 1 2013 1 1 11.5 #&gt; 2 2013 1 2 13.9 #&gt; 3 2013 1 3 11.0 #&gt; 4 2013 1 4 8.95 #&gt; 5 2013 1 5 5.73 #&gt; 6 2013 1 6 7.15 #&gt; 7 2013 1 7 5.42 #&gt; 8 2013 1 8 2.55 #&gt; 9 2013 1 9 2.28 #&gt; 10 2013 1 10 2.84 #&gt; # â€¦ with 355 more rows 6.8 å…¶ä»–å¤„ç†æ•°æ®åŠŸèƒ½ ç®—æœ¯è¿ç®—ç¬¦ï¼š+ - * /ã€‚å®ƒä»¬å¯ä»¥ç”¨äºå‘é‡ï¼Œä¼šè‡ªåŠ¨å¸®ä½ åšä¸€ä¸ª for å¾ªç¯ã€‚ æ¨¡ç®—æœ¯ï¼š%/% æ±‚æ¨¡ã€ %% æ±‚ä½™ã€‚ Logï¼šlog()ã€log2()ã€log10()ï¼Œå³æ±‚å¯¹æ•°ã€‚è¿™äº›ä¼šåœ¨æœªæ¥å»ºæ¨¡æ—¶å¸¸å¸¸ç”¨åˆ°ã€‚ åç§»é‡ï¼šlag() å€¼å‰å¯¼ã€lead() å€¼æ»åï¼Œç”¨äºå°†å‘é‡çš„å€¼å‰å¯¼æˆ–æ»åã€‚å¦‚ï¼š (x &lt;- 1:10) #&gt; [1] 1 2 3 4 5 6 7 8 9 10 lag(x) #&gt; [1] NA 1 2 3 4 5 6 7 8 9 lead(x) #&gt; [1] 2 3 4 5 6 7 8 9 10 NA ç´¯ç§¯å’Œæ»šåŠ¨èšåˆï¼šcumsum() æ€»å’Œã€cumprod() ä¹˜ç§¯ã€cummin() æœ€å°å€¼ã€cummax() æœ€å¤§å€¼ã€cummean() å‡å€¼ã€‚æ­¤å¤– dplyr ä¹Ÿæä¾›ç´¯ç§¯æ‰‹æ®µã€‚å¦‚æœæˆ‘ä»¬éœ€è¦æ»šåŠ¨èšåˆï¼ˆå³åœ¨æ»šåŠ¨çª—å£ä¸Šè®¡ç®—çš„æ€»å’Œï¼‰ï¼Œè¯·å°è¯• RcppRoll åŒ…ã€‚ (x &lt;- (1:10)) #&gt; [1] 1 2 3 4 5 6 7 8 9 10 cumsum(x) #&gt; [1] 1 3 6 10 15 21 28 36 45 55 cummean(x) #&gt; [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.9 åˆ†æ flights æ•°æ®é›† 6.9.1 è®¡ç®—ç›®çš„åœ°ç›¸å…³çš„å›¾ by_dest &lt;- group_by(flights, dest) # ä»¥ dest åˆ†ç»„ delay &lt;- summarise( by_dest, count = n(), # è®¡ç®—ç»„å†…æ•°æ®æ•°é‡ dist = mean(distance, na.rm = TRUE), # è®¡ç®—æ¯ç»„å†…çš„ distance å¹³å‡å€¼ arr_delay = mean(arr_delay, na.rm = TRUE), # åŒç†ï¼Œåˆ°è¾¾æ—¶é—´ ) # ç²¾ç®€å¾—åˆ°æƒ³è¦çš„æ•°æ® delay &lt;- filter(delay, count &gt; 20, dest != &quot;HNL&quot;) # åˆ°è¾¾æ•°å¤§äº20æ¬¡ï¼Œç›®çš„åœ°ä¸ä¸º HNL # å°è¯•ç”»å›¾ ggplot( data = delay, mapping = aes(x = dist, y = arr_delay) # ç¡®å®š data å’Œ mapping çš„é»˜è®¤æ•°æ® ) + geom_point( aes(size = count), # æ·»åŠ æ–°çš„ç‰¹æ®Šæ•°æ® sizeï¼ˆæ­¤å¤„ mapping ä¸ºé»˜è®¤å€¼ï¼Œå¯çœç•¥å£°æ˜ï¼‰ alpha = 1 / 3 # é€æ˜åº¦å›ºå®š ) + geom_smooth(se = FALSE) # ç»˜åˆ¶å¹³æ»‘æ›²çº¿ #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; 6.9.2 è·å–çƒ­é—¨ç›®çš„åœ°åŠæœ‰å…³æ•°æ® pop_dests &lt;- group_by(flights, dest) %&gt;% filter(n() &gt; 365) %&gt;% distinct(dest) # ç­›é€‰åªè¦æŒ‡å®šçš„åˆ— head(pop_dests, 10) # åªå±•ç¤ºå‰å #&gt; # A tibble: 10 Ã— 1 #&gt; # Groups: dest [10] #&gt; dest #&gt; &lt;chr&gt; #&gt; 1 IAH #&gt; 2 MIA #&gt; 3 BQN #&gt; 4 ATL #&gt; 5 ORD #&gt; 6 FLL #&gt; 7 IAD #&gt; 8 MCO #&gt; 9 PBI #&gt; 10 TPA 6.9.3 ç»˜åˆ¶é£æœºå»¶è¯¯æ—¶é•¿åˆ†å¸ƒå›¾ delays &lt;- flights %&gt;% # è·å¾—å¤„ç†åçš„æ•°æ® filter(!is.na(dep_delay), !is.na(arr_delay)) %&gt;% # å»é™¤ç©º NA æ•°æ® group_by(tailnum) %&gt;% # æŒ‰èˆªç­åˆ†ç»„ summarise( # è·å–å¹³å‡å€¼å¹¶äº§ç”ŸåŒ…å« group_by åˆ—å’Œè®¡ç®—çš„æ–°åˆ— delay = mean(arr_delay, na.rm = TRUE), # ç”±äºä¹‹å‰è¿‡æ»¤è¿‡äº†ï¼Œæ­¤å¤„çš„ na.rm å¯ä»¥å»æ‰ n = n() # ç»Ÿè®¡æ•°é‡ï¼Œæ–¹ä¾¿ç»˜åˆ¶ç›´æ–¹å›¾ ) delays %&gt;% filter(n &gt; 25) %&gt;% # æ•°é‡å¾ˆå°æ—¶å¾€å¾€ä¼šå¯¹æ•°æ®äº§ç”Ÿè¾ƒå¤§å½±å“ã€‚è¿™é‡Œè¿‡æ»¤æ‰å®ƒä»¬ ggplot(mapping = aes(x = n, y = delay)) + geom_point(alpha = 1 / 10) 6.9.4 è®¡ç®—æ¯å¤©æœ€æ—©å’Œæœ€æ™šçš„èˆªç­ flights %&gt;% filter(!is.na(dep_delay), !is.na(arr_delay)) %&gt;% group_by(year, month, day) %&gt;% summarise( first = min(dep_time), last = max(dep_time) ) #&gt; `summarise()` has grouped output by &#39;year&#39;, &#39;month&#39;. You can override using the #&gt; `.groups` argument. #&gt; # A tibble: 365 Ã— 5 #&gt; # Groups: year, month [12] #&gt; year month day first last #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 2013 1 1 517 2356 #&gt; 2 2013 1 2 42 2354 #&gt; 3 2013 1 3 32 2349 #&gt; 4 2013 1 4 25 2358 #&gt; 5 2013 1 5 14 2357 #&gt; 6 2013 1 6 16 2355 #&gt; 7 2013 1 7 49 2359 #&gt; 8 2013 1 8 454 2351 #&gt; 9 2013 1 9 2 2252 #&gt; 10 2013 1 10 3 2320 #&gt; # â€¦ with 355 more rows "],["workflow-scripts.html", "Chapter 7 Workflow: scripts 7.1 è¿è¡Œä»£ç  7.2 RStudio è¯Šæ–­ 7.3 ä½¿ç”¨ Visual studio code ç¼–å†™ R", " Chapter 7 Workflow: scripts åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨ Console æ§åˆ¶å°æ¥è¿è¡Œä»£ç ã€‚ä½†å½“æˆ‘ä»¬åˆ›å»ºæ›´å¤æ‚çš„ ggplot2 å›¾å’Œ dplyr ç®¡é“æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒå¾ˆå¿«å°±ä¼šå˜å¾—ç‹­çª„ã€‚ä¸ºäº†ç»™è‡ªå·±æ›´å¤šçš„å·¥ä½œç©ºé—´ï¼Œä½¿ç”¨è„šæœ¬ç¼–è¾‘å™¨æ˜¯ä¸ªå¥½ä¸»æ„ã€‚ é€šè¿‡å•å‡» â€œæ–‡ä»¶â€ èœå•ï¼Œç„¶åé€‰æ‹© â€œæ–°å»ºæ–‡ä»¶â€ ï¼Œç„¶åé€‰æ‹© â€œR è„šæœ¬â€ï¼Œæˆ–ä½¿ç”¨é”®ç›˜å¿«æ·é”® Cmd/Ctrl + Shift + N å°†å…¶æ‰“å¼€ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å››ä¸ªçª—æ ¼ï¼š rstudio-editor 7.1 è¿è¡Œä»£ç  è„šæœ¬ç¼–è¾‘å™¨ä¹Ÿæ˜¯æ„å»ºå¤æ‚çš„ ggplot2 å›¾æˆ–é•¿åºåˆ— dplyr æ“ä½œçš„å¥½åœ°æ–¹ã€‚ä¸€ä¸ªæœ€é‡è¦çš„å¿«æ·é”®ï¼šCmd / Ctrl + Enterã€‚è¿™å°†åœ¨æ§åˆ¶å°ä¸­æ‰§è¡Œå½“å‰ R è¡¨è¾¾å¼ã€‚é€‰ä¸­ä»£ç æ—¶æ‰§è¡Œé€‰ä¸­éƒ¨åˆ†ï¼Œå¦åˆ™å®ƒå°†è‡ªåŠ¨æ‰§è¡Œå…‰æ ‡æ‰€åœ¨çš„é‚£ä¸€å°æ®µä»£ç ï¼Œç„¶åè‡ªåŠ¨å°†å…‰æ ‡æŒªåˆ°ä¸‹ä¸€æ®µã€‚ é™¤äº†é€ä¸ªè¡¨è¾¾å¼è¿è¡Œä¹‹å¤–ï¼Œå¿«æ·é”®ï¼šCmd/Ctrl + Shift + S ç”¨äºæ‰§è¡Œæ•´ä¸ªå½“å‰æ–‡ä»¶ã€‚ 7.2 RStudio è¯Šæ–­ è„šæœ¬ç¼–è¾‘å™¨è¿˜å°†åœ¨ä¾§è¾¹æ ä¸­ç”¨çº¢è‰²æ³¢æµªçº¿å’Œçº¢è‰²çš„é”™è¯¯å›¾æ ‡çªå‡ºæ˜¾ç¤ºè¯­æ³•é”™è¯¯ï¼š rstudio-diagnostic å°†é¼ æ ‡æ‚¬åœåœ¨å¯¹åº”ä»£ç ä¸Šä»¥æŸ¥çœ‹é—®é¢˜æ‰€åœ¨ï¼š rstudio-diagnostic-tip RStudio è¿˜ä¼šè®©ä½ äº†è§£æ½œåœ¨çš„é—®é¢˜ï¼š rstudio-diagnostic-warn 7.3 ä½¿ç”¨ Visual studio code ç¼–å†™ R è¿™æ˜¯æ¿€åŠ¨äººå¿ƒçš„ â€”â€” è¿™æ¬¾å·ç§° â€œ21 ä¸–çºªæœ€ä¼Ÿå¤§çš„ç¼–è¾‘å™¨â€ çš„é€šç”¨ä»£ç ç¼–è¾‘å™¨æˆåŠŸè®© R è¿ä½œèµ·æ¥äº†ã€‚ä½†æˆ‘ä»¬è¯´ï¼Œäº‹æƒ…å¾€å¾€ä¼´éšç€ä»£ä»·ã€‚åœ¨ VSCode ä¸Šï¼Œä½ å¯èƒ½éœ€è¦ä¸€äº›åŸºç¡€å»è°ƒæ•´å¥½å®ƒã€‚å®ƒéœ€è¦çš„æ ¸å¿ƒæ˜¯ Radian â€“ A 21 century R consoleã€‚ åˆç†åœ°ä½¿ç”¨ VScodeï¼Œèƒ½æé«˜æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ã€‚è€Œä¸”æ§åˆ¶å°å†å²è®°å½•ã€æŸ¥è¯¢ã€å·¥ä½œåŒºä¸å˜é‡ç®¡ç†ã€æ™ºèƒ½è£…åŒ…ã€å¼ºå¤§çš„å¸®åŠ©ç³»ç»Ÿã€ç¼©è¿›ä¸æ ¼å¼åŒ–ä»£ç ç­‰åŠŸèƒ½å®ƒéƒ½ä¸æ›¾æ¬ ç¼ºã€‚ç›¸ä¿¡èªæ˜çš„è¯»è€…åº”è¯¥æœ‰ç€æ›´èªæ…§çš„å¤´è„‘ï¼Œåœ¨é€‰æ‹©æ–¹é¢åšå‡ºæ›´ä¸ºç†æ™ºçš„å†³å®šå§ã€‚ "],["exploratory-data-analysis.html", "Chapter 8 Exploratory Data Analysis 8.1 ç»˜å›¾åˆ†æ diamonds æ•°æ®é›† 8.2 ç»˜å›¾ç»Ÿè®¡ flights æ•°æ®é›† 8.3 ç»˜å›¾ç»Ÿè®¡ diamonds æ•°æ®é›†", " Chapter 8 Exploratory Data Analysis ç³»ç»Ÿåœ°å¯è§†åŒ–å’Œè½¬æ¢æ¢ç´¢æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¸ºæ¢ç´¢æ€§æ•°æ®åˆ†ææˆ–ç®€ç§° EDAã€‚EDA æ˜¯ä¸€ä¸ªè¿­ä»£å¾ªç¯ï¼ŒåŒ…æ‹¬ï¼š ç”Ÿæˆæœ‰å…³æ•°æ®çš„é—®é¢˜ã€‚ é€šè¿‡å¯è§†åŒ–ã€è½¬æ¢å’Œå»ºæ¨¡æ•°æ®æ¥æœç´¢ç­”æ¡ˆã€‚ ä½¿ç”¨å­¦åˆ°çš„çŸ¥è¯†æ¥å®Œå–„é—®é¢˜æœ¬èº«æˆ–ç”Ÿæˆæ–°çš„é—®é¢˜ã€‚ æ­¤å¤–è¯·å…³æ³¨ä»¥ä¸‹æ•°æ®ï¼š å˜é‡ï¼šå¯ä»¥æµ‹é‡çš„æ•°é‡ã€è´¨é‡æˆ–å±æ€§ã€‚ å€¼ï¼šæµ‹é‡å˜é‡æ—¶å˜é‡çš„çŠ¶æ€ã€‚å˜é‡çš„å€¼å¯èƒ½å› æµ‹é‡å€¼è€Œå¼‚ã€‚ è§‚æµ‹å€¼ï¼šåœ¨ç›¸ä¼¼æ¡ä»¶ä¸‹è¿›è¡Œçš„ä¸€ç»„æµ‹é‡ï¼Œå°†åŒ…å«å¤šä¸ªå€¼ï¼Œæ¯ä¸ªå€¼éƒ½ä¸ä¸åŒçš„å˜é‡ç›¸å…³è”ã€‚æœ‰æ—¶ä¹Ÿå«æ•°æ®ç‚¹ã€‚ è¡¨æ ¼æ•°æ®ï¼šä¸€ç»„å€¼ï¼Œæ¯ä¸ªå€¼éƒ½ä¸ä¸€ä¸ªå˜é‡å’Œä¸€ä¸ªè§‚æµ‹å€¼ç›¸å…³è”ã€‚ library(tidyverse) 8.1 ç»˜å›¾åˆ†æ diamonds æ•°æ®é›† 8.1.1 å¯è§†åŒ–åˆ†å¸ƒ åˆ†ç±»å˜é‡çš„åˆ†å¸ƒä¸€èˆ¬ç”¨æ¡å½¢å›¾ï¼Œå¦‚ï¼šç»Ÿè®¡å„ç§å“è´¨é’»çŸ³çš„æ•°é‡å¹¶ç»˜å›¾ ggplot(data = diamonds) + geom_bar(mapping = aes(x = cut)) å¦‚æœæƒ³è¦æ•°æ®çš„è¯ä¹Ÿå¯ä»¥ç”¨ dplyr::count() ç»Ÿè®¡ã€‚ä½†äº‹å®ä¸Šï¼Œæ‰€æœ‰ count() èƒ½åšçš„ï¼Œgroup_by + summarise éƒ½èƒ½ï¼š diamonds %&gt;% count(cut_width(carat, 0.5)) # cut_width() å°†æ•°æ®åˆ‡ç‰‡åˆ†ç»„ã€‚æ³¨æ„æ–°çš„åˆ—åå« cut #&gt; # A tibble: 11 Ã— 2 #&gt; `cut_width(carat, 0.5)` n #&gt; &lt;fct&gt; &lt;int&gt; #&gt; 1 [-0.25,0.25] 785 #&gt; 2 (0.25,0.75] 29498 #&gt; 3 (0.75,1.25] 15977 #&gt; 4 (1.25,1.75] 5313 #&gt; 5 (1.75,2.25] 2002 #&gt; 6 (2.25,2.75] 322 #&gt; 7 (2.75,3.25] 32 #&gt; 8 (3.25,3.75] 5 #&gt; 9 (3.75,4.25] 4 #&gt; 10 (4.25,4.75] 1 #&gt; 11 (4.75,5.25] 1 8.1.2 ç»˜åˆ¶é¢‘ç‡ç›´æ–¹å›¾ ç›´æ–¹å›¾ä¸€èˆ¬ç”¨æ¥æ£€æŸ¥è¿ç»­å˜é‡çš„åˆ†å¸ƒï¼Œå¦‚ï¼šç»Ÿè®¡å„ç§å…‹æ‹‰æ•°çš„æ•°é‡å¹¶ç»˜å›¾ ggplot(data = diamonds) + geom_histogram( mapping = aes(x = carat), binwidth = 0.3 # å°†å®½åº¦å®¹çº³ï¼ˆåŒºé—´ï¼‰å¢åŠ è‡³æŒ‡å®šå®½åº¦ ) geom_histogram() ç”Ÿæˆçš„æ˜¯æŸ±å½¢å›¾ï¼Œä½†å¦‚æœä½ æƒ³è¦å åŠ å¤šä¸ªæ•°æ®çš„è¯ï¼Œæ›´æ¨èèƒ½ç”Ÿæˆçº¿æ¡å›¾çš„ geom_freqpoly()ï¼š ggplot(data = diamonds, mapping = aes(x = carat, colour = cut)) + geom_freqpoly(binwidth = 0.1) æƒ³è¦æ•°æ®çš„è¯ä½¿ç”¨ dplyr::count() å’Œ ggplot2::cut_width() è®¡ç®—ï¼š diamonds %&gt;% count(cut_width(carat, 0.5)) #&gt; # A tibble: 11 Ã— 2 #&gt; `cut_width(carat, 0.5)` n #&gt; &lt;fct&gt; &lt;int&gt; #&gt; 1 [-0.25,0.25] 785 #&gt; 2 (0.25,0.75] 29498 #&gt; 3 (0.75,1.25] 15977 #&gt; 4 (1.25,1.75] 5313 #&gt; 5 (1.75,2.25] 2002 #&gt; 6 (2.25,2.75] 322 #&gt; 7 (2.75,3.25] 32 #&gt; 8 (3.25,3.75] 5 #&gt; 9 (3.75,4.25] 4 #&gt; 10 (4.25,4.75] 1 #&gt; 11 (4.75,5.25] 1 8.1.3 å¼‚å¸¸æ•°æ®ï¼ˆæ‚è´¨ï¼‰ å¼‚å¸¸å€¼æ˜¯è¶…å‡ºæ­£å¸¸èŒƒå›´çš„è§‚å¯Ÿå€¼ã€‚äº§ç”ŸåŸå› æœ‰æ—¶åªæ˜¯å•çº¯çš„æ•°æ®è¾“å…¥é”™è¯¯ï¼Œä½†åŒæ ·ä¹Ÿå¾ˆå¯èƒ½è¡¨æ˜ç€æ–°çš„é‡è¦ç§‘å­¦ã€‚ ä¾‹å¦‚è¿™é‡Œç”¨ y åˆ—åšç ”ç©¶ï¼š ggplot(diamonds) + geom_histogram(mapping = aes(x = y), binwidth = 0.5) ä½ ä¼šå‘ç°å®ƒä»¬å¤§å¤šæ”¶ç¼©æˆä¸€å›¢ï¼Œè€Œä¸€äº›å¯ç–‘çš„å€¼æ˜æ˜¾å½±å“äº†æ•´ä¸ªæ•°æ®ã€‚ ä¸ºäº†çœ‹åˆ°é‚£äº›ä¸å¯»å¸¸å‘å€¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ coord_cartesian() å°†åŒºåˆ«æ”¾å¤§åŒ–ï¼š ggplot(diamonds) + geom_histogram(mapping = aes(x = y), binwidth = 0.5) + coord_cartesian(ylim = c(0, 50)) # å°† y è½´æ”¾å¤§åŒ–ç›´åˆ°åŒºé—´ 0 ~ 50 å½“ç„¶è¿™ä¸ªå‡½æ•°ä¹Ÿæ˜¯æœ‰ xlim å‚æ•°çš„ï¼ŒåŒç†ã€‚ æœ‰ 3 ä¸ªä¸ä¼—ä¸åŒçš„å€¼å‡ºç°äº†ï¼åˆ†åˆ«ä¸º 0ã€30ã€60ã€‚æˆ‘ä»¬æŠŠå®ƒä»¬æå–å‡ºæ¥ï¼š unusual &lt;- diamonds %&gt;% filter(y &lt; 3 | y &gt; 20) %&gt;% select(price, x, y, z) %&gt;% arrange(y) %&gt;% print() #&gt; # A tibble: 9 Ã— 4 #&gt; price x y z #&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 5139 0 0 0 #&gt; 2 6381 0 0 0 #&gt; 3 12800 0 0 0 #&gt; 4 15686 0 0 0 #&gt; 5 18034 0 0 0 #&gt; 6 2130 0 0 0 #&gt; 7 2130 0 0 0 #&gt; 8 2075 5.15 31.8 5.12 #&gt; 9 12210 8.09 58.9 8.06 è¿™äº›å€¼å¸¦ç€æ˜æ˜¾çš„ä¼¦ç†é—®é¢˜å’Œå¸¸ç†æ€§é”™è¯¯ã€‚è€Œæˆ‘ä»¬ä¹Ÿæœ€å¥½æ˜¯åœ¨æ²¡æœ‰å¼‚å¸¸å€¼çš„æƒ…å†µä¸‹è¿›è¡Œåˆ†æã€‚å¦‚æœå®ƒä»¬å¯¹ç»“æœçš„å½±å“å¾ˆå°ï¼Œå¹¶ä¸”æˆ‘ä»¬å°šä¸”æ— æ³•å¼„æ¸…æ¥šå®ƒä»¬å­˜åœ¨çš„åŸå› ï¼Œé‚£ä¹ˆç”¨ç¼ºå¤±çš„å€¼ï¼ˆNAï¼‰æ›¿æ¢å®ƒä»¬æ˜¯åˆç†çš„ã€‚ä½†å¦‚æœå®ƒä»¬å¯¹æˆ‘ä»¬çš„ç»“æœæœ‰å®è´¨æ€§å½±å“ï¼Œåˆ™ä¸åº”å½“æ— ç¼˜æ— æ•…åœ°æ”¾å¼ƒå®ƒä»¬ã€‚ æˆ‘ä»¬éœ€è¦æ‰¾å‡ºå¯¼è‡´å®ƒä»¬çš„åŸå› ï¼ˆå¦‚æ•°æ®è¾“å…¥é”™è¯¯ï¼‰ï¼Œå¹¶åˆç†åœ°å¤„ç†è¿™äº›å¼‚å¸¸æ•°æ®ã€‚ 8.1.4 å¤„ç†å¼‚å¸¸æ•°æ® æ³•ä¸€ï¼šåˆ é™¤å«å¼‚å¸¸å€¼çš„æ•´è¡Œ diamonds_new &lt;- diamonds %&gt;% filter(between(y, 3, 20)) # æ–°å»ºæ•°æ®é›†è¿‡æ»¤æ‰æ‚è´¨ æ³•äºŒï¼šå°†å¼‚å¸¸å€¼æ›¿æ¢ä¸º NA ï¼ˆæ¨èï¼‰ diamonds_new &lt;- diamonds %&gt;% # éå¸¸ç±»ä¼¼äº C è¯­è¨€ä¸­çš„ xx?xx:xx ã€‚å¦‚æœ y åœ¨ 3 åˆ° 20 é—´åˆ™ä¿æŒï¼Œå¦åˆ™è¿”å› NA # æ­¤å¤– dplyr::case_when() æœ‰ç€è¿‘ä¹ç›¸åŒçš„åŠŸèƒ½ mutate(y = ifelse(y &gt; 3 &amp; y &lt; 20, y, NA)) ä½†äº‹å®ä¸Šï¼Œå¦‚æœæ•°æ®å«æœ‰ NAï¼Œggplot ç»˜å›¾ä¼šå‘å‡ºè­¦å‘Šå¹¶å°†ç›¸åº”æ•°æ®å‰”é™¤ä¸ä¼šå±•ç¤ºå‡ºæ¥ï¼š ggplot(data = diamonds_new, mapping = aes(x = x, y = y)) + geom_point() #&gt; Warning: Removed 9 rows containing missing values (`geom_point()`). æˆ‘ä»¬åº”è¯¥æ‰‹åŠ¨ç§»é™¤å¸¦ NA çš„æ— æ•ˆæ•°æ®ï¼š ggplot(data = diamonds_new, mapping = aes(x = x, y = y)) + geom_point(na.rm = TRUE) 8.2 ç»˜å›¾ç»Ÿè®¡ flights æ•°æ®é›† nycflights13::flights %&gt;% mutate( cancelled = is.na(dep_time), # å¦‚æœæ•°æ®æ˜¯ NA å°±è¡¨ç¤ºèˆªç­å–æ¶ˆäº† sched_hour = sched_dep_time %/% 100, # å›½é™…è®¡æ—¶é™¤ 100 å•†å¾—åˆ°å°æ—¶ sched_min = sched_dep_time %% 100, # å›½é™…è®¡æ—¶é™¤ 100 å–ä½™å¾—åˆ°åˆ†é’Ÿ sched_dep_time = sched_hour + sched_min / 60 # æŒ‰ç…§æˆ‘ä»¬ä¹ æƒ¯è½¬æ¢æˆæ­£å¸¸çš„åˆ†é’Ÿæ•° ) %&gt;% # freqpoly éå¸¸é€‚åˆæŠ˜çº¿å›¾æ•ˆæœã€‚å¯¹åº”çš„æŸ±çŠ¶å›¾æ˜¯ histogram # binwidth é€šå¸¸ä¼šç”¨æ¥æè¿°çº¿æˆ–æŸ±çš„ç²¾åº¦ã€‚ç²¾åº¦ä¸è¶³çš„éƒ¨åˆ†ä¼šç”¨å¹³å‡å€¼æ¨¡ç³ŠåŒ–æ›¿ä»£ ggplot(mapping = aes(sched_dep_time)) + geom_freqpoly(mapping = aes(color = cancelled), binwidth = 1 / 4) ä½†è¿™æ ·çš„å›¾è¡¨å¹¶ä¸å‹å¥½ï¼Œå› ä¸ºæœªå–æ¶ˆçš„èˆªç­æ¯”å–æ¶ˆçš„å¤šå¾—å¤šè€Œä¸æ–¹ä¾¿è§‚å¯Ÿåˆ†æç»†èŠ‚ã€‚ 8.3 ç»˜å›¾ç»Ÿè®¡ diamonds æ•°æ®é›† 8.3.1 è¿ç»­å˜é‡å¤šç±»ç»˜å›¾ 8.3.1.1 é¢‘ç‡å¤šè¾¹å½¢ æ­£å¦‚å‰é¢çš„é¢‘ç‡å¤šè¾¹å½¢é‚£æ ·ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦è§‚å¯ŸæŒ‰ä¸åŒç±»åˆ«çš„è¿ç»­å˜é‡çš„åˆ†å¸ƒç›´æ–¹å›¾ã€‚æ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨é¢‘ç‡å¤šè¾¹å½¢æ¥å±•ç¤ºï¼š ggplot(data = diamonds, mapping = aes(x = price)) + geom_freqpoly(mapping = aes(colour = cut), binwidth = 500) ä½†ä¸åŒç±»åˆ«ä¹‹é—´çš„æ•°æ®å·®å¼‚ä¾ç„¶ç›¸å¯¹æ˜æ˜¾ï¼Œä¸€äº›ç›¸å¯¹ â€œå°å¾—å¤šâ€ çš„ç±»åˆ«çš„å½¢çŠ¶éš¾ä»¥è¢«è§‚å¯Ÿåˆ°ã€‚ä½¿ç”¨æŸ±çŠ¶å›¾å¯ä»¥æ˜æ˜¾çœ‹åˆ°å„ä¸ªç§ç±»è®¡æ•°å·®å¼‚å·¨å¤§ï¼š ggplot(diamonds) + geom_bar(mapping = aes(x = cut)) å› æ­¤æˆ‘ä»¬éœ€è¦ä¿®æ”¹ y è½´çš„å†…å®¹ã€‚æˆ‘ä»¬å°†ä¸æ˜¾ç¤ºè®¡æ•°ï¼Œè€Œæ˜¯æ˜¾ç¤ºå¯†åº¦ï¼ˆä½¿å…¶æ ‡å‡†åŒ–ï¼‰ï¼Œä»¥ä¾¿æ¯ä¸ªé¢‘ç‡å¤šè¾¹å½¢å›´æˆçš„é¢ç§¯æ­£å¥½ä¸º 1ï¼š ggplot(data = diamonds, mapping = aes(x = price, y = ..density..)) + geom_freqpoly(mapping = aes(colour = cut), binwidth = 500) #&gt; Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0. #&gt; â„¹ Please use `after_stat(density)` instead. #&gt; This warning is displayed once every 8 hours. #&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #&gt; generated. å®é™…ç»“æœä»¤äººéœ‡æƒŠï¼å“è´¨æœ€å·®é’»çŸ³å´æœ‰ç€æœ€é«˜çš„å¹³å‡ä»·æ ¼ï¼ï¼ˆUCï¼šæ˜å¤©æ¥ä¸Šç­ï¼‰è¿™ä¸ªå›¾ä¸­æœ‰å¾ˆå¤šæœ‰è¶£çš„ç°è±¡ï¼Œæˆ‘ä»¬å°†åœ¨åé¢çš„å­¦ä¹ ä¸­ç»§ç»­åšæ·±åº¦æŒ–æ˜ã€‚ 8.3.1.2 ç®±å½¢å›¾ï¼ˆç®±çº¿å›¾ï¼‰ ç®±çº¿å›¾æ˜¯ä¸€ç§åœ¨ç»Ÿè®¡å­¦å®¶ä¸­æµè¡Œçš„å€¼åˆ†å¸ƒçš„è§†è§‰é€Ÿè®°ã€‚å…¶å…ƒç´ ç»„æˆåŒ…æ‹¬ï¼š ç›’å­ä¸­é—´ï¼šä¸­ä½æ•° ç›’å­ä¸¤å¤´ï¼š25% å’Œ 75%ï¼Œä¹Ÿç§°ä¸ºå››åˆ†ä½è·ï¼ˆä¸¤å¤´è·ç¦»é•¿åº¦ç§°ä½œ IQRï¼‰ ç›’å­ä¸¤å¤´å»¶ä¼¸çš„ç»†çº¿ï¼šä»ç›’å­ä¸¤å¤´ç®—èµ·ä¸è¶…è¿‡ IQR çš„ 1.5 å€çš„æœ€å°å’Œæœ€å¤§å€¼ ç›’å­ä¸¤å¤´è¿œå¤„çš„ç‚¹ï¼šè¶…è¿‡ IQR çš„ 1.5 å€çš„å¼‚å¸¸å€¼ img ggplot(data = diamonds, mapping = aes(x = cut, y = price)) + geom_boxplot() ç®±çº¿å›¾çš„ä¿¡æ¯å±•ç¤ºä¼šæ¯”é¢‘ç‡å¤šè¾¹å½¢è¦ç´§å‡‘å¾—å¤šï¼Œæ›´åˆ©äºæˆ‘ä»¬æ¯”è¾ƒã€‚å®ƒæ”¯æŒäº†ä¸€ä¸ªè¿åç›´è§‰çš„å‘ç°ï¼Œå³è´¨é‡æ›´å¥½çš„é’»çŸ³æ˜æ˜¾æ›´ä¾¿å®œï¼ 8.3.2 å…³äºå˜é‡æ’åº reorder() åƒ cut è¿™æ ·çš„å˜é‡å¯èƒ½è¿˜æœ‰ä¸€ä¸ªè¾ƒå¥½çš„é»˜è®¤æ’åºï¼Œä½†äº‹å®ä¸Šæˆ‘ä»¬é‡åˆ°çš„å¾ˆå¤šæ•°æ®é›†å¯èƒ½æ²¡æœ‰è¿™ä¹ˆå¥½ï¼Œéœ€è¦é‡æ–°æ’åºã€‚reorder() å¯ä»¥å¸®ä½ åšåˆ°ã€‚å¦‚ mpg æ•°æ®é›†çš„ classï¼š ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + geom_boxplot() ä¸ºäº†ä½¿è¶‹åŠ¿æ›´å®¹æ˜“çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ® hwy çš„â€œå€¼â€ é‡æ–°æ’åºï¼š ggplot(data = mpg) + geom_boxplot(mapping = aes( # reorder æ’åºï¼Œå¯¹ class æ ¹æ®å¯¹åº”çš„ hwy å€¼è¿›è¡Œæ’åº, median ç”¨æ¥ç¡®è®¤å‡½æ•°æ˜¯å¦å…·æœ‰è¿”å›å€¼ x = reorder(class, hwy, FUN = median), y = hwy )) + coord_flip() # xy è½´äº¤æ¢ï¼Œæ–¹ä¾¿å±•ç¤ºé•¿å˜é‡å 8.3.3 ä¸¤ä¸ªåˆ†ç±»å˜é‡ 8.3.3.1 äº¤ç‚¹å›¾ æŸ¥çœ‹é¢œè‰²ä¸è´¨é‡çš„å…³ç³»ï¼š ggplot(data = diamonds_new) + # geom_count ç”¨æ¥é€šè¿‡æ˜¾ç¤ºç‚¹çš„å¤§å°å±•ç¤ºæ•°æ®å¤§å°ï¼ˆæ¬¡æ•°ã€é¢‘ç‡ï¼‰ geom_count(mapping = aes(x = color, y = cut)) 8.3.3.2 è‰²ç –å›¾ diamonds_new %&gt;% count(color, cut) %&gt;% # è¿™é‡Œåªèƒ½æ‰‹åŠ¨è®¡æ•°ï¼Œä½†ä¸éœ€è¦ group_by ggplot(mapping = aes(x = color, y = cut)) + # æ³¨æ„è¿™é‡Œçš„ color åªæ˜¯è¾¹æ¡†é¢œè‰² geom_tile(mapping = aes(fill = n), color = &quot;grey50&quot;) æ³¨æ„ä»…æ±‚æ•°æ®å¯ä»¥ç”¨ count() å®ç°ï¼š diamonds %&gt;% count(color, cut) #&gt; # A tibble: 35 Ã— 3 #&gt; color cut n #&gt; &lt;ord&gt; &lt;ord&gt; &lt;int&gt; #&gt; 1 D Fair 163 #&gt; 2 D Good 662 #&gt; 3 D Very Good 1513 #&gt; 4 D Premium 1603 #&gt; 5 D Ideal 2834 #&gt; 6 E Fair 224 #&gt; 7 E Good 933 #&gt; 8 E Very Good 2400 #&gt; 9 E Premium 2337 #&gt; 10 E Ideal 3903 #&gt; # â€¦ with 25 more rows 8.3.4 ä¸¤ä¸ªè¿ç»­å˜é‡ 8.3.4.1 äºŒç»´è£…ç®± å¯è§†åŒ–ä¸¤ä¸ªè¿ç»­å˜é‡ä¹‹é—´åå˜é‡çš„ä¸€ç§å¥½æ–¹æ³•å°±æ˜¯ä½¿ç”¨ç»˜åˆ¶æ•£ç‚¹å›¾ã€‚å¦‚æŸ¥çœ‹è´¨é‡ä¸ä»·æ ¼çš„å…³ç³»ï¼š ggplot(data = diamonds) + geom_point(mapping = aes(x = carat, y = price)) æ•£ç‚¹å›¾çš„ç‚¹å¼€å§‹è¿‡åº¦ç»˜åˆ¶ï¼Œå¹¶å¯†é›†å †ç§¯æˆå‡åŒ€é»‘è‰²çš„åŒºåŸŸï¼ˆå¦‚ä¸Šæ‰€è¿°ï¼‰ã€‚ä¸€ç§è§£å†³æ–¹æ³•æ˜¯å¢åŠ é€æ˜åº¦ï¼š ggplot(data = diamonds_new) + geom_point(mapping = aes(x = carat, y = price), alpha = 1 / 100) # å¯¹äºéå¸¸å¤§çš„æ•°æ®é›†ï¼Œä½¿ç”¨é€æ˜åº¦å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ã€‚ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨äºŒç»´è£…ç®± # é€šè¿‡æ–¹å½¢å°è‰²å—ï¼ˆç±»ä¼¼å¹³å‡å€¼æ•ˆæœï¼‰æ¥æ¨¡ç³Šæ•°æ® ggplot(data = diamonds_new) + geom_bin2d(mapping = aes(x = carat, y = price)) # æˆ–è€…ä½¿ç”¨å…­è¾¹å½¢å°å—ï¼ˆéœ€è¦å®‰è£…åŒ… hexbinï¼‰ #* install.packages(&quot;hexbin&quot;) ggplot(data = diamonds_new) + geom_hex(mapping = aes(x = carat, y = price)) 8.3.4.2 ç®±çº¿å›¾è£…ç®± å¦ä¸€ç§é€‰æ‹©æ˜¯å°†ä¸€ä¸ªè¿ç»­å˜é‡è£…ç®±ï¼Œä½¿å…¶åƒåˆ†ç±»å˜é‡ä¸€æ ·å·¥ä½œã€‚æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ cut_width åˆ†ç»„ï¼š ggplot(data = diamonds_new, mapping = aes(x = carat, y = price)) + # cut_width æ˜¯ ggplot åŒ…çš„å‡½æ•°ï¼Œç”¨æ¥åˆ‡ç‰‡é…åˆåˆ†ç»„ï¼Œå°†å‰è€…ä»¥åè€…æ•°å€¼åˆ’åˆ† geom_boxplot(mapping = aes(group = cut_width(carat, 0.3))) æˆ–è€…åœ¨æ¯ä¸ªæ¡æŸ±ä¸­æ˜¾ç¤ºå¤§è‡´ç›¸åŒçš„ç‚¹æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨ cut_number() åˆ†ç»„ï¼š ggplot(data = diamonds_new, mapping = aes(x = carat, y = price)) + geom_boxplot(mapping = aes(group = cut_number(carat, 20))) "],["workflow-projects.html", "Chapter 9 Workflow: projects 9.1 è¿è¡Œç¯å¢ƒ 9.2 å·¥ä½œåŒº 9.3 è·¯å¾„ä¸ç›®å½• 9.4 RStudio é¡¹ç›®", " Chapter 9 Workflow: projects 9.1 è¿è¡Œç¯å¢ƒ ä½¿ç”¨ R è„šæœ¬ï¼ˆå’Œæ•°æ®æ–‡ä»¶ï¼‰ï¼Œå¯ä»¥é‡æ–°åˆ›å»ºç¯å¢ƒã€‚ä»ç¯å¢ƒä¸­é‡æ–°åˆ›å»º R è„šæœ¬è¦å›°éš¾å¾—å¤šï¼ä½ è¦ä¹ˆå¿…é¡»ä»å†…å­˜ä¸­é‡æ–°é”®å…¥å¤§é‡ä»£ç ï¼Œè¦ä¹ˆå¿…é¡»ä»”ç»†æŒ–æ˜ä½ çš„ R è„šæœ¬æ‰§è¡Œå†å²è®°å½•ã€‚ ä¸ºäº†åŸ¹å…»è¿™ç§è¡Œä¸ºï¼Œæˆ‘å¼ºçƒˆå»ºè®®æˆ‘ä»¬å°† RStudio è®¾ç½®ä¸ºä¸è¦åœ¨ä¼šè¯ä¹‹é—´ä¿ç•™æˆ‘ä»¬çš„å·¥ä½œåŒºè®°å½•ï¼š rstudio-workspace æœ‰ä¸€å¯¹å¾ˆæ£’çš„é”®ç›˜å¿«æ·é”®å¯ä»¥ååŒå·¥ä½œï¼Œä»¥ç¡®ä¿æˆ‘ä»¬åœ¨ç¼–è¾‘å™¨ä¸­å­˜å‚¨äº†ä»£ç çš„é‡è¦éƒ¨åˆ†ï¼š Cmd/Ctrl + Shift + F10 é‡æ–°å¯åŠ¨ RStudioã€‚ Cmd/Ctrl + Shift + S é‡æ–°è¿è¡Œå½“å‰è„šæœ¬ã€‚ 9.2 å·¥ä½œåŒº å·¥ä½œåŒºç›®å½•å¯¹ R çš„æ–‡ä»¶è·¯å¾„å¤„ç†ä¸Šéå¸¸é‡è¦ã€‚è¿™æ˜¯ R æŸ¥æ‰¾ä½ æ‰€è¦æ±‚åŠ è½½æ–‡ä»¶å’Œä¿å­˜æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚RStudio åœ¨æ§åˆ¶å°é¡¶éƒ¨ä¼šæ˜¾ç¤ºå½“å‰çš„å·¥ä½œç›®å½•ï¼š rstudio-wd ä½¿ç”¨ getwd() å‘½ä»¤åœ¨ R æ§åˆ¶å°ä¸­æ‰“å°å‡ºæ¥ï¼š getwd() #&gt; [1] &quot;/Users/runner/work/r-learning/r-learning/book&quot; ä½œä¸º R ç”¨æˆ·ï¼Œå¯ä»¥è®©ä½ çš„ä»»ä½•å¥‡æ€ªçš„ç›®å½•æˆä¸º R çš„å·¥ä½œç›®å½•ã€‚æˆ‘ä»¬åº”è¯¥å¾ˆå¿«å°†è¦åˆ†æçš„é¡¹ç›®ç»„ç»‡åˆ°ç›®å½•ä¸­ï¼Œå¹¶ä¸”åœ¨å¤„ç†é¡¹ç›®æ—¶ï¼Œå°† R çš„å·¥ä½œç›®å½•è®¾ç½®ä¸ºä¸ä¹‹å…³è”çš„ç›®å½•ã€‚ ä½¿ç”¨ setwd() ä»æ§åˆ¶å°ä¸­è®¾ç½®å·¥ä½œç›®å½•ï¼ˆä¸æ¨èï¼‰ï¼š setwd(&quot;/path/to/my/CoolProject&quot;) 9.3 è·¯å¾„ä¸ç›®å½• è·¯å¾„å’Œç›®å½•æœ‰ç‚¹å¤æ‚ï¼Œå› ä¸ºMac/Linux å’Œ Windows ä¸¤è€…ä¸å¤ªä¸€æ ·ï¼š Mac å’Œ Linux ä½¿ç”¨æ–œæ  â€œ/â€ï¼ŒWindows ä½¿ç”¨åæ–œæ  â€œâ€ã€‚R å¯ä»¥ä½¿ç”¨ä»»ä½•ä¸€ç§ç±»å‹ï¼ˆæ— è®ºæˆ‘ä»¬å½“å‰ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆå¹³å°ï¼‰ï¼Œä½†åœ¨è·¯å¾„ä¸­è¦å•ä¸ªåæ–œæ ï¼Œæˆ‘ä»¬éœ€è¦é”®å…¥ä¸¤ä¸ªåæ–œæ å»ç­‰æ•ˆï¼Œæ‰€ä»¥å»ºè®®å§‹ç»ˆä½¿ç”¨æ­£æ–œæ è·¯å¾„ï¼Œå¦‚ï¼šplots/diamonds.pdf ç»å¯¹è·¯å¾„çœ‹èµ·æ¥éƒ½ä¸åŒã€‚åœ¨ Windows ä¸­ï¼Œå®ƒä»¬ä»¥é©±åŠ¨å™¨å· + å†’å· + ä¸¤ä¸ªåæ–œæ å¼€å¤´ï¼Œå¦‚ C:\\\\servernameï¼›è€Œåœ¨ Mac / Linux ä¸­ï¼Œå®ƒä»¬ä»¥æ–œæ å¼€å¤´ï¼Œå¦‚ /users/hadleyã€‚æ‰€ä»¥å»ºè®®ä¸ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œä»¥ä¿è¯ä»£ç çš„å…¼å®¹æ€§å’Œå¯å…±äº«æ€§ã€‚ ~ æŒ‡å‘çš„åœ°æ–¹ä¹Ÿä¸å¤ªç›¸åŒã€‚å®ƒæœ¬æ˜¯é€šå¾€ä¸»ç›®å½•çš„ä¾¿æ·æ–¹å¼ï¼Œä½† Windows å¹¶æ²¡æœ‰è¿™ç§æ¦‚å¿µï¼Œå› æ­¤ R ä¸­å®ƒæŒ‡å‘æ–‡æ¡£ç›®å½•ã€‚ 9.4 RStudio é¡¹ç›® ä¸€ä¸ªæ™®éæ˜æ™ºçš„åšæ³•æ˜¯ï¼Œå°†ä¸é¡¹ç›®å…³è”çš„æ‰€æœ‰æ–‡ä»¶ä¿å­˜åœ¨ä¸€èµ·ï¼ŒåŒ…æ‹¬è¾“å…¥æ•°æ®ã€R è„šæœ¬ã€åˆ†æç»“æœå’Œæ•°å­—ã€‚ å•å‡» æ–‡ä»¶ &gt; æ–°å»ºé¡¹ç›® æ¥åˆ›å»ºå®ƒï¼š rstudio-project-1 rstudio-project-2 rstudio-project-3 ä»¥åä¿å­˜æ–‡ä»¶åº”è¯¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š library(tidyverse) ggplot(diamonds, aes(carat, price)) + geom_hex() ggsave(&quot;diamonds.pdf&quot;) write_csv(diamonds, &quot;diamonds.csv&quot;) "],["wrangle-intro.html", "Chapter 10 Introduction", " Chapter 10 Introduction æ•°æ®æ‰­ç»“ï¼Œä»¥åˆé€‚çš„å½¢å¼å°†æ•°æ®å¯¼å…¥ R ç”¨äºå¯è§†åŒ–å’Œå»ºæ¨¡ã€‚æ•°æ®æ•´ç†éå¸¸é‡è¦ï¼šæ²¡æœ‰å®ƒï¼Œä½ å°±æ— æ³•å¤„ç†è‡ªå·±çš„æ•°æ®ï¼æ•°æ®æ•´ç†æœ‰ä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ï¼š data-science-wrangle åœ¨ tibbles ä¸­ï¼Œä½ å°†äº†è§£åˆ°è´¯ç©¿å…¨å…¨ç¬”è®°ä¸­ä½¿ç”¨çš„ dataframe çš„å˜ä½“ï¼štibbleã€‚ä½ å°†äº†è§£å®ƒä»¬ä¸å¸¸è§„æ•°æ®æ¡†çš„ä¸åŒä¹‹å¤„ï¼Œä»¥åŠå¦‚ä½• â€œæ‰‹åŠ¨â€ æ„å»ºå®ƒä»¬ã€‚ åœ¨æ•°æ®å¯¼å…¥ä¸­ï¼Œä½ å°†äº†è§£å¦‚ä½•å°†æ•°æ®ä»ç£ç›˜è·å–åˆ° R ä¸­ã€‚æˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»çº¯æ–‡æœ¬çš„çŸ©é˜µæ ¼å¼ï¼Œä½†ä¼šä¸ºä½ æä¾›æŒ‡å‘æœ‰åŠ©äºå¤„ç†å…¶ä»–ç±»å‹çš„æ•°æ®çš„åŒ…çš„æŒ‡å—ã€‚ åœ¨æ•´æ´çš„æ•°æ®ä¸­ï¼Œä½ å°†äº†è§£æ•´æ´çš„æ•°æ®ï¼Œè¿™æ˜¯ä¸€ç§å­˜å‚¨æ•°æ®çš„ä¸€ç§çº¦å®šä¿—æˆçš„æ–¹å¼ï¼Œä½¿è½¬æ¢ã€å¯è§†åŒ–å’Œå»ºæ¨¡æ›´åŠ å®¹æ˜“ã€‚ä½ å°†å­¦ä¹ åŸºæœ¬åŸåˆ™ï¼Œä»¥åŠå¦‚ä½•å°†æ•°æ®è½¬æ¢ä¸ºæ•´æ´çš„å½¢å¼ã€‚ æ•°æ®æ‰­ç»“è¿˜åŒ…æ‹¬æ•°æ®è½¬æ¢ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»å®è·µä¸­å¸¸ç”¨çš„ä¸‰ç§ç‰¹å®šç±»å‹æ•°æ®çš„æ–°æŠ€èƒ½ï¼š å…³ç³»æ•°æ®å°†ä¸ºä½ æä¾›ç”¨äºå¤„ç†å¤šä¸ªç›¸äº’å…³è”çš„æ•°æ®é›†çš„å·¥å…·ã€‚ å­—ç¬¦ä¸²å·¥å…·å°†æºæ‰‹æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™æ˜¯ä¸€ç§ç”¨äºæ“ä½œå­—ç¬¦ä¸²çš„å¼ºå¤§å·¥å…·ã€‚ å› å­æ˜¯ R å¦‚ä½•å­˜å‚¨åˆ†ç±»æ•°æ®çš„ã€‚ä¸€èˆ¬è¢«ç”¨äºå½“å˜é‡å…·æœ‰ä¸€ç»„å›ºå®šçš„å¯èƒ½å€¼ï¼Œæˆ–è€…å½“ä½ å¸Œæœ›ä½¿ç”¨å­—ç¬¦ä¸²çš„éå­—æ¯æ’åºã€‚ æ—¥æœŸå’Œæ—¶é—´å·¥å…·å°†ä¸ºä½ æä¾›å¤„ç†æ—¥æœŸå’Œæ—¥æœŸæ—¶é—´çš„å…³é”®å·¥å…·ã€‚ "],["tibbles.html", "Chapter 11 Tibbles 11.1 åˆ›å»º tibble 11.2 tibbles VS. data.frame 11.3 tibble çš„è½¬æ¢", " Chapter 11 Tibbles å°±åƒæˆ‘ä»¬ä¹‹å‰æåˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨æ¥è‡ª tidyverse çš„ tibblesï¼Œè€Œä¸æ˜¯ R ä¼ ç»Ÿçš„ data.frameã€‚Tibbles æ˜¯ä¸€ç§æ¯” R è‡ªå¸¦çš„ dataframe æ›´äººæ€§åŒ–æ›´æ–¹ä¾¿çš„æ•°æ®é›†å­˜å‚¨å½¢å¼ã€‚ library(tidyverse) 11.1 åˆ›å»º tibble 11.1.1 as_tibble() æˆ‘ä»¬ä½¿ç”¨ as_tibble() æ¥è½¬åŒ–åŸæœ‰çš„ dataframeï¼š as_tibble(iris) #&gt; # A tibble: 150 Ã— 5 #&gt; Sepal.Length Sepal.Width Petal.Length Petal.Width Species #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; #&gt; 1 5.1 3.5 1.4 0.2 setosa #&gt; 2 4.9 3 1.4 0.2 setosa #&gt; 3 4.7 3.2 1.3 0.2 setosa #&gt; 4 4.6 3.1 1.5 0.2 setosa #&gt; 5 5 3.6 1.4 0.2 setosa #&gt; 6 5.4 3.9 1.7 0.4 setosa #&gt; 7 4.6 3.4 1.4 0.3 setosa #&gt; 8 5 3.4 1.5 0.2 setosa #&gt; 9 4.4 2.9 1.4 0.2 setosa #&gt; 10 4.9 3.1 1.5 0.1 setosa #&gt; # â€¦ with 140 more rows 11.1.2 tibble() æˆ–è€…ä½¿ç”¨ tibble() ç›´æ¥åˆ›å»ºï¼š tibble( x = 1:5, y = 1, z = x^2 + y ) #&gt; # A tibble: 5 Ã— 3 #&gt; x y z #&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 1 2 #&gt; 2 2 1 5 #&gt; 3 3 1 10 #&gt; 4 4 1 17 #&gt; 5 5 1 26 11.1.3 tribble() è¿™ç§æ–¹æ³•çœŸçš„ä¼˜é›…å¾ˆå¤šï¼å°±åƒä½ åœ¨ä¹¦å†™ markdown ä¸€æ · ~ tribble( ~x, ~y, ~z, #--|--|--- &quot;a&quot;, 2, 3.6, &quot;b&quot;, 1, 8.5 ) #&gt; # A tibble: 2 Ã— 3 #&gt; x y z #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 a 2 3.6 #&gt; 2 b 1 8.5 å°†ç¬¦å·æˆ–æ•°å­—æ”¾åœ¨å¼€å¤´è™½ç„¶å¢™è£‚ä¸æ¨èï¼Œä½† tibble ä¹Ÿä¸ä¼šæŠ¥é”™ï¼š tb &lt;- tibble( `:)` = &quot;smile&quot;, # æ³¨æ„ä½¿ç”¨ `` æ¥å›Šæ‹¬ ` ` = &quot;space&quot;, `2000` = &quot;number&quot; ) tb #&gt; # A tibble: 1 Ã— 3 #&gt; `:)` ` ` `2000` #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 smile space number 11.2 tibbles VS. data.frame 11.2.1 æ§åˆ¶å°æ‰“å°æ–¹é¢ tibble( a = lubridate::now() + runif(1e3) * 86400, b = lubridate::today() + runif(1e3) * 30, c = 1:1e3, d = runif(1e3), e = sample(letters, 1e3, replace = TRUE) ) #&gt; # A tibble: 1,000 Ã— 5 #&gt; a b c d e #&gt; &lt;dttm&gt; &lt;date&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 2023-03-21 04:22:49 2023-04-11 1 0.534 w #&gt; 2 2023-03-20 22:22:41 2023-04-17 2 0.128 n #&gt; 3 2023-03-20 16:25:54 2023-04-12 3 0.435 f #&gt; 4 2023-03-21 06:15:45 2023-04-15 4 0.438 o #&gt; 5 2023-03-21 03:26:58 2023-04-01 5 0.122 j #&gt; 6 2023-03-20 09:25:12 2023-03-26 6 0.564 h #&gt; 7 2023-03-21 03:35:17 2023-04-06 7 0.997 d #&gt; 8 2023-03-21 06:50:48 2023-03-30 8 0.283 g #&gt; 9 2023-03-20 12:49:29 2023-04-14 9 0.603 d #&gt; 10 2023-03-20 21:36:03 2023-04-11 10 0.886 v #&gt; # â€¦ with 990 more rows tibble å¯¹äºå¤ªå¤šçš„æ•°æ®ï¼Œåªä¼šæ˜¾ç¤ºå‰åè¡Œï¼Œä¸ä¼šè®©ä½ çš„æ§åˆ¶å°è¢«å†…å®¹æ·¹æ²¡ï¼›åŒæ—¶ä¼šæ˜¾ç¤ºæ¯ä¸€åˆ—çš„æ•°æ®ç±»å‹ã€‚è¿™å¾—ç›Šäº str() å‡½æ•°ã€‚ tibble è¿˜å®Œç¾å…¼å®¹ print() å‡½æ•°ï¼š nycflights13::flights %&gt;% print(n = 10, width = Inf) # Inf è¡¨ç¤ºæ— é™ï¼Œå³æ‰€æœ‰æŒ‡å®šå†…å®¹ï¼ˆå‰åè¡Œï¼‰éƒ½æ‰“å° #&gt; # A tibble: 336,776 Ã— 19 #&gt; year month day dep_time sched_dep_time dep_delay arr_time sched_arr_time #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 2013 1 1 517 515 2 830 819 #&gt; 2 2013 1 1 533 529 4 850 830 #&gt; 3 2013 1 1 542 540 2 923 850 #&gt; 4 2013 1 1 544 545 -1 1004 1022 #&gt; 5 2013 1 1 554 600 -6 812 837 #&gt; 6 2013 1 1 554 558 -4 740 728 #&gt; 7 2013 1 1 555 600 -5 913 854 #&gt; 8 2013 1 1 557 600 -3 709 723 #&gt; 9 2013 1 1 557 600 -3 838 846 #&gt; 10 2013 1 1 558 600 -2 753 745 #&gt; arr_delay carrier flight tailnum origin dest air_time distance hour minute #&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 11 UA 1545 N14228 EWR IAH 227 1400 5 15 #&gt; 2 20 UA 1714 N24211 LGA IAH 227 1416 5 29 #&gt; 3 33 AA 1141 N619AA JFK MIA 160 1089 5 40 #&gt; 4 -18 B6 725 N804JB JFK BQN 183 1576 5 45 #&gt; 5 -25 DL 461 N668DN LGA ATL 116 762 6 0 #&gt; 6 12 UA 1696 N39463 EWR ORD 150 719 5 58 #&gt; 7 19 B6 507 N516JB EWR FLL 158 1065 6 0 #&gt; 8 -14 EV 5708 N829AS LGA IAD 53 229 6 0 #&gt; 9 -8 B6 79 N593JB JFK MCO 140 944 6 0 #&gt; 10 8 AA 301 N3ALAA LGA ORD 138 733 6 0 #&gt; time_hour #&gt; &lt;dttm&gt; #&gt; 1 2013-01-01 05:00:00 #&gt; 2 2013-01-01 05:00:00 #&gt; 3 2013-01-01 05:00:00 #&gt; 4 2013-01-01 05:00:00 #&gt; 5 2013-01-01 06:00:00 #&gt; 6 2013-01-01 05:00:00 #&gt; 7 2013-01-01 06:00:00 #&gt; 8 2013-01-01 06:00:00 #&gt; 9 2013-01-01 06:00:00 #&gt; 10 2013-01-01 06:00:00 #&gt; # â€¦ with 336,766 more rows æŸ¥çœ‹æ•°æ®çš„å¦ä¸€ç§åŠæ³•æ˜¯ä½¿ç”¨ view() å‡½æ•°ï¼Œä¼šæ›´ç›´è§‚åœ°æ˜¾ç¤ºåœ¨ä½ çš„ç¼–è¾‘å™¨ä¸Šã€‚ nycflights13::flights %&gt;% head(10) %&gt;% view() # è¯·ä¸è¦å°è¯•å±•ç¤ºå¤ªå¤šæ•°æ®ï¼å°å¿ƒçš„çš„ç”µè„‘ç‚¸æ‰ï¼ˆ 11.2.2 è¯»å–å­å…ƒç´ æ–¹é¢ å…ƒæ•°æ®å»ºç«‹å¦‚ä¸‹ï¼š df &lt;- tibble( x = runif(5), y = rnorm(5) ) æŒ‰åå­—è¯»å–: df$x #&gt; [1] 0.461996860 0.649550854 0.209416986 0.002434091 0.953380785 df[[&quot;x&quot;]] #&gt; [1] 0.461996860 0.649550854 0.209416986 0.002434091 0.953380785 æŒ‰åºåˆ—ä½ç½®è¯»å–ï¼š df[[1]] #&gt; [1] 0.461996860 0.649550854 0.209416986 0.002434091 0.953380785 ä½†å¦‚æœä½¿ç”¨ç®¡é“ç¬¦çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ â€œ.â€ï¼š df %&gt;% .$x #&gt; [1] 0.461996860 0.649550854 0.209416986 0.002434091 0.953380785 df %&gt;% .[[&quot;x&quot;]] #&gt; [1] 0.461996860 0.649550854 0.209416986 0.002434091 0.953380785 11.3 tibble çš„è½¬æ¢ ä¸Šé¢æåˆ°ä½¿ç”¨ as_tibble() å°† data.frame è½¬æ¢ä¸º tibbleï¼Œè€Œ as.data.frame() å‡½æ•°åˆ™æ˜¯å°† tibble è½¬åŒ–ä¸º data.frameï¼š class(as.data.frame(tb)) # class() å‡½æ•°ç”¨äºæ£€æŸ¥æ•°æ®æ ¼å¼ #&gt; [1] &quot;data.frame&quot; "],["data-import.html", "Chapter 12 Data import 12.1 ç®€å•è¯»å–æ–‡ä»¶ 12.2 è§£æå‘é‡ 12.3 æ•°å­—ç±»å‹ 12.4 å­—ç¬¦ç±»å‹ 12.5 å› å­ç±»å‹ 12.6 æ—¥æœŸæ—¶é—´ç±»å‹ 12.7 è§£ææ–‡ä»¶ 12.8 å†™å…¥æ•°æ®", " Chapter 12 Data import library(tidyverse) 12.1 ç®€å•è¯»å–æ–‡ä»¶ æ–‡ä»¶ç‰¹å¾ å‡½æ•° é€‚ç”¨æ¡ä»¶ ç¬¦å·åˆ†éš” read_csv() é€—å·åˆ†éš” ç¬¦å·åˆ†éš” read_csv2() åˆ†å·åˆ†éš”ï¼ˆå¸¸è§äºç”¨ä½œå°æ•°ä½çš„å›½å®¶ï¼‰ ç¬¦å·åˆ†éš” read_tsv() åˆ¶è¡¨ç¬¦åˆ†éš” ç¬¦å·åˆ†éš” read_delim() ä»»ä½•ç¬¦å·åˆ†éš” å›ºå®šå®½åº¦ read_fwf() å›ºå®šå®½åº¦ å›ºå®šå®½åº¦ fwf_widths() å®½åº¦æŒ‡å®šå­—æ®µ å›ºå®šå®½åº¦ fwf_positions() ä½ç½®æŒ‡å®šå­—æ®µ å›ºå®šå®½åº¦ read_table() å›ºå®šå®½åº¦æ–‡ä»¶çš„å¸¸è§å˜ä½“ï¼Œä¸”åˆ—ç”¨ç©ºæ ¼åˆ†éš” æ—¥å¿— read_log() Apache é£æ ¼çš„æ—¥å¿—æ–‡ä»¶ æ­¤å¤– webreadr åŸºäº read_log() æ„å»ºï¼Œå¹¶æä¾›æ›´å¤šæœ‰ç”¨çš„å·¥å…·ã€‚è¿™äº›å‡½æ•°éƒ½æœ‰ç±»ä¼¼çš„è¯­æ³•ï¼šä¸€æ—¦æˆ‘ä»¬æŒæ¡äº†ä¸€ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°ä½¿ç”¨å…¶ä»–åŠŸèƒ½ã€‚ csv æ–‡ä»¶æ˜¯æœ€å¸¸è§çš„æ•°æ®å­˜å‚¨å½¢å¼ä¹‹ä¸€ã€‚æˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨ read_csv()ï¼Œå…¶é¦–ä¸ªå‚æ•°æœ€ä¸ºé‡è¦ï¼Œå³è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚ read_csv() ä¼šç»™å‡ºç›¸å½“ä¸°å¯Œçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡Œåˆ—æ•°ã€åˆ†éš”ç¬¦ã€å„åˆ—çš„æ•°æ®æ ¼å¼ï¼ˆè‡ªåŠ¨è¯†åˆ«ï¼‰ç­‰ï¼š heights &lt;- read_csv(&quot;./data/heights.csv&quot;) #&gt; Rows: 1192 Columns: 6 #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; Delimiter: &quot;,&quot; #&gt; chr (2): sex, race #&gt; dbl (4): earn, height, ed, age #&gt; #&gt; â„¹ Use `spec()` to retrieve the full column specification for this data. #&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message. å¯¹äºå†…è”è¡¨æ ¼æˆ‘ä»¬åŒæ ·å¯ä»¥è¿™æ ·å¤„ç†ï¼š read_csv(&quot;a,b,c 1,2,3 4,5,6&quot;) #&gt; Rows: 2 Columns: 3 #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; Delimiter: &quot;,&quot; #&gt; dbl (3): a, b, c #&gt; #&gt; â„¹ Use `spec()` to retrieve the full column specification for this data. #&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #&gt; # A tibble: 2 Ã— 3 #&gt; a b c #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 2 3 #&gt; 2 4 5 6 å¦‚æœå†…å®¹çš„å¼€å¤´æœ‰ä¸€äº›ä¸éœ€è¦çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è·³è¿‡å¼€å¤´çš„å†…å®¹ï¼š read_csv(&quot;The first line of metadata The second line of metadata x,y,z 1,2,3&quot;, skip = 2) #&gt; Rows: 1 Columns: 3 #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; Delimiter: &quot;,&quot; #&gt; dbl (3): x, y, z #&gt; #&gt; â„¹ Use `spec()` to retrieve the full column specification for this data. #&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #&gt; # A tibble: 1 Ã— 3 #&gt; x y z #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 2 3 æˆ–è€…ç›´æ¥è·³è¿‡ä»¥æŒ‡å®šå­—ç¬¦å¼€å¤´çš„è¡Œï¼ˆå¦‚ä»¥ â€œ#â€ å¼€å¤´ï¼‰ read_csv(&quot;# A comment I want to skip x,y,z 1,2,3&quot;, comment = &quot;#&quot;) #&gt; Rows: 1 Columns: 3 #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; Delimiter: &quot;,&quot; #&gt; dbl (3): x, y, z #&gt; #&gt; â„¹ Use `spec()` to retrieve the full column specification for this data. #&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #&gt; # A tibble: 1 Ã— 3 #&gt; x y z #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 2 3 æœ‰æ—¶å¯¼å…¥çš„æ•°æ®å¯èƒ½æ²¡æœ‰è¡¨å¤´ï¼å¿½ç•¥æ‰è¡¨å¤´ï¼ŒR ä¼šä¸ºä½ åŠ ä¸Š â€œX1â€ã€â€œX2â€â€¦ read_csv(&quot;1,2,3\\n4,5,6&quot;, col_names = FALSE) #&gt; Rows: 2 Columns: 3 #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; Delimiter: &quot;,&quot; #&gt; dbl (3): X1, X2, X3 #&gt; #&gt; â„¹ Use `spec()` to retrieve the full column specification for this data. #&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #&gt; # A tibble: 2 Ã— 3 #&gt; X1 X2 X3 #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 2 3 #&gt; 2 4 5 6 æˆ–è€…æ‰‹åŠ¨åŠ è¡¨å¤´ï¼š read_csv(&quot;1,2,3\\n4,5,6&quot;, col_names = c(&quot;x&quot;, &quot;y&quot;, &quot;z&quot;)) #&gt; Rows: 2 Columns: 3 #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; Delimiter: &quot;,&quot; #&gt; dbl (3): x, y, z #&gt; #&gt; â„¹ Use `spec()` to retrieve the full column specification for this data. #&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #&gt; # A tibble: 2 Ã— 3 #&gt; x y z #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 2 3 #&gt; 2 4 5 6 ä¸åªæ˜¯è¡¨å¤´ï¼Œæœ‰æ—¶æ•°æ®ä¹Ÿä¼šç¼ºå¤±ã€‚å¯¹ NA å€¼çš„æ•°è¿›è¡Œç¬¦å·æ ‡è®°å³å¯ï¼š read_csv(&quot;a,b,c\\n1,2,.&quot;, na = &quot;.&quot;) #&gt; Rows: 1 Columns: 3 #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; Delimiter: &quot;,&quot; #&gt; dbl (2): a, b #&gt; lgl (1): c #&gt; #&gt; â„¹ Use `spec()` to retrieve the full column specification for this data. #&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #&gt; # A tibble: 1 Ã— 3 #&gt; a b c #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; #&gt; 1 1 2 NA 12.2 è§£æå‘é‡ åœ¨æ·±å…¥äº†è§£é˜…è¯»å™¨å¦‚ä½•ä»ç£ç›˜è¯»å–æ–‡ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ parse_*() å‡½æ•°ã€‚å¯¹è¿™äº›å‡½æ•°ä¼ å…¥å­—ç¬¦ä¸²å‘é‡ï¼Œå¯ä»¥å¾—åˆ°æ•°æ®ç±»å‹æ›´ä¸“ä¸€åˆç†çš„å‘é‡ï¼Œå¦‚é€»è¾‘ã€æ•´æ•°æˆ–æ—¥æœŸï¼š str(parse_logical(c(&quot;TRUE&quot;, &quot;FALSE&quot;, &quot;NA&quot;))) # str() ç”¨äºæ˜¾ç¤º R å¯¹è±¡çš„å†…éƒ¨ç»“æ„ #&gt; logi [1:3] TRUE FALSE NA str(parse_integer(c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;))) #&gt; int [1:3] 1 2 3 str(parse_date(c(&quot;2010-01-01&quot;, &quot;1979-10-14&quot;))) #&gt; Date[1:2], format: &quot;2010-01-01&quot; &quot;1979-10-14&quot; æˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®ç¼ºçœå€¼ï¼š parse_integer(c(&quot;1&quot;, &quot;231&quot;, &quot;.&quot;, &quot;456&quot;), na = &quot;.&quot;) #&gt; [1] 1 231 NA 456 è§£æå¤±è´¥ä¼šæç¤ºç›¸å…³è­¦ç¤ºï¼š x &lt;- parse_integer(c(&quot;123&quot;, &quot;345&quot;, &quot;abc&quot;, &quot;123.45&quot;)) #&gt; Warning: 2 parsing failures. #&gt; row col expected actual #&gt; 3 -- an integer abc #&gt; 4 -- no trailing characters 123.45 ä¹‹åçš„è¯»å–ä¹Ÿä¼šæŠ¥é”™ï¼š x #&gt; [1] 123 345 NA NA #&gt; attr(,&quot;problems&quot;) #&gt; # A tibble: 2 x 4 #&gt; row col expected actual #&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 3 NA an integer abc #&gt; 2 4 NA no trailing characters 123.45 å’Œæç¤ºçš„ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ problems() å‡½æ•°æ˜¾ç¤ºé”™è¯¯æ ¹æºï¼š problems(x) #&gt; # A tibble: 2 x 4 #&gt; row col expected actual #&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 3 NA an integer abc #&gt; 2 4 NA no trailing characters 123.45 12.3 æ•°å­—ç±»å‹ ä¸åŒå›½å®¶åœ°åŒºä½¿ç”¨çš„åˆ†éš”ç¬¦ã€ä¹ æƒ¯ç­‰éƒ½ä¸ç›¸åŒã€‚æ‰€ä»¥è¿™é‡Œæœ‰ locale å‚æ•°ç”¨æ¥å¤„ç†ã€‚å¦‚ï¼š å°æ•°ç‚¹æ ‡è¯†ç¬¦ï¼ˆdecimal_markï¼‰ï¼š parse_double(&quot;1.23&quot;) #&gt; [1] 1.23 parse_double(&quot;1,23&quot;, locale = locale(decimal_mark = &quot;,&quot;)) # æ”¹ç”¨ â€œ,â€ è¯†åˆ« #&gt; [1] 1.23 æ•°å­—å‰åéæ•°å­—å­—ç¬¦ï¼š parse_number(&quot;$100&quot;) #&gt; [1] 100 parse_number(&quot;20%&quot;) #&gt; [1] 20 parse_number(&quot;It cost $123.45&quot;) #&gt; [1] 123.45 ä½æ•°æ ‡è®°ï¼ˆgrouping_markï¼‰ï¼š parse_number(&quot;$123,456,789&quot;) #&gt; [1] 123456789 parse_number(&quot;123.456.789&quot;, locale = locale(grouping_mark = &quot;.&quot;)) # å¸¸è§äºæ¬§æ´² #&gt; [1] 123456789 parse_number(&quot;123&#39;456&#39;789&quot;, locale = locale(grouping_mark = &quot;&#39;&quot;)) # å¸¸è§äºç‘å£« #&gt; [1] 123456789 12.4 å­—ç¬¦ç±»å‹ è²Œä¼¼ parse_character() æ˜¯åªä¼šè¿”å›è¾“å…¥çš„æ— ç”¨å‡½æ•°ã€‚ä½†äº‹å®ä¸Šï¼Œæˆ‘ä»¬æœ‰å¤šç§æ–¹å¼æ¥è¡¨ç¤ºåŒä¸€å­—ç¬¦ä¸²ã€‚è¦äº†è§£ R ä¸­å¦‚ä½•è¡¨ç¤ºå­—ç¬¦ä¸²çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ charToRaw() è·å¾—å­—ç¬¦ä¸²çš„åº•å±‚è¡¨ç¤ºï¼š charToRaw(&quot;Hadley&quot;) #&gt; [1] 48 61 64 6c 65 79 åƒè¿™æ ·ï¼Œä»åå…­è¿›åˆ¶æ•°å­—åˆ°å­—ç¬¦çš„æ˜ å°„çš„ç¼–ç ç§°ä¸º ASCIIï¼Œä¹Ÿæ˜¯ç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ã€‚ä½†è‹±è¯­ä»¥å¤–çš„ç¼–ç å°±éå¸¸å¤æ‚äº†ï¼Œç”¨ä¸åŒç¼–ç è¯»å–æ•°æ®ï¼Œä»–ä»¬å°†å®Œå…¨ä¸åŒã€‚ å¦‚ä»Šæˆ‘ä»¬æœ‰ä¸€ä¸ªé€šç”¨æ ‡å‡†ï¼šUTF-8ã€‚UTF-8å‡ ä¹å¯ä»¥ç¼–ç å½“ä»Šäººç±»ä½¿ç”¨çš„æ¯ä¸ªå­—ç¬¦ï¼Œä»¥åŠè®¸å¤šé¢å¤–çš„ç¬¦å·ã€‚ ä½†æ—§çš„éé€šç”¨æ ‡å‡†æœ‰æ—¶ä¹Ÿæ˜¯éœ€è¦çš„ï¼š (x1 &lt;- &quot;El Ni\\xf1o was particularly bad this year&quot;) #&gt; [1] &quot;El Ni\\xf1o was particularly bad this year&quot; (x2 &lt;- &quot;\\x82\\xb1\\x82\\xf1\\x82\\xc9\\x82\\xbf\\x82\\xcd&quot;) #&gt; [1] &quot;\\x82\\xb1\\x82\\xf1\\x82É‚\\xbf\\x82\\xcd&quot; ä½¿ç”¨ encoding æ¥è½¬è¯‘å®ƒä»¬çš„ç¼–ç ï¼š parse_character(x1, locale = locale(encoding = &quot;Latin1&quot;)) #&gt; [1] &quot;El NiÃ±o was particularly bad this year&quot; parse_character(x2, locale = locale(encoding = &quot;Shift-JIS&quot;)) #&gt; [1] &quot;ã“ã‚“ã«ã¡ã¯&quot; æœ‰æ—¶æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒæ˜¯ä»€ä¹ˆç±»å‹çš„ç¼–ç ï¼æ‰€å¹¸çš„æ˜¯ï¼Œguess_encodeing() ä¼šå¸®åŠ©æˆ‘ä»¬å°è¯•ï¼š guess_encoding(charToRaw(x1)) #&gt; # A tibble: 2 Ã— 2 #&gt; encoding confidence #&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 ISO-8859-1 0.46 #&gt; 2 ISO-8859-9 0.23 guess_encoding(charToRaw(x2)) #&gt; # A tibble: 1 Ã— 2 #&gt; encoding confidence #&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 KOI8-R 0.42 12.5 å› å­ç±»å‹ R ä½¿ç”¨å› å­æ¥è¡¨ç¤ºå…·æœ‰ä¸€ç»„å·²çŸ¥å¯èƒ½å€¼çš„åˆ†ç±»å˜é‡ã€‚ç»™ parse_factor() ä¸€ä¸ªå·²çŸ¥ levels çš„å‘é‡ï¼Œä»¥ä¾¿åœ¨å‡ºç°æ„å¤–å€¼æ—¶ç”Ÿæˆè­¦å‘Šï¼š fruit &lt;- c(&quot;apple&quot;, &quot;banana&quot;) parse_factor(c(&quot;apple&quot;, &quot;banana&quot;, &quot;bananana&quot;), levels = fruit) #&gt; Warning: 1 parsing failure. #&gt; row col expected actual #&gt; 3 -- value in level set bananana #&gt; [1] apple banana &lt;NA&gt; #&gt; attr(,&quot;problems&quot;) #&gt; # A tibble: 1 x 4 #&gt; row col expected actual #&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 3 NA value in level set bananana #&gt; Levels: apple banana 12.6 æ—¥æœŸæ—¶é—´ç±»å‹ æˆ‘ä»¬å¯ä»¥æ ¹æ®æƒ³è¦çš„æ—¥æœŸï¼ˆè‡ª1970-01-01ä»¥æ¥çš„å¤©æ•°ï¼‰ã€æ—¥æœŸæ—¶é—´ï¼ˆè‡ª1970-01-01å¹´ä»¥æ¥çš„ç§’æ•°ï¼‰æˆ–æ—¶é—´ï¼ˆè‡ªåˆå¤œä»¥æ¥çš„ç§’æ•°ï¼‰ï¼Œåœ¨ä¸‰ä¸ªè§£æå™¨ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚å½“åœ¨æ²¡æœ‰ä»»ä½•å…¶ä»–å‚æ•°çš„æƒ…å†µä¸‹è°ƒç”¨æ—¶ï¼š parse_datetime() æ ¹æ® ISO8601 å›½é™…æ ‡å‡†è½¬æ¢æ—¥æœŸæ—¶é—´ï¼š parse_datetime(&quot;2010-10-01T2010&quot;) #&gt; [1] &quot;2010-10-01 20:10:00 UTC&quot; # If time is omitted, it will be set to midnight parse_datetime(&quot;20101010&quot;) #&gt; [1] &quot;2010-10-10 UTC&quot; parse_date() ç”¨äºè½¬æ¢å››ä½æ•°å¹´ä»½ï¼Œä½¿ç”¨ â€œ-â€ æˆ– â€œ/â€ éƒ½å¯ï¼ˆä½†æ²¡æœ‰åˆ†éš”ç¬¦åˆ™ä¼šæŠ¥é”™ï¼‰ï¼š parse_date(&quot;2010-10-01&quot;) #&gt; [1] &quot;2010-10-01&quot; parse_time() ç”¨äºè½¬æ¢æ—¶åˆ†ç§’ï¼ˆç§’å’Œä¸Šä¸‹åˆå¯é€‰ï¼‰ï¼š library(hms) # R ä¸è‡ªå¸¦ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ hms åŒ…ï¼ˆtidyverse çš„ readr åŒ…ä¹Ÿæœ‰ï¼‰ #&gt; #&gt; Attaching package: &#39;hms&#39; #&gt; The following object is masked from &#39;package:lubridate&#39;: #&gt; #&gt; hms parse_time(&quot;01:10 am&quot;) #&gt; 01:10:00 parse_time(&quot;20:10:01&quot;) #&gt; 20:10:01 æ­¤å¤–æ—¥æœŸæ—¶é—´å­—ç¬¦ä¸²å½¢å¼å¯ä»¥è‡ªå·±åˆ¶å®šï¼š ç±»å‹ è¡¨ç¤ºç¬¦ å¤‡æ³¨ ç¤ºä¾‹ å¹´ %Y 4ä½æ•°å­— å¹´ %y 2ä½æ•°å­— 00-69 -&gt; 2000-2069 æœˆ %m 2ä½æ•°å­— æœˆ %b ç¼©å†™ Jan æœˆ %B å…¨ç§° ä¸€æœˆ æ—¥ %d 2ä½æ•°å­— æ—¥ %e optional leading space æ—¶ %H 0-23å°æ—¶ æ—¶ %I 0-12å°æ—¶ï¼Œä¸ %p æ†ç»‘ä½¿ç”¨ ä¸Šä¸‹åˆ %p AM/PM åˆ† %M åˆ†é’Ÿ ç§’ %S æ•´æ•°ç§’ ç§’ %OS çœŸæ­£æ„ä¹‰çš„ç§’ æ—¶åŒº %Z æ—¶åŒºï¼ˆåç§°ï¼‰ America/Chicago æ ‡å‡†æ—¶åŒº %z ä»¥ UTC æ ‡å‡†æ—¶åŒºåšåç§»é‡ +0800 éæ•°å­— %. è·³è¿‡ä¸€ä¸ªéæ•°å­—å­—ç¬¦ éæ•°å­— %* è·³è¿‡ä»»æ„æ•°é‡çš„éæ•°å­— ä¾‹å¦‚ï¼š parse_date(&quot;01/02/15&quot;, &quot;%m/%d/%y&quot;) #&gt; [1] &quot;2015-01-02&quot; parse_date(&quot;01/02/15&quot;, &quot;%d/%m/%y&quot;) #&gt; [1] &quot;2015-02-01&quot; parse_date(&quot;01/02/15&quot;, &quot;%y/%m/%d&quot;) #&gt; [1] &quot;2001-02-15&quot; å¦‚æœå°† %b æˆ– %B ä¸éè‹±è¯­çš„æœˆä»½åç§°ä¸€èµ·ä½¿ç”¨ï¼Œåˆ™éœ€è¦å°† lang å‚æ•°è®¾ç½®ä¸º locale()ã€‚ä½¿ç”¨å‡½æ•° date_names_langs() æŸ¥çœ‹å†…ç½®è¯­è¨€åˆ—è¡¨ï¼Œæˆ–è€…ä½¿ç”¨ date_names() è‡ªå®šä¹‰ã€‚ parse_date(&quot;1 janvier 2015&quot;, &quot;%d %B %Y&quot;, locale = locale(&quot;fr&quot;)) #&gt; [1] &quot;2015-01-01&quot; 12.7 è§£ææ–‡ä»¶ 12.7.1 è‡ªåŠ¨åŒ¹é… readr ä¸€èˆ¬è¯»å–å‰ 1000 è¡Œï¼Œå¹¶ä½¿ç”¨ä¸€äº› â€œå¯å‘å¼â€ çš„æ–¹æ³•ï¼ˆä¿æŒé€‚åº¦ä¿å®ˆï¼‰æ¥ç¡®å®šæ¯åˆ—çš„ç±»å‹ã€‚å…¶ä¸­ guess_parser() è¿”å›å­—ç¬¦å‘é‡çš„æœ€ä½³ç±»å‹çŒœæµ‹ï¼Œè€Œ parse_guess() è¿”å›ç”¨è¯¥ç±»å‹è§£æçš„å†…å®¹ï¼š guess_parser(&quot;2010-10-01&quot;) #&gt; [1] &quot;date&quot; guess_parser(&quot;15:01&quot;) #&gt; [1] &quot;time&quot; guess_parser(c(&quot;TRUE&quot;, &quot;FALSE&quot;)) #&gt; [1] &quot;logical&quot; guess_parser(c(&quot;1&quot;, &quot;5&quot;, &quot;9&quot;)) #&gt; [1] &quot;double&quot; guess_parser(c(&quot;12,352,561&quot;)) #&gt; [1] &quot;number&quot; str(parse_guess(&quot;2010-10-10&quot;)) #&gt; Date[1:1], format: &quot;2010-10-10&quot; è¿™ç§ â€œå¯å‘å¼â€ å°è¯•ä»¥ä¸‹æ¯ç§ç±»å‹ï¼Œå¹¶åœ¨æ‰¾åˆ°æ»¡è¶³åŒ¹é…é¡¹æ—¶åœæ­¢ï¼š - é€»è¾‘å€¼ï¼šä»…åŒ…å« â€œFâ€ã€â€œTâ€ã€â€œFALSEâ€ æˆ– â€œTRUEâ€ã€‚ - æ•´æ•°ï¼šä»…åŒ…å«æ•°å­—å­—ç¬¦ï¼ˆå¯èƒ½è¿˜æœ‰ â€œ-â€ï¼‰ã€‚ - å°æ•°ï¼šä»…åŒ…å«æœ‰æ•ˆçš„å°æ•°ï¼ˆå¯èƒ½è¿˜æœ‰ 4.5e-5 ç­‰æ•°å­—ï¼‰ã€‚ - æ•°å­—ï¼šåŒ…å«æœ‰æ•ˆçš„å°æ•°ç±»å‹ï¼ˆå¯èƒ½è¿˜æœ‰åˆ†ç»„æ ‡è®°ï¼‰ã€‚ - æ—¶é—´ï¼šä¸é»˜è®¤çš„ time_format åŒ¹é…ã€‚ - æ—¥æœŸï¼šä¸é»˜è®¤çš„ date_format åŒ¹é…ã€‚ - æ—¥æœŸæ—¶é—´ï¼šä»»ä½•æ»¡è¶³ ISO8601 æ ¼å¼çš„æ—¥æœŸæ—¶é—´ã€‚å¦‚æœè¿™äº›è§„åˆ™éƒ½ä¸é€‚ç”¨ï¼Œé‚£ä¹ˆè¯¥åˆ—å°†ä¿æŒå­—ç¬¦ä¸²å‘é‡ã€‚ 12.7.2 è‡ªåŠ¨åŒ¹é…é‡åˆ°çš„é—®é¢˜ åœ¨å­¦ä¹ è¿™é‡Œçš„æ—¶å€™å‘ç°é—®é¢˜å·²ç»æ— æ³•å¤ç°ã€‚æ­¤å¤„å·²ç»ä¸å†æŠ¥é”™ challenge &lt;- read_csv(readr_example(&quot;challenge.csv&quot;)) #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; cols( #&gt; x = col_double(), #&gt; y = col_logical() #&gt; ) #&gt; Warning: 1000 parsing failures. #&gt; row col expected actual file #&gt; 1001 y 1/0/T/F/TRUE/FALSE 2015-01-16 &#39;/Users/runner/work/_temp/â€¦ #&gt; 1002 y 1/0/T/F/TRUE/FALSE 2018-05-18 &#39;/Users/runner/work/_temp/â€¦ #&gt; 1003 y 1/0/T/F/TRUE/FALSE 2015-09-05 &#39;/Users/runner/work/_temp/â€¦ #&gt; 1004 y 1/0/T/F/TRUE/FALSE 2012-11-28 &#39;/Users/runner/work/_temp/â€¦ #&gt; 1005 y 1/0/T/F/TRUE/FALSE 2020-01-13 &#39;/Users/runner/work/_temp/â€¦ #&gt; .... ... .................. .......... .........................â€¦ #&gt; See problems(...) for more details. æˆ‘ä»¬å†³å®šå¯¹é”™è¯¯è¿›è¡Œå®šä½ï¼š problems(challenge) #&gt; # A tibble: 1,000 x 5 #&gt; row col expected actual file #&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1001 y 1/0/T/F/TRUE/Fâ€¦ 2015-01â€¦ &#39;/Users/runner/work/_temp/â€¦ #&gt; 2 1002 y 1/0/T/F/TRUE/Fâ€¦ 2018-05â€¦ &#39;/Users/runner/work/_temp/â€¦ #&gt; 3 1003 y 1/0/T/F/TRUE/Fâ€¦ 2015-09â€¦ &#39;/Users/runner/work/_temp/â€¦ #&gt; 4 1004 y 1/0/T/F/TRUE/Fâ€¦ 2012-11â€¦ &#39;/Users/runner/work/_temp/â€¦ #&gt; 5 1005 y 1/0/T/F/TRUE/Fâ€¦ 2020-01â€¦ &#39;/Users/runner/work/_temp/â€¦ #&gt; 6 1006 y 1/0/T/F/TRUE/Fâ€¦ 2016-04â€¦ &#39;/Users/runner/work/_temp/â€¦ #&gt; # â€¦ with 994 more rows å—¯â€¦æ€ä¹ˆçœ‹äº†è·Ÿæ²¡çœ‹ä¼¼çš„ã€‚tail() å‡½æ•°ç”¨æ¥æŸ¥çœ‹è¡¨å¤´æˆ–è¡¨å°¾ï¼š tail(challenge) #&gt; # A tibble: 6 x 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;lgl&gt; #&gt; 1 0.805 NA #&gt; 2 0.164 NA #&gt; 3 0.472 NA #&gt; 4 0.718 NA #&gt; 5 0.270 NA #&gt; 6 0.608 NA è¿™è¡¨æ˜æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å¯¹æ•°æ®è¿›è¡Œè§£æï¼š challenge &lt;- read_csv( readr_example(&quot;challenge.csv&quot;), col_types = cols( # å¯¹åˆ—ç±»å‹è¿›è¡Œæ‰‹åŠ¨å£°æ˜ x = col_double(), # ç¬¬ä¸€åˆ—ä¸º xï¼Œå°æ•°ç±»å‹ y = col_logical() # ç¬¬äºŒåˆ—ä¸º yï¼Œé€»è¾‘å€¼ç±»å‹ ) ) #&gt; Warning: One or more parsing issues, call `problems()` on your data frame for details, #&gt; e.g.: #&gt; dat &lt;- vroom(...) #&gt; problems(dat) challenge &lt;- read_csv( readr_example(&quot;challenge.csv&quot;), col_types = cols( x = col_double(), y = col_date() ) ) tail(challenge) #&gt; # A tibble: 6 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;date&gt; #&gt; 1 0.805 2019-11-21 #&gt; 2 0.164 2018-03-29 #&gt; 3 0.472 2014-08-04 #&gt; 4 0.718 2015-08-16 #&gt; 5 0.270 2020-02-04 #&gt; 6 0.608 2019-01-06 col_types æ˜¯æœ‰å¿…è¦çš„ï¼Œè¿™è‡³å°‘èƒ½ç¡®ä¿å®ƒç”Ÿæˆçš„æ•°æ®æ›´ä¸ºå¯é ä¸€äº›ã€‚ 12.7.3 å…¶ä»–çš„åŒ¹é…è§£å†³ç­–ç•¥ ä¸Šé¢æåˆ°çš„è‡ªåŠ¨è§£æå‡ºé”™åªæ˜¯å› ä¸ºé»˜è®¤çš„ 1000 è¡Œä¸å¤Ÿç”¨è€Œå·²ã€‚å“ªæ€•åªæ˜¯å¤šè§£æä¸€è¡Œï¼š challenge2 &lt;- read_csv(readr_example(&quot;challenge.csv&quot;), guess_max = 1001) #&gt; Rows: 2000 Columns: 2 #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; Delimiter: &quot;,&quot; #&gt; dbl (1): x #&gt; date (1): y #&gt; #&gt; â„¹ Use `spec()` to retrieve the full column specification for this data. #&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message. challenge2 #&gt; # A tibble: 2,000 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;date&gt; #&gt; 1 404 NA #&gt; 2 4172 NA #&gt; 3 3004 NA #&gt; 4 787 NA #&gt; 5 37 NA #&gt; 6 2332 NA #&gt; 7 2489 NA #&gt; 8 1449 NA #&gt; 9 3665 NA #&gt; 10 3863 NA #&gt; # â€¦ with 1,990 more rows ä½ çœ‹ã€‚é—®é¢˜è§£å†³äº†å‘¢ã€‚ å¦å¤–ä¸€ç§æ€è·¯æ˜¯å°†å‘é‡å£°æ˜ä¸ºé»˜è®¤å­—ç¬¦ç±»å‹å‘é‡ï¼Œè¿™å¯èƒ½ä½¿ä½ çš„å®šä½æ›´å®¹æ˜“ä¸€äº›ï¼š challenge2 &lt;- read_csv(readr_example(&quot;challenge.csv&quot;), col_types = cols(.default = col_character()) ) è¿™é‡Œç”¨ç®€å•çš„æ•°æ®é›†æ¼”ç¤º type_convert() çš„æ•ˆæœï¼š df &lt;- tribble( ~x, ~y, &quot;1&quot;, &quot;1.21&quot;, &quot;2&quot;, &quot;2.32&quot;, &quot;3&quot;, &quot;4.56&quot; ) df #&gt; # A tibble: 3 Ã— 2 #&gt; x y #&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1 1.21 #&gt; 2 2 2.32 #&gt; 3 3 4.56 type_convert(df) #&gt; #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; cols( #&gt; x = col_double(), #&gt; y = col_double() #&gt; ) #&gt; # A tibble: 3 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 1.21 #&gt; 2 2 2.32 #&gt; 3 3 4.56 å¯ä»¥çœ‹åˆ° â€œå¯å‘æ€§â€ è½¬æ¢åˆ°åº•è½¬æ¢æˆäº†ä»€ä¹ˆç±»å‹ã€‚ 12.8 å†™å…¥æ•°æ® 12.8.1 csv æ ¼å¼ write_csv(challenge, &quot;./data/challenge.csv&quot;) å¾ˆç®€å•ï¼Œä¸æ˜¯å—ï¼Ÿå°å¿ƒäº‹æƒ…è¿˜æ²¡ç»“æŸã€‚ä½ çœ‹ï¼Œæ•°æ®ç±»å‹å°±è¿™ä¹ˆä¸¢äº†ï¼š challenge #&gt; # A tibble: 2,000 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;date&gt; #&gt; 1 404 NA #&gt; 2 4172 NA #&gt; 3 3004 NA #&gt; 4 787 NA #&gt; 5 37 NA #&gt; 6 2332 NA #&gt; 7 2489 NA #&gt; 8 1449 NA #&gt; 9 3665 NA #&gt; 10 3863 NA #&gt; # â€¦ with 1,990 more rows write_csv(challenge, &quot;./data/challenge-2.csv&quot;) read_csv(&quot;./data/challenge-2.csv&quot;) #&gt; Rows: 2000 Columns: 2 #&gt; â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #&gt; Delimiter: &quot;,&quot; #&gt; dbl (1): x #&gt; date (1): y #&gt; #&gt; â„¹ Use `spec()` to retrieve the full column specification for this data. #&gt; â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message. #&gt; # A tibble: 2,000 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;date&gt; #&gt; 1 404 NA #&gt; 2 4172 NA #&gt; 3 3004 NA #&gt; 4 787 NA #&gt; 5 37 NA #&gt; 6 2332 NA #&gt; 7 2489 NA #&gt; 8 1449 NA #&gt; 9 3665 NA #&gt; 10 3863 NA #&gt; # â€¦ with 1,990 more rows 12.8.2 rds æ ¼å¼ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†æ–°çš„å‡½æ•°ï¼šwrite_rds() å’Œ read_rds() åŸºäº R çš„åŸºæœ¬å‡½æ•° readRDS() å’Œ saveRDS()ã€‚æ³¨æ„è¿™äº›æ•°æ®ä¼šä»¥è¢« R ç§°ä¸º RDS æ ¼å¼çš„è‡ªå®šä¹‰äºŒè¿›åˆ¶æ ¼å¼å­˜å‚¨æ•°æ®ï¼š write_rds(challenge, &quot;./data/challenge.rds&quot;) read_rds(&quot;./data/challenge.rds&quot;) #&gt; # A tibble: 2,000 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;date&gt; #&gt; 1 404 NA #&gt; 2 4172 NA #&gt; 3 3004 NA #&gt; 4 787 NA #&gt; 5 37 NA #&gt; 6 2332 NA #&gt; 7 2489 NA #&gt; 8 1449 NA #&gt; 9 3665 NA #&gt; 10 3863 NA #&gt; # â€¦ with 1,990 more rows è¡¨ç°éå¸¸å¥½ï¼Œä½† rds æ ¼å¼ä¸æµè¡Œä¹Ÿä¸é€šç”¨ã€‚ 12.8.3 feather æ ¼å¼ feather åŒ…ä¹Ÿå®ç°äº†ä¸€ç§å¿«é€Ÿçš„äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼ï¼Œå¯ä»¥è·¨ç¼–ç¨‹è¯­è¨€å…±äº«ï¼š library(feather) write_feather(challenge, &quot;./data/challenge.feather&quot;) read_feather(&quot;./data/challenge.feather&quot;) #&gt; # A tibble: 2,000 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;date&gt; #&gt; 1 404 NA #&gt; 2 4172 NA #&gt; 3 3004 NA #&gt; 4 787 NA #&gt; 5 37 NA #&gt; 6 2332 NA #&gt; 7 2489 NA #&gt; 8 1449 NA #&gt; 9 3665 NA #&gt; 10 3863 NA #&gt; # â€¦ with 1,990 more rows 12.8.4 å…¶ä»–æ ¼å¼ å…¶ä»–çš„ä¸€äº›å¸¸è§æ ¼å¼ä¹Ÿæ”¯æŒã€‚äº‹å®ä¸Šæ‰€æœ‰å·²çŸ¥æ ¼å¼ï¼Œåœ¨ç¤¾åŒºåŒ…çš„å¸®åŠ©ä¸‹ï¼Œé€šå¸¸éƒ½èƒ½è§£å†³ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§æ ¼å¼ï¼š havenï¼šè¯»å– SPSSã€Stata å’Œ SAS æ–‡ä»¶ã€‚ readxlï¼šè¯»å– excel æ–‡ä»¶ï¼ˆåŒ…æ‹¬.xlså’Œ.xlsxï¼‰ã€‚ DBIï¼šDBI å’Œä¸€äº›ç‰¹å®šæ•°æ®åº“çš„åç«¯ï¼ˆå¦‚ RMySQLã€RSQLiteã€RPostgreSQL ç­‰ï¼‰ã€‚ "],["tidy-data.html", "Chapter 13 Tidy data 13.1 å¯¹ table1 æ•°æ®åˆ†æ 13.2 å¯¹ table2 æ•°æ®æ•´ç† 13.3 å¯¹ table3 æ•°æ®æ•´ç† 13.4 å¯¹ table4a &amp; table4b æ•°æ®æ•´ç† 13.5 å¯¹ table5 æ•°æ®æ•´ç† 13.6 å¯¹ stocks å’Œ treatment çš„ç¼ºå¤±æ•°æ®å¤„ç† 13.7 å¯¹ who æ•°æ®æ•´ç†", " Chapter 13 Tidy data æœ‰è¿™ä¹ˆä¸€å¥ä¿—è¯è¯´åˆ°ï¼š å¹¸ç¦çš„å®¶åº­éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œä¸å¹¸çš„å®¶åº­å„æœ‰å„çš„ä¸å¹¸ã€‚ï¼ˆåˆ—å¤«Â·æ‰˜å°”æ–¯æ³°ï¼‰ æ”¾åˆ°æˆ‘ä»¬çš„æ•°æ®é‡Œä¹Ÿæ˜¯è¿™æ ·çš„ï¼š æ•´æ´çš„æ•°æ®é›†éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œä½†æ¯ä¸ªå‡Œä¹±çš„æ•°æ®é›†éƒ½ä»¥è‡ªå·±çš„æ–¹å¼å‡Œä¹±ã€‚ï¼ˆå“ˆå¾·åˆ©Â·å¨å…‹å§†ï¼‰ ä¸€ä¸ªå¥½çš„æ•°æ®é›†åº”è¯¥ï¼šå˜é‡åœ¨åˆ—ä¸­ï¼Œè§‚å¯Ÿç»“æœåœ¨è¡Œä¸­ï¼Œå€¼å‚¨å­˜åœ¨å•å…ƒæ ¼ä¸­ï¼›ä¸æ•´æ´çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ tidyr åŒ…ä¸­çš„ pivot_longer() å’Œ pivot_wider() è¾…åŠ©ä¿®æ­£ library(tidyverse) 13.1 å¯¹ table1 æ•°æ®åˆ†æ table1 æ•°æ®é›†ä¸­ cases ä¸ºå¢é•¿äººæ•°ï¼ˆå•ä½ï¼šä¸‡ï¼‰ã€‚è¿™ä»½æ•°æ®å±•ç°å¾—å¾ˆä¸é”™ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾ç»˜åˆ¶æƒ³è¦çš„å›¾åƒã€‚ table1 #&gt; # A tibble: 6 Ã— 4 #&gt; country year cases population #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 Afghanistan 1999 745 19987071 #&gt; 2 Afghanistan 2000 2666 20595360 #&gt; 3 Brazil 1999 37737 172006362 #&gt; 4 Brazil 2000 80488 174504898 #&gt; 5 China 1999 212258 1272915272 #&gt; 6 China 2000 213766 1280428583 ggplot(table1, aes(year, cases)) + geom_line(aes(group = country, colour = country)) + geom_point(aes(colour = country)) 13.2 å¯¹ table2 æ•°æ®æ•´ç† è¡Œä¸­ä¸åº”è¯¥å‡ºç°å°† cases å’Œ population æ”¾åœ¨ä¸€èµ·çš„ç°è±¡ã€‚å®ƒä»¬åº”è¯¥ä½œä¸ºç­›é€‰å˜é‡ï¼Œæ–¹ä¾¿åç»­å¯¹ â€œæ–°å¢â€ â€œç›®å‰æ€»äººæ•°â€ è¿™ä¸ªä¸¤ä¸ªå˜é‡è¿›è¡Œåˆ†æï¼Œå³ type æ‹†åˆ†ä¸ºåˆ—ï¼Œcount è·Ÿéšåˆ°æ–°åˆ—ï¼š table2 #&gt; # A tibble: 12 Ã— 4 #&gt; country year type count #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 Afghanistan 1999 cases 745 #&gt; 2 Afghanistan 1999 population 19987071 #&gt; 3 Afghanistan 2000 cases 2666 #&gt; 4 Afghanistan 2000 population 20595360 #&gt; 5 Brazil 1999 cases 37737 #&gt; 6 Brazil 1999 population 172006362 #&gt; 7 Brazil 2000 cases 80488 #&gt; 8 Brazil 2000 population 174504898 #&gt; 9 China 1999 cases 212258 #&gt; 10 China 1999 population 1272915272 #&gt; 11 China 2000 cases 213766 #&gt; 12 China 2000 population 1280428583 table2 %&gt;% pivot_wider(names_from = type, values_from = count) #&gt; # A tibble: 6 Ã— 4 #&gt; country year cases population #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 Afghanistan 1999 745 19987071 #&gt; 2 Afghanistan 2000 2666 20595360 #&gt; 3 Brazil 1999 37737 172006362 #&gt; 4 Brazil 2000 80488 174504898 #&gt; 5 China 1999 212258 1272915272 #&gt; 6 China 2000 213766 1280428583 13.3 å¯¹ table3 æ•°æ®æ•´ç† è¡Œä¸­ä¸åº”è¯¥å‡ºç°å°† cases å’Œ population æ”¾åœ¨ä¸€èµ·çš„ç°è±¡ï¼Œéœ€è¦æ‰‹åŠ¨æ‹†åˆ†ï¼š table3 #&gt; # A tibble: 6 Ã— 3 #&gt; country year rate #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 Afghanistan 1999 745/19987071 #&gt; 2 Afghanistan 2000 2666/20595360 #&gt; 3 Brazil 1999 37737/172006362 #&gt; 4 Brazil 2000 80488/174504898 #&gt; 5 China 1999 212258/1272915272 #&gt; 6 China 2000 213766/1280428583 # é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†åœ¨çœ‹åˆ°éå­—æ¯æ•°å­—å­—ç¬¦ï¼ˆå³ä¸æ˜¯æ•°å­—æˆ–å­—æ¯çš„å­—ç¬¦ï¼‰çš„ä½ç½®æ‹†åˆ†å€¼ table3 %&gt;% separate(rate, into = c(&quot;cases&quot;, &quot;population&quot;)) #&gt; # A tibble: 6 Ã— 4 #&gt; country year cases population #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 Afghanistan 1999 745 19987071 #&gt; 2 Afghanistan 2000 2666 20595360 #&gt; 3 Brazil 1999 37737 172006362 #&gt; 4 Brazil 2000 80488 174504898 #&gt; 5 China 1999 212258 1272915272 #&gt; 6 China 2000 213766 1280428583 # convert å¯ä»¥è‡ªåŠ¨å°†æ•°æ®çš„æ ¼å¼è¿›è¡Œè½¬åŒ–ã€‚å¦‚è¿™é‡Œçš„ cases å’Œ population éƒ½åº”è¯¥æ˜¯ int ç±»å‹æ•°æ® table3 %&gt;% separate(rate, into = c(&quot;cases&quot;, &quot;population&quot;), convert = TRUE) #&gt; # A tibble: 6 Ã— 4 #&gt; country year cases population #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 Afghanistan 1999 745 19987071 #&gt; 2 Afghanistan 2000 2666 20595360 #&gt; 3 Brazil 1999 37737 172006362 #&gt; 4 Brazil 2000 80488 174504898 #&gt; 5 China 1999 212258 1272915272 #&gt; 6 China 2000 213766 1280428583 # åˆ†éš”ç¬¦ä¹Ÿå¯ä»¥æ‰‹åŠ¨è®¾ç½® table3 %&gt;% separate(rate, into = c(&quot;cases&quot;, &quot;population&quot;), sep = &quot;/&quot;) #&gt; # A tibble: 6 Ã— 4 #&gt; country year cases population #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 Afghanistan 1999 745 19987071 #&gt; 2 Afghanistan 2000 2666 20595360 #&gt; 3 Brazil 1999 37737 172006362 #&gt; 4 Brazil 2000 80488 174504898 #&gt; 5 China 1999 212258 1272915272 #&gt; 6 China 2000 213766 1280428583 # è®¾ç½®ä¸ºæ•°å­—è¡¨ç¤ºåˆ†å‰²ä½ç½®ï¼Œå¦‚è¿™é‡Œåˆ†å‰²ä¸ºä¸–çºª + ä¸¤ä½æ•°å¹´ table3 %&gt;% separate(year, into = c(&quot;century&quot;, &quot;year&quot;), sep = 2) #&gt; # A tibble: 6 Ã— 4 #&gt; country century year rate #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 Afghanistan 19 99 745/19987071 #&gt; 2 Afghanistan 20 00 2666/20595360 #&gt; 3 Brazil 19 99 37737/172006362 #&gt; 4 Brazil 20 00 80488/174504898 #&gt; 5 China 19 99 212258/1272915272 #&gt; 6 China 20 00 213766/1280428583 13.4 å¯¹ table4a &amp; table4b æ•°æ®æ•´ç† åˆ—ä¸­ä¸åº”è¯¥å‡ºç°å°† 1999 å’Œ 2000 åˆ†å¼€çš„ç°è±¡ã€‚å®ƒä»¬åº”è¯¥ä½œä¸ºç­›é€‰å˜é‡ï¼Œæ–¹ä¾¿åç»­å¯¹ â€œå¹´ä»½â€ è¿™ä¸ªæ€»å˜é‡è¿›è¡Œåˆ†æï¼Œå³æ—§å˜é‡åˆå¹¶ä¸º yearï¼Œå€¼åˆå¹¶ä¸º casesï¼š table4a_new &lt;- table4a %&gt;% pivot_longer( c(`1999`, `2000`), # æŒ‡å®šä¿®æ”¹åˆ—ã€‚æ³¨æ„è¿™é‡Œå˜é‡æ˜¯ä»¥æ•°å­—å¼€å¤´ï¼Œæ‰€ä»¥æœ‰å¿…è¦ç”¨ `` å¼•ç”¨ï¼ˆå½“ç„¶æ•°å­—å¼€å¤´æ˜¯ä¸è§„èŒƒçš„ï¼‰ names_to = &quot;year&quot;, # ä¸Šè¿°å˜é‡åæ±‡æ€»åˆ° year ä¸Š values_to = &quot;cases&quot; # ä¸Šè¿°å¯¹åº”æ•°å€¼æ±‡æ€»åˆ° cases ä¸Š ) table4b_new &lt;- table4b %&gt;% pivot_longer( c(`1999`, `2000`), names_to = &quot;year&quot;, values_to = &quot;population&quot; ) # æœ€ååˆå¹¶ä¸¤ä¸ªè¡¨çš„æ•°æ®å†…å®¹ #* dplyr::left_join() left_join(table4a_new, table4b_new) #&gt; Joining with `by = join_by(country, year)` #&gt; # A tibble: 6 Ã— 4 #&gt; country year cases population #&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 Afghanistan 1999 745 19987071 #&gt; 2 Afghanistan 2000 2666 20595360 #&gt; 3 Brazil 1999 37737 172006362 #&gt; 4 Brazil 2000 80488 174504898 #&gt; 5 China 1999 212258 1272915272 #&gt; 6 China 2000 213766 1280428583 13.5 å¯¹ table5 æ•°æ®æ•´ç† æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ‹†åˆ† cases å’Œ population åŒæ—¶è¦å°†å¹´ä»½æ•°æ®è¿›è¡Œåˆå¹¶ï¼š table5 %&gt;% # æ³¨æ„å¦‚æœä¸å£°æ˜ sepï¼Œé»˜è®¤åŠ é—´éš”ç¬¦å· â€œ_â€ï¼ unite(year_4cs, century, year, sep = &quot;&quot;, na.rm = TRUE) %&gt;% separate(rate, into = c(&quot;cases&quot;, &quot;population&quot;), sep = &quot;/&quot;) #&gt; # A tibble: 6 Ã— 4 #&gt; country year_4cs cases population #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 Afghanistan 1999 745 19987071 #&gt; 2 Afghanistan 2000 2666 20595360 #&gt; 3 Brazil 1999 37737 172006362 #&gt; 4 Brazil 2000 80488 174504898 #&gt; 5 China 1999 212258 1272915272 #&gt; 6 China 2000 213766 1280428583 13.6 å¯¹ stocks å’Œ treatment çš„ç¼ºå¤±æ•°æ®å¤„ç† stocks &lt;- tibble( year = c(2015, 2015, 2015, 2015, 2016, 2016, 2016), qtr = c(1, 2, 3, 4, 2, 3, 4), return = c(1.88, 0.59, 0.35, NA, 0.92, 0.17, 2.66) ) new_stocks &lt;- stocks %&gt;% # æ‹†åˆ†æˆæŒ‰å¹´ä½œåˆ— pivot_wider(names_from = year, values_from = return) %&gt;% # é‡æ–°æ•´ç†å›å»ã€‚æ³¨æ„è¡¨æ ¼æ˜¯æ€ä¹ˆæ•´ç†çš„ pivot_longer( cols = c(`2015`, `2016`), names_to = &quot;year&quot;, values_to = &quot;return&quot;, values_drop_na = TRUE # è¿™ä¼šå¯¹å« NA çš„æ•°æ®è¡Œå‰”é™¤éšè— ) %&gt;% print() #&gt; # A tibble: 6 Ã— 3 #&gt; qtr year return #&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 1 2015 1.88 #&gt; 2 2 2015 0.59 #&gt; 3 2 2016 0.92 #&gt; 4 3 2015 0.35 #&gt; 5 3 2016 0.17 #&gt; 6 4 2016 2.66 new_stocks %&gt;% complete(year, qtr) # è¿™ä¼šæŠŠæ‰€æœ‰éšè—çš„ NA æ•°æ®é‡æ–°æ‰¾å› #&gt; # A tibble: 8 Ã— 3 #&gt; year qtr return #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2015 1 1.88 #&gt; 2 2015 2 0.59 #&gt; 3 2015 3 0.35 #&gt; 4 2015 4 NA #&gt; 5 2016 1 NA #&gt; 6 2016 2 0.92 #&gt; 7 2016 3 0.17 #&gt; 8 2016 4 2.66 treatment &lt;- tribble( ~person, ~treatment, ~response, &quot;Derrick Whitmore&quot;, 1, 7, NA, 2, 10, NA, 3, 9, &quot;Katherine Burke&quot;, 1, 4 ) treatment %&gt;% fill(person) # å¯¹ treatment çš„ person åˆ—è¿›è¡Œè¡¥å…¨å¤„ç†ï¼Œç¢°åˆ° NA æ—¶ä¼šå°† NA æ”¹ä¸ºä¸Šä¸€ä¸ªä¸æ˜¯ NA çš„æ•°æ® #&gt; # A tibble: 4 Ã— 3 #&gt; person treatment response #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 Derrick Whitmore 1 7 #&gt; 2 Derrick Whitmore 2 10 #&gt; 3 Derrick Whitmore 3 9 #&gt; 4 Katherine Burke 1 4 13.7 å¯¹ who æ•°æ®æ•´ç† who æ˜¯ä¸€ä¸ªæµè¡Œç—…ç»Ÿè®¡æ•°æ®é›†ã€‚ who #&gt; # A tibble: 7,240 Ã— 60 #&gt; country iso2 iso3 year new_sâ€¦Â¹ new_sâ€¦Â² new_sâ€¦Â³ new_sâ€¦â´ new_sâ€¦âµ new_sâ€¦â¶ #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 Afghanistan AF AFG 1980 NA NA NA NA NA NA #&gt; 2 Afghanistan AF AFG 1981 NA NA NA NA NA NA #&gt; 3 Afghanistan AF AFG 1982 NA NA NA NA NA NA #&gt; 4 Afghanistan AF AFG 1983 NA NA NA NA NA NA #&gt; 5 Afghanistan AF AFG 1984 NA NA NA NA NA NA #&gt; 6 Afghanistan AF AFG 1985 NA NA NA NA NA NA #&gt; 7 Afghanistan AF AFG 1986 NA NA NA NA NA NA #&gt; 8 Afghanistan AF AFG 1987 NA NA NA NA NA NA #&gt; 9 Afghanistan AF AFG 1988 NA NA NA NA NA NA #&gt; 10 Afghanistan AF AFG 1989 NA NA NA NA NA NA #&gt; # â€¦ with 7,230 more rows, 50 more variables: new_sp_m65 &lt;dbl&gt;, #&gt; # new_sp_f014 &lt;dbl&gt;, new_sp_f1524 &lt;dbl&gt;, new_sp_f2534 &lt;dbl&gt;, #&gt; # new_sp_f3544 &lt;dbl&gt;, new_sp_f4554 &lt;dbl&gt;, new_sp_f5564 &lt;dbl&gt;, #&gt; # new_sp_f65 &lt;dbl&gt;, new_sn_m014 &lt;dbl&gt;, new_sn_m1524 &lt;dbl&gt;, #&gt; # new_sn_m2534 &lt;dbl&gt;, new_sn_m3544 &lt;dbl&gt;, new_sn_m4554 &lt;dbl&gt;, #&gt; # new_sn_m5564 &lt;dbl&gt;, new_sn_m65 &lt;dbl&gt;, new_sn_f014 &lt;dbl&gt;, #&gt; # new_sn_f1524 &lt;dbl&gt;, new_sn_f2534 &lt;dbl&gt;, new_sn_f3544 &lt;dbl&gt;, â€¦ who1 &lt;- who %&gt;% pivot_longer( cols = new_sp_m014:newrel_f65, # å°†ç—…ç—‡çš„ç§ç±»è½¬æ¢æˆå˜é‡ï¼ˆkeyï¼‰ names_to = &quot;key&quot;, values_to = &quot;cases&quot;, # å°†æ•°æ®è½¬æ¢æˆ cases åˆ— values_drop_na = TRUE # åˆ é™¤ NA æ•°æ® ) who1 #&gt; # A tibble: 76,046 Ã— 6 #&gt; country iso2 iso3 year key cases #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 Afghanistan AF AFG 1997 new_sp_m014 0 #&gt; 2 Afghanistan AF AFG 1997 new_sp_m1524 10 #&gt; 3 Afghanistan AF AFG 1997 new_sp_m2534 6 #&gt; 4 Afghanistan AF AFG 1997 new_sp_m3544 3 #&gt; 5 Afghanistan AF AFG 1997 new_sp_m4554 5 #&gt; 6 Afghanistan AF AFG 1997 new_sp_m5564 2 #&gt; 7 Afghanistan AF AFG 1997 new_sp_m65 0 #&gt; 8 Afghanistan AF AFG 1997 new_sp_f014 5 #&gt; 9 Afghanistan AF AFG 1997 new_sp_f1524 38 #&gt; 10 Afghanistan AF AFG 1997 new_sp_f2534 36 #&gt; # â€¦ with 76,036 more rows count(who1, key, sort = TRUE) # å¯¹ä¸åŒç—…ç—‡äººæ•°ç»Ÿè®¡ #&gt; # A tibble: 56 Ã— 2 #&gt; key n #&gt; &lt;chr&gt; &lt;int&gt; #&gt; 1 new_sp_m4554 3223 #&gt; 2 new_sp_m3544 3219 #&gt; 3 new_sp_m5564 3218 #&gt; 4 new_sp_m1524 3209 #&gt; 5 new_sp_m65 3209 #&gt; 6 new_sp_m2534 3206 #&gt; 7 new_sp_f4554 3204 #&gt; 8 new_sp_f2534 3200 #&gt; 9 new_sp_f3544 3199 #&gt; 10 new_sp_f65 3197 #&gt; # â€¦ with 46 more rows å¯¹ç—…ç—‡åç§°è¿›è¡Œåˆ†æå¾—çŸ¥ï¼š å‰ä¸‰ä¸ªå­—æ¯ï¼šæ˜¯å¦åŒ…å«æ–°çš„æˆ–æ—§çš„ç»“æ ¸ç—…ä¾‹ ä¸­é—´ä¸¤ä¸ªå­—æ¯ï¼šç»“æ ¸ç—…çš„ç±»å‹ relï¼šå¤å‘ç—…ä¾‹ epï¼šè‚ºå¤–ç»“æ ¸ç—…ä¾‹ snï¼šæ— æ³•é€šè¿‡è‚ºæ¶‚ç‰‡è¯Šæ–­çš„è‚ºç»“æ ¸ç—…ä¾‹ï¼ˆæ¶‚ç‰‡é˜´æ€§ï¼‰ spï¼šå¯é€šè¿‡è‚ºæ¶‚ç‰‡è¯Šæ–­çš„è‚ºç»“æ ¸ç—…ä¾‹ï¼ˆæ¶‚ç‰‡é˜³æ€§ï¼‰ ç¬¬å…­ä¸ªå­—æ¯ï¼šç»“æ ¸ç—…æ‚£è€…çš„æ€§åˆ«ã€‚å…¶ä¸­ m ä¸ºç”·æ€§ï¼Œf ä¸ºå¥³æ€§ æœ€åçš„æ•°å­—ï¼šå¹´é¾„ç»„ 014ï¼š0 ~ 14 å² 1524ï¼š15 ~ 24 å² 2534ï¼š25 ~ 34 å² 3544ï¼š35 ~ 44 å² 4554ï¼š45 ~ 54 å² 5564ï¼š55 ~ 64å² 65ï¼š65 å²æˆ–ä»¥ä¸Š who2 &lt;- who1 %&gt;% # ä½¿ç”¨ stringr çš„ str_replace å¯ä»¥è¿›è¡Œç®€å•çš„æ›¿æ¢ï¼ˆå½“ç„¶åˆ‡å‰²æ—¶ä½¿ç”¨ä½ç½®åˆ‡å‰²ä¹Ÿå¯ä»¥ï¼‰ mutate(key = stringr::str_replace(key, &quot;newrel&quot;, &quot;new_rel&quot;)) %&gt;% # é€šè¿‡å­—ç¬¦ä¸² â€œ_â€ åˆ†å‰²ä¸ºæ˜¯å¦åŒ…å«æ–°ç—…ä¾‹ã€ç»“æ ¸ç—…ç±»å‹å’Œæ€§åˆ«å¹´é¾„ separate(key, c(&quot;new&quot;, &quot;type&quot;, &quot;sexage&quot;), sep = &quot;_&quot;) %&gt;% # é€šè¿‡ä½ç½®ç»§ç»­åˆ†å‰²æ€§åˆ«å’Œå¹´é¾„ separate(sexage, c(&quot;sex&quot;, &quot;age&quot;), sep = 1) who2 #&gt; # A tibble: 76,046 Ã— 9 #&gt; country iso2 iso3 year new type sex age cases #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 Afghanistan AF AFG 1997 new sp m 014 0 #&gt; 2 Afghanistan AF AFG 1997 new sp m 1524 10 #&gt; 3 Afghanistan AF AFG 1997 new sp m 2534 6 #&gt; 4 Afghanistan AF AFG 1997 new sp m 3544 3 #&gt; 5 Afghanistan AF AFG 1997 new sp m 4554 5 #&gt; 6 Afghanistan AF AFG 1997 new sp m 5564 2 #&gt; 7 Afghanistan AF AFG 1997 new sp m 65 0 #&gt; 8 Afghanistan AF AFG 1997 new sp f 014 5 #&gt; 9 Afghanistan AF AFG 1997 new sp f 1524 38 #&gt; 10 Afghanistan AF AFG 1997 new sp f 2534 36 #&gt; # â€¦ with 76,036 more rows æ·±åº¦è§‚å¯Ÿï¼Œæˆ‘ä»¬ä¼šå‘ç°æ•°æ®è¿˜æœ‰è¿›ä¸€æ­¥çš„ä¼˜åŒ–ç©ºé—´ï¼š count(who2, new) # å¯ä»¥å‘ç°è¿™ä¸ªæ•°æ®é›†çš„ â€œæ˜¯å¦åŒ…å«æ–°ç—…ä¾‹â€ å€¼å…¶å®å…¨éƒ¨éƒ½æ˜¯ â€œnewâ€ï¼Œæ‰€ä»¥æ˜¯ä¸å¿…è¦çš„æ•°æ® #&gt; # A tibble: 1 Ã— 2 #&gt; new n #&gt; &lt;chr&gt; &lt;int&gt; #&gt; 1 new 76046 # åŒæ—¶ â€œiso2â€ å’Œ â€œiso3â€ æ˜¯å›½å®¶ç¼©å†™ï¼Œä¹Ÿæ˜¯ä¸éœ€è¦çš„æ•°æ® who3 &lt;- who2 %&gt;% select(-new, -iso2, -iso3) who3 #&gt; # A tibble: 76,046 Ã— 6 #&gt; country year type sex age cases #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 Afghanistan 1997 sp m 014 0 #&gt; 2 Afghanistan 1997 sp m 1524 10 #&gt; 3 Afghanistan 1997 sp m 2534 6 #&gt; 4 Afghanistan 1997 sp m 3544 3 #&gt; 5 Afghanistan 1997 sp m 4554 5 #&gt; 6 Afghanistan 1997 sp m 5564 2 #&gt; 7 Afghanistan 1997 sp m 65 0 #&gt; 8 Afghanistan 1997 sp f 014 5 #&gt; 9 Afghanistan 1997 sp f 1524 38 #&gt; 10 Afghanistan 1997 sp f 2534 36 #&gt; # â€¦ with 76,036 more rows "],["relational-data.html", "Chapter 14 Relational data 14.1 ç†è§£åˆå¹¶æ•°æ®æ¦‚å¿µ 14.2 ç†è§£å¤šç§æ•°æ®åˆå¹¶æ–¹å¼ 14.3 è®¾ç½®æ“ä½œ 14.4 åˆå¹¶ nycflights æ•°æ®å¹¶åˆ†æ", " Chapter 14 Relational data ä¸€å¯¹è¡¨æ ¼ä¹‹é—´æ€»æ˜¯å­˜åœ¨å®šä¹‰å…³ç³»ã€‚è¦å¤„ç†å…³ç³»æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦ä¸ä¸€å¯¹è¡¨ä¸€èµ·å·¥ä½œçš„åŠ¨è¯ã€‚æœ‰ä¸‰å®¶æ—åŠ¨è¯è®¾è®¡ç”¨äºå¤„ç†å…³ç³»æ•°æ®ï¼š çªå˜è¿æ¥ï¼Œå®ƒä»å¦ä¸€ä¸ªæ•°æ®å¸§çš„åŒ¹é…è§‚æµ‹ä¸­å‘ä¸€ä¸ªæ•°æ®å¸§æ·»åŠ æ–°å˜é‡ã€‚ è¿‡æ»¤è¿æ¥ï¼Œæ ¹æ®å®ƒä»¬æ˜¯å¦ä¸å¦ä¸€ä¸ªè¡¨ä¸­çš„è§‚å¯Ÿç»“æœåŒ¹é…ï¼Œä»ä¸€ä¸ªæ•°æ®å¸§è¿‡æ»¤è§‚æµ‹ç»“æœã€‚ é›†åˆæ“ä½œï¼Œå°†è§‚å¯Ÿè§†ä¸ºé›†åˆå…ƒç´ ã€‚ library(tidyverse) library(nycflights13) 14.1 ç†è§£åˆå¹¶æ•°æ®æ¦‚å¿µ 14.1.1 ç±»å‹1ï¼šæ²¡æœ‰é‡å¤é—®é¢˜ x &lt;- tribble( ~key, ~val_x, 1, &quot;x1&quot;, 2, &quot;x2&quot;, 3, &quot;x3&quot; ) y &lt;- tribble( ~key, ~val_y, 1, &quot;y1&quot;, 2, &quot;y2&quot;, 4, &quot;y3&quot; ) å†…è”ï¼ˆinner-joinï¼‰ï¼šåªè§‚å¯Ÿå…±åŒåŒ…å«çš„æ•°æ®ï¼ˆäº¤é›†ï¼‰ã€‚äº‹å®ä¸Šå› ä¸ºä¼šä¸¢æ‰ä¸åŒ¹é…çš„æ•°æ®ï¼Œæ‰€ä»¥ä¸ä¾¿äºåˆ†æã€‚ inner_join(x, y, by = &quot;key&quot;) #&gt; # A tibble: 2 Ã— 3 #&gt; key val_x val_y #&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1 x1 y1 #&gt; 2 2 x2 y2 å¤–è”ï¼ˆleft-joinã€right-joinã€full-joinï¼‰ï¼šå…±ä¸‰ç§è¿æ¥æ–¹å¼è¯­å¥ã€‚ left_join(x, y, by = &quot;key&quot;) # å·¦è¿æ¥ï¼Œä¿ç•™å·¦ä¾§ä¸¢æ‰å³ä¾§ä¸åŒ¹é…çš„æ•°æ® #&gt; # A tibble: 3 Ã— 3 #&gt; key val_x val_y #&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1 x1 y1 #&gt; 2 2 x2 y2 #&gt; 3 3 x3 &lt;NA&gt; right_join(x, y, by = &quot;key&quot;) # å³è¿æ¥ï¼Œä¿ç•™å³ä¾§ä¸¢æ‰å·¦ä¾§ä¸åŒ¹é…çš„æ•°æ® #&gt; # A tibble: 3 Ã— 3 #&gt; key val_x val_y #&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1 x1 y1 #&gt; 2 2 x2 y2 #&gt; 3 4 &lt;NA&gt; y3 full_join(x, y, by = &quot;key&quot;) # å…¨è¿æ¥ï¼Œä¿ç•™å…¨éƒ¨æ•°æ®ï¼Œå“ªæ€•ä¸äº’ç›¸åŒ¹é… #&gt; # A tibble: 4 Ã— 3 #&gt; key val_x val_y #&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1 x1 y1 #&gt; 2 2 x2 y2 #&gt; 3 3 x3 &lt;NA&gt; #&gt; 4 4 &lt;NA&gt; y3 åŒ¹é…æ¼”ç®—ï¼ˆsemi_joinã€anti_joinï¼‰ï¼šäº‹å®ä¸ŠåŒ¹é…å¹¶ä¸ä¼šåšæ•°æ®åˆå¹¶ï¼Œåªæ˜¯æŠŠå·¦ä¾§æ•°æ®åšç­›é€‰ã€‚ semi_join(x, y, by = &quot;key&quot;) # åŠè¿æ¥ï¼Œå¯¹å·¦ä¾§æ•°æ®ç­›é€‰å‡ºå³ä¾§æ•°æ®èƒ½åŒ¹é…çš„æ•°æ® #&gt; # A tibble: 2 Ã— 2 #&gt; key val_x #&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 1 x1 #&gt; 2 2 x2 anti_join(x, y, by = &quot;key&quot;) # åè¿æ¥ï¼Œå¯¹å·¦ä¾§æ•°æ®æ’é™¤æ‰å³ä¾§æ•°æ®èƒ½åŒ¹é…çš„æ•°æ® #&gt; # A tibble: 1 Ã— 2 #&gt; key val_x #&gt; &lt;dbl&gt; &lt;chr&gt; #&gt; 1 3 x3 14.1.2 ç±»å‹2ï¼šä¸€è¾¹æœ‰é‡å¤é—®é¢˜ x &lt;- tribble( ~key, ~val_x, 1, &quot;x1&quot;, 2, &quot;x2&quot;, 2, &quot;x3&quot;, 1, &quot;x4&quot; ) y &lt;- tribble( ~key, ~val_y, 1, &quot;y1&quot;, 2, &quot;y2&quot; ) äº‹å®ä¸Šä¸‹é¢ä¸¤ç§æ¨¡å¼ç»“æœç›¸åŒï¼š left_join(x, y, by = &quot;key&quot;) # å·¦è¾¹æ‰€æœ‰åˆ—éƒ½ä»å³è¾¹å¯»æ±‚ #&gt; # A tibble: 4 Ã— 3 #&gt; key val_x val_y #&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1 x1 y1 #&gt; 2 2 x2 y2 #&gt; 3 2 x3 y2 #&gt; 4 1 x4 y1 right_join(x, y, by = &quot;key&quot;) # å³è¾¹æ‰€æœ‰åˆ—éƒ½ä»å·¦è¾¹å¯»æ±‚ï¼ˆä¸€å¯¹å¤šæ—¶å…¨ä¿ç•™ï¼‰ #&gt; # A tibble: 4 Ã— 3 #&gt; key val_x val_y #&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1 x1 y1 #&gt; 2 2 x2 y2 #&gt; 3 2 x3 y2 #&gt; 4 1 x4 y1 14.1.3 ç±»å‹3ï¼šä¸¤è¾¹éƒ½æœ‰é‡å¤é—®é¢˜ x &lt;- tribble( ~key, ~val_x, 1, &quot;x1&quot;, 2, &quot;x2&quot;, 2, &quot;x3&quot;, 3, &quot;x4&quot; ) y &lt;- tribble( ~key, ~val_y, 1, &quot;y1&quot;, 2, &quot;y2&quot;, 2, &quot;y3&quot;, 3, &quot;y4&quot; ) å·¦è¾¹æŸåˆ—å¯¹åº”åˆ°å³è¾¹å‡ºç°å¤šä¸ªç»“æœæ—¶ä¼šæ–°å¢åˆ—å»å¯¹åº”ï¼š left_join(x, y, by = &quot;key&quot;) #&gt; Warning in left_join(x, y, by = &quot;key&quot;): Each row in `x` is expected to match at most 1 row in `y`. #&gt; â„¹ Row 2 of `x` matches multiple rows. #&gt; â„¹ If multiple matches are expected, set `multiple = &quot;all&quot;` to silence this #&gt; warning. #&gt; # A tibble: 6 Ã— 3 #&gt; key val_x val_y #&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1 x1 y1 #&gt; 2 2 x2 y2 #&gt; 3 2 x2 y3 #&gt; 4 2 x3 y2 #&gt; 5 2 x3 y3 #&gt; 6 3 x4 y4 14.2 ç†è§£å¤šç§æ•°æ®åˆå¹¶æ–¹å¼ äº‹å®ä¸Šï¼Œå››å¤§ join ç›¸å…³ä¾èµ–åŒ… dplyrï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ r åŸç”Ÿè‡ªå¸¦çš„ base::merge å®ç°ï¼š dplyr è¯­å¥ å¯¹åº”çš„ merge è¯­å¥ è§£é‡Š inner_join(x, y) merge(x, y) åŒ¹é…ä¸ä¸Šçš„å‡ä¸ä¿ç•™ left_join(x, y) merge(x, y, all.x = TRUE) ä¿ç•™æ‰€æœ‰çš„ x right_join(x, y) merge(x, y, all.y = TRUE), ä¿ç•™æ‰€æœ‰çš„ y full_join(x, y) merge(x, y, all.x = TRUE, all.y = TRUE) ä¿ç•™æ‰€æœ‰çš„ x å’Œ y 14.3 è®¾ç½®æ“ä½œ intersectã€union å’Œ setdiff ç”¨äºå¯¹ä¸åŒè¡¨æ ¼çš„å·®å¼‚è¿›è¡ŒæŒ–æ˜ï¼š df1 &lt;- tribble( ~x, ~y, 1, 1, 2, 1 ) df2 &lt;- tribble( ~x, ~y, 1, 1, 1, 2 ) intersect(df1, df2) # è¿”å›ä¸¤è€…å…±åŒçš„æ•°æ®é›† #&gt; # A tibble: 1 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 1 union(df1, df2) # åˆå¹¶ä¸¤ä¸ªæ•°æ®é›†çš„æ•°æ®ï¼ˆç›¸åŒçš„åªåšä¸€æ¬¡è®°å½•ï¼‰ #&gt; # A tibble: 3 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 1 #&gt; 2 2 1 #&gt; 3 1 2 setdiff(df1, df2) # è¿”å›å‰è€…è§‚å¯Ÿåˆ°çš„åè€…æ‰€æ²¡æœ‰çš„å·®å¼‚éƒ¨åˆ† #&gt; # A tibble: 1 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2 1 setdiff(df2, df1) #&gt; # A tibble: 1 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 2 14.4 åˆå¹¶ nycflights æ•°æ®å¹¶åˆ†æ ä»”ç»†è§‚å¯Ÿ nycflights ä¸éš¾å‘ç°ï¼Œé‡Œé¢åŒ…å« airlinesã€airportsã€planes å’Œ weatherï¼Œä»¥åŠæˆ‘ä»¬å¸¸ç”¨çš„ flights æ•°æ®é›†ã€‚ airlines å…è®¸æ‚¨ä»å…¶ç¼©å†™ä»£ç ä¸­æŸ¥æ‰¾å®Œæ•´çš„è¿è¥å•†åç§°ï¼š airlines #&gt; # A tibble: 16 Ã— 2 #&gt; carrier name #&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 9E Endeavor Air Inc. #&gt; 2 AA American Airlines Inc. #&gt; 3 AS Alaska Airlines Inc. #&gt; 4 B6 JetBlue Airways #&gt; 5 DL Delta Air Lines Inc. #&gt; 6 EV ExpressJet Airlines Inc. #&gt; 7 F9 Frontier Airlines Inc. #&gt; 8 FL AirTran Airways Corporation #&gt; 9 HA Hawaiian Airlines Inc. #&gt; 10 MQ Envoy Air #&gt; 11 OO SkyWest Airlines Inc. #&gt; 12 UA United Air Lines Inc. #&gt; 13 US US Airways Inc. #&gt; 14 VX Virgin America #&gt; 15 WN Southwest Airlines Co. #&gt; 16 YV Mesa Airlines Inc. airports æä¾›æœ‰å…³æ¯ä¸ªæœºåœºçš„ä¿¡æ¯ï¼Œç”± faa æœºåœºä»£ç æ ‡è¯†ï¼š airports #&gt; # A tibble: 1,458 Ã— 8 #&gt; faa name lat lon alt tz dst tzone #&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 04G Lansdowne Airport 41.1 -80.6 1044 -5 A America/â€¦ #&gt; 2 06A Moton Field Municipal Airport 32.5 -85.7 264 -6 A America/â€¦ #&gt; 3 06C Schaumburg Regional 42.0 -88.1 801 -6 A America/â€¦ #&gt; 4 06N Randall Airport 41.4 -74.4 523 -5 A America/â€¦ #&gt; 5 09J Jekyll Island Airport 31.1 -81.4 11 -5 A America/â€¦ #&gt; 6 0A9 Elizabethton Municipal Airport 36.4 -82.2 1593 -5 A America/â€¦ #&gt; 7 0G6 Williams County Airport 41.5 -84.5 730 -5 A America/â€¦ #&gt; 8 0G7 Finger Lakes Regional Airport 42.9 -76.8 492 -5 A America/â€¦ #&gt; 9 0P2 Shoestring Aviation Airfield 39.8 -76.6 1000 -5 U America/â€¦ #&gt; 10 0S9 Jefferson County Intl 48.1 -123. 108 -8 A America/â€¦ #&gt; # â€¦ with 1,448 more rows planes æä¾›æœ‰å…³æ¯ä¸ªå¹³é¢çš„ä¿¡æ¯ï¼Œç”±å…¶ tailnum æ ‡è¯†ï¼š planes #&gt; # A tibble: 3,322 Ã— 9 #&gt; tailnum year type manufâ€¦Â¹ model engines seats speed engine #&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; #&gt; 1 N10156 2004 Fixed wing multi engiâ€¦ EMBRAER EMB-â€¦ 2 55 NA Turboâ€¦ #&gt; 2 N102UW 1998 Fixed wing multi engiâ€¦ AIRBUSâ€¦ A320â€¦ 2 182 NA Turboâ€¦ #&gt; 3 N103US 1999 Fixed wing multi engiâ€¦ AIRBUSâ€¦ A320â€¦ 2 182 NA Turboâ€¦ #&gt; 4 N104UW 1999 Fixed wing multi engiâ€¦ AIRBUSâ€¦ A320â€¦ 2 182 NA Turboâ€¦ #&gt; 5 N10575 2002 Fixed wing multi engiâ€¦ EMBRAER EMB-â€¦ 2 55 NA Turboâ€¦ #&gt; 6 N105UW 1999 Fixed wing multi engiâ€¦ AIRBUSâ€¦ A320â€¦ 2 182 NA Turboâ€¦ #&gt; 7 N107US 1999 Fixed wing multi engiâ€¦ AIRBUSâ€¦ A320â€¦ 2 182 NA Turboâ€¦ #&gt; 8 N108UW 1999 Fixed wing multi engiâ€¦ AIRBUSâ€¦ A320â€¦ 2 182 NA Turboâ€¦ #&gt; 9 N109UW 1999 Fixed wing multi engiâ€¦ AIRBUSâ€¦ A320â€¦ 2 182 NA Turboâ€¦ #&gt; 10 N110UW 1999 Fixed wing multi engiâ€¦ AIRBUSâ€¦ A320â€¦ 2 182 NA Turboâ€¦ #&gt; # â€¦ with 3,312 more rows, and abbreviated variable name Â¹â€‹manufacturer weather åˆ™ç»™å‡ºäº†æ¯ä¸ªçº½çº¦æœºåœºæ¯å°æ—¶çš„å¤©æ°”ï¼š weather #&gt; # A tibble: 26,115 Ã— 15 #&gt; origin year month day hour temp dewp humid wind_dir wind_speed wind_gâ€¦Â¹ #&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 EWR 2013 1 1 1 39.0 26.1 59.4 270 10.4 NA #&gt; 2 EWR 2013 1 1 2 39.0 27.0 61.6 250 8.06 NA #&gt; 3 EWR 2013 1 1 3 39.0 28.0 64.4 240 11.5 NA #&gt; 4 EWR 2013 1 1 4 39.9 28.0 62.2 250 12.7 NA #&gt; 5 EWR 2013 1 1 5 39.0 28.0 64.4 260 12.7 NA #&gt; 6 EWR 2013 1 1 6 37.9 28.0 67.2 240 11.5 NA #&gt; 7 EWR 2013 1 1 7 39.0 28.0 64.4 240 15.0 NA #&gt; 8 EWR 2013 1 1 8 39.9 28.0 62.2 250 10.4 NA #&gt; 9 EWR 2013 1 1 9 39.9 28.0 62.2 260 15.0 NA #&gt; 10 EWR 2013 1 1 10 41 28.0 59.6 260 13.8 NA #&gt; # â€¦ with 26,105 more rows, 4 more variables: precip &lt;dbl&gt;, pressure &lt;dbl&gt;, #&gt; # visib &lt;dbl&gt;, time_hour &lt;dttm&gt;, and abbreviated variable name Â¹â€‹wind_gust å®ƒä»¬çš„å…³ç³»å›¾å¦‚ä¸‹ï¼š relational-nycflights æˆ‘ä»¬é¦–å…ˆå¯¹æ•°æ®é›†è¿›è¡Œç²¾ç®€ï¼š flights_smaller &lt;- flights %&gt;% select(year:day, hour, origin, dest, tailnum, carrier) ç”±äº carrier æ²¡æœ‰è¡¥å…¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å†³å®šè”åˆ airlines æ•°æ®é›†è¿›è¡Œé€‰æ‹©æ€§åˆå¹¶ï¼š flights_smaller %&gt;% select(-c(origin, dest)) %&gt;% # æ ¹æ®åˆ«çš„æ•°æ®é›†åœ¨å³ä¾§è¡¥å…¨æ•°æ®ï¼Œä¾æ® / é‡å æ•°æ®ä¸º carrier left_join(airlines, by = &quot;carrier&quot;) #&gt; # A tibble: 336,776 Ã— 7 #&gt; year month day hour tailnum carrier name #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 2013 1 1 5 N14228 UA United Air Lines Inc. #&gt; 2 2013 1 1 5 N24211 UA United Air Lines Inc. #&gt; 3 2013 1 1 5 N619AA AA American Airlines Inc. #&gt; 4 2013 1 1 5 N804JB B6 JetBlue Airways #&gt; 5 2013 1 1 6 N668DN DL Delta Air Lines Inc. #&gt; 6 2013 1 1 5 N39463 UA United Air Lines Inc. #&gt; 7 2013 1 1 6 N516JB B6 JetBlue Airways #&gt; 8 2013 1 1 6 N829AS EV ExpressJet Airlines Inc. #&gt; 9 2013 1 1 6 N593JB B6 JetBlue Airways #&gt; 10 2013 1 1 6 N3ALAA AA American Airlines Inc. #&gt; # â€¦ with 336,766 more rows å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ mutate + match å®ç°åŒæ ·æ•ˆæœï¼š flights_smaller %&gt;% select(-c(origin, dest)) %&gt;% mutate( # ä» airlines çš„ name å‘é‡è·å–æ•°æ®ï¼Œèµ‹å€¼åˆ°æ–°åˆ— â€œnameâ€ name = airlines$name[match( # è·å–çš„æ•°æ®é€šè¿‡ match æ§åˆ¶ # é€šè¿‡ filghts çš„ carrier åŒ¹é…æ•°æ®ï¼Œè¿”å›å¯¹åº” airlines çš„ carrier carrier, airlines$carrier )] ) #&gt; # A tibble: 336,776 Ã— 7 #&gt; year month day hour tailnum carrier name #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 2013 1 1 5 N14228 UA United Air Lines Inc. #&gt; 2 2013 1 1 5 N24211 UA United Air Lines Inc. #&gt; 3 2013 1 1 5 N619AA AA American Airlines Inc. #&gt; 4 2013 1 1 5 N804JB B6 JetBlue Airways #&gt; 5 2013 1 1 6 N668DN DL Delta Air Lines Inc. #&gt; 6 2013 1 1 5 N39463 UA United Air Lines Inc. #&gt; 7 2013 1 1 6 N516JB B6 JetBlue Airways #&gt; 8 2013 1 1 6 N829AS EV ExpressJet Airlines Inc. #&gt; 9 2013 1 1 6 N593JB B6 JetBlue Airways #&gt; 10 2013 1 1 6 N3ALAA AA American Airlines Inc. #&gt; # â€¦ with 336,766 more rows è€Œå¦‚æœè¦ä¸ weather å¹¶æ¥ï¼š flights_smaller %&gt;% left_join(weather) # å¦‚æœä¸å†™ byï¼Œåˆ™ä¸ºé»˜è®¤ NULLï¼Œä¼šå°†å·¦è¾¹æ‰€æœ‰åˆ—å¾€å³è¾¹å¯¹åº”ä¸€éï¼Œç›¸å½“äºä¸‹é¢ä»£ç ï¼š #&gt; Joining with `by = join_by(year, month, day, hour, origin)` #&gt; # A tibble: 336,776 Ã— 18 #&gt; year month day hour origin dest tailnum carrier temp dewp humid #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2013 1 1 5 EWR IAH N14228 UA 39.0 28.0 64.4 #&gt; 2 2013 1 1 5 LGA IAH N24211 UA 39.9 25.0 54.8 #&gt; 3 2013 1 1 5 JFK MIA N619AA AA 39.0 27.0 61.6 #&gt; 4 2013 1 1 5 JFK BQN N804JB B6 39.0 27.0 61.6 #&gt; 5 2013 1 1 6 LGA ATL N668DN DL 39.9 25.0 54.8 #&gt; 6 2013 1 1 5 EWR ORD N39463 UA 39.0 28.0 64.4 #&gt; 7 2013 1 1 6 EWR FLL N516JB B6 37.9 28.0 67.2 #&gt; 8 2013 1 1 6 LGA IAD N829AS EV 39.9 25.0 54.8 #&gt; 9 2013 1 1 6 JFK MCO N593JB B6 37.9 27.0 64.3 #&gt; 10 2013 1 1 6 LGA ORD N3ALAA AA 39.9 25.0 54.8 #&gt; # â€¦ with 336,766 more rows, and 7 more variables: wind_dir &lt;dbl&gt;, #&gt; # wind_speed &lt;dbl&gt;, wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;, #&gt; # visib &lt;dbl&gt;, time_hour &lt;dttm&gt; # left_join(weather, by = c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;, &quot;hour&quot;, &quot;origin&quot;)) äº‹å®ä¸Š â€œby =â€ å¯ä»¥çœç•¥ã€‚å¦‚æœç­›é€‰å˜é‡å¡«å…¥äº†ç”¨ç­‰äºè¿æ¥çš„å‘é‡ï¼Œåˆ™æ˜¯å·¦å³éƒ½æŒ‡å®šäº†åˆ—ï¼š flights_smaller %&gt;% # flighs_smaller çš„ dest åˆ—ä¸ airports çš„ faa åˆ—æ¯”è¾ƒã€å¯¹åº”å’Œè¿æ¥ left_join(airports, c(&quot;dest&quot; = &quot;faa&quot;)) #&gt; # A tibble: 336,776 Ã— 15 #&gt; year month day hour origin dest tailnum carrier name lat lon alt #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2013 1 1 5 EWR IAH N14228 UA Georgâ€¦ 30.0 -95.3 97 #&gt; 2 2013 1 1 5 LGA IAH N24211 UA Georgâ€¦ 30.0 -95.3 97 #&gt; 3 2013 1 1 5 JFK MIA N619AA AA Miamiâ€¦ 25.8 -80.3 8 #&gt; 4 2013 1 1 5 JFK BQN N804JB B6 &lt;NA&gt; NA NA NA #&gt; 5 2013 1 1 6 LGA ATL N668DN DL Hartsâ€¦ 33.6 -84.4 1026 #&gt; 6 2013 1 1 5 EWR ORD N39463 UA Chicaâ€¦ 42.0 -87.9 668 #&gt; 7 2013 1 1 6 EWR FLL N516JB B6 Fort â€¦ 26.1 -80.2 9 #&gt; 8 2013 1 1 6 LGA IAD N829AS EV Washiâ€¦ 38.9 -77.5 313 #&gt; 9 2013 1 1 6 JFK MCO N593JB B6 Orlanâ€¦ 28.4 -81.3 96 #&gt; 10 2013 1 1 6 LGA ORD N3ALAA AA Chicaâ€¦ 42.0 -87.9 668 #&gt; # â€¦ with 336,766 more rows, and 3 more variables: tz &lt;dbl&gt;, dst &lt;chr&gt;, #&gt; # tzone &lt;chr&gt; åˆ†æç»˜å›¾æœºåœºåœ¨ç¾å›½çš„åˆ†å¸ƒå›¾å’Œåˆ°è¾¾æ­¤å¤„çš„é£æœºçš„å»¶è¯¯æ•´ä½“çŠ¶å†µï¼š avg_dest_delays &lt;- flights %&gt;% group_by(dest) %&gt;% # æ–°çš„åˆ— delay å–å€¼ä¸ºå„ç›®çš„åœ°çš„ arr_delayï¼ˆåˆ°è¾¾å»¶è¯¯ï¼‰çš„å¹³å‡å€¼ summarise(delay = mean(arr_delay, na.rm = TRUE)) %&gt;% # æ³¨æ„å¯èƒ½å­˜åœ¨ NA å€¼ï¼Œéœ€è¦å‰”é™¤ # æ³¨æ„å‘é‡å†…å·¦ä¾§æ•°æ®å…¶å®æ‰“ä¸æ‰“å¼•å·éƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†å³ä¾§å¿…é¡»æ‰“ inner_join(airports, by = c(dest = &quot;faa&quot;)) # å…¶ä¸­ faa ä¸ºæœºåœºä»£ç  avg_dest_delays #&gt; # A tibble: 101 Ã— 9 #&gt; dest delay name lat lon alt tz dst tzone #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 ABQ 4.38 Albuquerque International Sâ€¦ 35.0 -107. 5355 -7 A Amerâ€¦ #&gt; 2 ACK 4.85 Nantucket Mem 41.3 -70.1 48 -5 A Amerâ€¦ #&gt; 3 ALB 14.4 Albany Intl 42.7 -73.8 285 -5 A Amerâ€¦ #&gt; 4 ANC -2.5 Ted Stevens Anchorage Intl 61.2 -150. 152 -9 A Amerâ€¦ #&gt; 5 ATL 11.3 Hartsfield Jackson Atlanta â€¦ 33.6 -84.4 1026 -5 A Amerâ€¦ #&gt; 6 AUS 6.02 Austin Bergstrom Intl 30.2 -97.7 542 -6 A Amerâ€¦ #&gt; 7 AVL 8.00 Asheville Regional Airport 35.4 -82.5 2165 -5 A Amerâ€¦ #&gt; 8 BDL 7.05 Bradley Intl 41.9 -72.7 173 -5 A Amerâ€¦ #&gt; 9 BGR 8.03 Bangor Intl 44.8 -68.8 192 -5 A Amerâ€¦ #&gt; 10 BHM 16.9 Birmingham Intl 33.6 -86.8 644 -6 A Amerâ€¦ #&gt; # â€¦ with 91 more rows avg_dest_delays %&gt;% # lat å’Œ lon ä¸ºæœºåœºçš„ç»åº¦å’Œçº¬åº¦ä¿¡æ¯ï¼Œé¢œè‰²ä»£è¡¨å¹³å‡å»¶è¿Ÿæ—¶é•¿ ggplot(mapping = aes(lon, lat, colour = delay)) + borders(&quot;state&quot;) + # è¿™ä¸€å¥è¯æ˜¯åœ¨åŠ å…¥ç¾å›½åœ°å›¾èƒŒæ¿ geom_point() + # æ˜¾ç¤ºæœºåœºä½ç½®åˆ†å¸ƒ coord_quickmap() # ä¿æŒåœ°å›¾æ¨ªçºµæ¯”ï¼Œé˜²æ­¢å®é™…å›¾ç‰‡æ‹‰ä¼¸å¯¼è‡´çš„åœ°å›¾å˜å½¢ åˆ†æåˆå¹¶å‡ºå‘åœ°çš„å»¶è¯¯çŠ¶å†µï¼š airport_locations &lt;- airports %&gt;% select(faa, lat, lon) flights %&gt;% select(year:day, hour, origin, dest) %&gt;% # æ³¨æ„è¿™æ · origin å’Œ dest éƒ½ç”±å¯¹åº”çš„ç»çº¬åº¦åæ ‡æ•°æ®ï¼Œå­˜åœ¨å‘½åå†²çª # å®é™…è¿è¡Œæ—¶ï¼Œè¿è¡Œåˆ°ä¸‹é¢çš„ left_join ä¼šå‘ç°ï¼Œdplyr ä¼šè‡ªåŠ¨ç»™æ—§åˆ—ååŠ ä¸Š â€œ.xâ€ï¼Œæ–°åˆ—å â€œ.yâ€ # left_join( # airport_locations, # by = c(&quot;dest&quot; = &quot;faa&quot;) # ) # æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ suffix è¦†ç›–è¿™ä¸ªé»˜è®¤è¡Œä¸ºè®¾ç½®çš„åç¼€ left_join( airport_locations, by = c(&quot;dest&quot; = &quot;faa&quot;), suffix = c(&quot;_origin&quot;, &quot;_dest&quot;) ) #&gt; # A tibble: 336,776 Ã— 8 #&gt; year month day hour origin dest lat lon #&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2013 1 1 5 EWR IAH 30.0 -95.3 #&gt; 2 2013 1 1 5 LGA IAH 30.0 -95.3 #&gt; 3 2013 1 1 5 JFK MIA 25.8 -80.3 #&gt; 4 2013 1 1 5 JFK BQN NA NA #&gt; 5 2013 1 1 6 LGA ATL 33.6 -84.4 #&gt; 6 2013 1 1 5 EWR ORD 42.0 -87.9 #&gt; 7 2013 1 1 6 EWR FLL 26.1 -80.2 #&gt; 8 2013 1 1 6 LGA IAD 38.9 -77.5 #&gt; 9 2013 1 1 6 JFK MCO 28.4 -81.3 #&gt; 10 2013 1 1 6 LGA ORD 42.0 -87.9 #&gt; # â€¦ with 336,766 more rows "],["string.html", "Chapter 15 Strings 15.1 å­—ç¬¦ä¸²åŸºæœ¬çŸ¥è¯† 15.2 æ­£åˆ™è¡¨è¾¾å¼ 15.3 å®é™…åº”ç”¨ 15.4 åˆ†ç»„åŒ¹é… 15.5 æ­£åˆ™è¡¨è¾¾å¼å…¶ä»–ç”¨æ³•", " Chapter 15 Strings æœ¬èŠ‚ä¸»è¦å­¦ä¹ å­—ç¬¦ä¸²å¦‚ä½•å·¥ä½œä»¥åŠå¦‚ä½•æ‰‹åŠ¨åˆ›å»ºå­—ç¬¦ä¸²çš„åŸºç¡€çŸ¥è¯†ï¼Œä½†å…¶é‡ç‚¹åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸Šã€‚ æ­£åˆ™è¡¨è¾¾å¼å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå­—ç¬¦ä¸²é€šå¸¸åŒ…å«éç»“æ„åŒ–æˆ–åŠç»“æ„åŒ–æ•°æ®ï¼Œè€Œæ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ç§ç”¨äºæè¿°å­—ç¬¦ä¸²ä¸­æ¨¡å¼çš„ç®€æ´è¯­è¨€ã€‚ library(tidyverse) 15.1 å­—ç¬¦ä¸²åŸºæœ¬çŸ¥è¯† ä¸å…¶ä»–è¯­è¨€ä¸åŒï¼Œæˆ–è€…è¯´ä¸ Python ç›¸åŒï¼Œæˆ‘ä»¬å¯ä»¥éšæ„åˆ›å»ºå¸¦æœ‰å•å¼•å·æˆ–åŒå¼•å·çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸”å®ƒä»¬æ²¡æœ‰åŒºåˆ«ã€‚ä½†å…¶å®æ›´å»ºè®®å§‹ç»ˆä½¿ç”¨\"ï¼Œé™¤éè¦åˆ›å»ºä¸€ä¸ªåŒ…å«å¤šä¸ª\"çš„å­—ç¬¦ä¸²ã€‚ string1 &lt;- &quot;This is a string&quot; string1 #&gt; [1] &quot;This is a string&quot; string2 &lt;- &#39;If I want to include a &quot;quote&quot; inside a string, I use single quotes&#39; string2 #&gt; [1] &quot;If I want to include a \\&quot;quote\\&quot; inside a string, I use single quotes&quot; # æœ‰æ—¶å€™å…¶å®ä½¿ç”¨åæ–œæ  â€œ\\â€ æ¥è½¬ä¹‰æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹© double_quote &lt;- &quot;\\&quot;&quot; # æˆ–è€… &#39;&quot;&#39; single_quote &lt;- &quot;&#39;&quot; # æˆ–è€… &quot;&#39;&quot; # è¿™æ„å‘³ç€å¦‚æœè¦åŒ…å«æ–‡å­—åæ–œæ ï¼Œåˆ™éœ€è¦å°†å…¶åŠ å€ï¼š&quot;\\\\&quot; ä½†æ³¨æ„å­—ç¬¦ä¸²çš„æ‰“å°è¡¨ç¤ºå½¢å¼ä¸å­—ç¬¦ä¸²æœ¬èº«ä¸åŒï¼šæ‰“å°çš„è¡¨ç¤ºå½¢å¼ä¸ºæ˜¾ç¤ºè½¬ä¹‰ã€‚è¦æŸ¥çœ‹å­—ç¬¦ä¸²çš„åŸå§‹å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸Š str_view() æˆ–è€… R è‡ªå¸¦åŒ…çš„ writeLines()ï¼š x &lt;- c(single_quote, double_quote) x #&gt; [1] &quot;&#39;&quot; &quot;\\&quot;&quot; writeLines(x) # æŸ¥çœ‹åŸå§‹ #&gt; &#39; #&gt; &quot; è¿˜æœ‰å…¶ä»–å‡ ä¸ªç‰¹æ®Šå­—ç¬¦ä¹¦å†™ã€‚æœ€å¸¸è§çš„æ˜¯ \\n æ¢è¡Œç¬¦å’Œ\\tã€‚æœ‰æ—¶è¿˜ä¼šçœ‹åˆ°åƒæ˜¯ \\u00b5 è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œè¿™æ˜¯ä¸€ç§åœ¨æ‰€æœ‰å¹³å°ä¸Šç¼–å†™éè‹±è¯­å­—ç¬¦çš„é€šç”¨æ–¹æ³•ï¼š x &lt;- &quot;\\u00b5&quot; x #&gt; [1] &quot;Âµ&quot; å¤šä¸ªå­—ç¬¦ä¸²é€šå¸¸å­˜å‚¨åœ¨å­—ç¬¦å‘é‡ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºï¼šc() c(&quot;one&quot;, &quot;two&quot;, &quot;three&quot;) #&gt; [1] &quot;one&quot; &quot;two&quot; &quot;three&quot; R è‡ªå¸¦çš„ Base åŒ…å«è®¸å¤šç”¨äºå¤„ç†å­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œä½†æˆ‘ä»¬ä¸æ‰“ç®—ä½¿ç”¨å®ƒä»¬ï¼Œå› ä¸ºå®ƒä»¬ç§ç±»å¤æ‚ç¹å¤šå„ä¸ªå‡½æ•°ç»“æœä¹Ÿä¸åŒã€‚ç›¸åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ stringr åŒ…ï¼ˆå·²ç»é›†æˆåœ¨ tidyverse é‡Œï¼‰é‡Œçš„å‡½æ•° str_*()ã€‚å®ƒä»¬å…·æœ‰æ›´ç›´è§‚çš„åç§°ï¼Œä¹Ÿæ›´å¥½ç”¨ã€‚ 15.1.1 å­—ç¬¦ä¸²é•¿åº¦ str &lt;- c(&quot;a&quot;, &quot;R for data science&quot;, NA) str_length(str) # æŸ¥çœ‹é•¿åº¦ #&gt; [1] 1 18 NA 15.1.2 åˆå¹¶å­—ç¬¦ä¸² str_c(&quot;|-&quot;, str, &quot;-|&quot;) # å°†å¤šä¸ªå­—ç¬¦ä¸²åˆå¹¶å±‚ä¸€ä¸ª #&gt; [1] &quot;|-a-|&quot; &quot;|-R for data science-|&quot; NA str_c(&quot;|-&quot;, str_replace_na(str), &quot;-|&quot;) # NA è½¬å­—ç¬¦ #&gt; [1] &quot;|-a-|&quot; &quot;|-R for data science-|&quot; &quot;|-NA-|&quot; str_c(c(&quot;x&quot;, &quot;y&quot;, &quot;z&quot;), collapse = &quot;, &quot;) # ä½¿ç”¨æŒ‡å®šå­—ç¬¦ä¸²æ¥ #&gt; [1] &quot;x, y, z&quot; å…¶ä¸­ str_c() å‚æ•°é‡Œï¼Œé•¿åº¦ä¸º 0 çš„å¯¹è±¡å°†è‡ªåŠ¨è¢«ä¸¢å¼ƒæ‰ã€‚è¿™ä¸ if ç»“åˆä½¿ç”¨æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼š name &lt;- &quot;Hadley&quot; time_of_day &lt;- &quot;morning&quot; birthday &lt;- FALSE str_c( &quot;Good &quot;, time_of_day, &quot; &quot;, name, if (birthday) &quot; and HAPPY BIRTHDAY&quot;, &quot;.&quot; ) #&gt; [1] &quot;Good morning Hadley.&quot; 15.1.3 æå–å­—ç¬¦ä¸² æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ str_sub() æå–å­—ç¬¦ä¸²çš„æŒ‡å®šéƒ¨åˆ†ï¼Œå…¶å‚æ•°åˆ†åˆ«ä¸ºå‘é‡ã€èµ·å§‹å’Œç»“æŸä½ã€‚ fruit &lt;- c(&quot;Apple&quot;, &quot;Banana&quot;, &quot;Pear&quot;) str_sub(fruit, 1, 3) #&gt; [1] &quot;App&quot; &quot;Ban&quot; &quot;Pea&quot; str_sub(fruit, -3, -1) #&gt; [1] &quot;ple&quot; &quot;ana&quot; &quot;ear&quot; # æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡èµ‹å€¼æ³•å°†å†…å®¹èµ‹å€¼ç»™é€‰ä¸­éƒ¨åˆ†ï¼š str_sub(fruit, 1, 1) &lt;- str_to_lower(str_sub(fruit, 1, 1)) fruit #&gt; [1] &quot;apple&quot; &quot;banana&quot; &quot;pear&quot; 15.1.4 è¯­è¨€ç¯å¢ƒ ä¸åŒçš„è¯­è¨€ç¯å¢ƒä¹Ÿä¼šå¯¹å¤§å°å†™çš„å†™æ³•é€ æˆå½±å“ã€‚str_to_upper å°±è€ƒè™‘åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ç»™äºˆäº† locate å‚æ•°ã€‚ str_to_upper(c(&quot;i&quot;, &quot;&lt;U+0131&gt;&quot;)) #&gt; [1] &quot;I&quot; &quot;&lt;U+0131&gt;&quot; str_to_upper(c(&quot;i&quot;, &quot;&lt;U+0131&gt;&quot;), locale = &quot;tr&quot;) #&gt; [1] &quot;Ä°&quot; &quot;&lt;U+0131&gt;&quot; è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå¥½çš„è¡¨æ ¼ï¼š aa é˜¿æ³•å°”è¯­ fr æ³•è¯­ li æ—å ¡è¯­ se åŒ—è¨ç±³è¯­ ab é˜¿å¸ƒå“ˆå…¹è¯­ fy å¼—é‡Œè¥¿äºšè¯­ ln æ—åŠ æ‹‰è¯­ sg æ¡‘æˆˆè¯­ ae é˜¿ç»´æ–¯é™€è¯­ ga çˆ±å°”å…°è¯­ lo è€æŒè¯­ sh å¡å°”ç»´äºš-å…‹ç½—åœ°äºšè¯­ af å—éè¯­ gd è‹æ ¼å…°ç›–å°”è¯­ lt ç«‹é™¶å®›è¯­ si åƒ§ä¼½ç½—è¯­ ak é˜¿åè¯­ gl åŠ åˆ©è¥¿äºšè¯­ lu å¢å·´è¯­ sk æ–¯æ´›ä¼å…‹è¯­ am é˜¿å§†å“ˆæ‹‰è¯­ gn ç“œæ‹‰å°¼è¯­ lv æ‹‰è„±ç»´äºšè¯­ sl æ–¯æ´›æ–‡å°¼äºšè¯­ an é˜¿æ‹‰è´¡è¯­ gu å¤å‰æ‹‰ç‰¹è¯­ mg é©¬è¾¾åŠ æ–¯åŠ è¯­ sm è¨æ‘©äºšè¯­ ar é˜¿æ‹‰ä¼¯è¯­ gv é©¬æ©å²›è¯­ mh é©¬ç»å°”è¯­ sn ä¿®çº³è¯­ as é˜¿è¨å§†è¯­ ha è±ªè¨è¯­ mi æ¯›åˆ©è¯­ so ç´¢é©¬é‡Œè¯­ av é˜¿ç“¦å°”è¯­ he å¸Œä¼¯æ¥è¯­ mk é©¬å…¶é¡¿è¯­ sq é˜¿å°”å·´å°¼äºšè¯­ ay è‰¾é©¬æ‹‰è¯­ hi å°åœ°è¯­ ml é©¬æ‹‰é›…æ‹‰å§†è¯­ sr å¡å°”ç»´äºšè¯­ az é˜¿å¡æ‹œç–†è¯­ ho å¸Œé‡Œè«å›¾è¯­ mn è’™å¤è¯­ ss æ–¯å¨å£«è¯­ ba å·´ä»€åŸºå°”è¯­ hr å…‹ç½—åœ°äºšè¯­ mo æ‘©å°”è¾¾ç»´äºšè¯­ st å¡ç´¢æ‰˜è¯­ be ç™½ä¿„ç½—æ–¯è¯­ ht æµ·åœ°å…‹é‡Œå¥¥å°”è¯­ mr é©¬æ‹‰åœ°è¯­ su å·½ä»–è¯­ bg ä¿åŠ åˆ©äºšè¯­ hu åŒˆç‰™åˆ©è¯­ ms é©¬æ¥è¯­ sv ç‘å…¸è¯­ bh æ¯”å“ˆå°”è¯­ hy äºšç¾å°¼äºšè¯­ mt é©¬è€³ä»–è¯­ sw æ–¯ç“¦å¸Œé‡Œè¯­ bi æ¯”æ–¯æ‹‰é©¬è¯­ hz èµ«é›·ç½—è¯­ my ç¼…ç”¸è¯­ ta æ³°ç±³å°”è¯­ bm ç­å·´æ‹‰è¯­ ia å› ç‰¹è¯­ na ç‘™é²è¯­ te æ³°å¢å›ºè¯­ bn å­ŸåŠ æ‹‰è¯­ id å°å°¼è¯­ nb ä¹¦é¢æŒªå¨è¯­ tg å¡”å‰å…‹è¯­ bo è—è¯­ ie è¥¿æ–¹å›½é™…è¯­ nd åŒ—æ©å¾·è´è±è¯­ th æ³°è¯­ br å¸ƒåˆ—å¡”å°¼è¯­ ig ä¼Šåšè¯­ ne å°¼æ³Šå°”è¯­ ti ææ ¼é›·å°¼äºšè¯­ bs æ³¢æ–¯å°¼äºšè¯­ ii å››å·å½è¯­ï¼ˆè¯ºè‹è¯­ï¼‰ ng æ©æ•¦åŠ è¯­ tk åœŸåº“æ›¼è¯­ ca åŠ æ³°éš†è¯­ ik ä¼ŠåŠªçš®å…‹è¯­ nl è·å…°è¯­ tl ä»–åŠ ç¦„è¯­ ce è½¦è‡£è¯­ io ä¼Šå¤šè¯­ nn æ–°æŒªå¨è¯­ tn èŒ¨ç“¦çº³è¯­ ch æŸ¥è«ç½—è¯­ is å†°å²›è¯­ no æŒªå¨è¯­ to æ±¤åŠ è¯­ co ç§‘è¥¿å˜‰è¯­ it æ„å¤§åˆ©è¯­ nr å—æ©å¾·è´è±è¯­ tr åœŸè€³å…¶è¯­ cr å…‹é‡Œè¯­ iu å› çº½ç‰¹è¯­ nv çº³ç“¦éœè¯­ ts å®—åŠ è¯­ cs æ·å…‹è¯­ ja æ—¥è¯­ ny å°¼æ‰¬è´¾è¯­ tt å¡”å¡”å°”è¯­ cu å¤æ•™ä¼šæ–¯æ‹‰å¤«è¯­ jv çˆªå“‡è¯­ oc å¥¥å…‹è¯­ tw ç‰¹å¨è¯­ cv æ¥šç“¦ä»€è¯­ ka æ ¼é²å‰äºšè¯­ oj å¥¥æ°å¸ƒç“¦è¯­ ty å¡”å¸Œæè¯­ cy å¨å°”å£«è¯­ kg åˆšæœè¯­ om å¥¥ç½—è«è¯­ ug ç»´å¾å°”è¯­ da ä¸¹éº¦è¯­ ki åŸºåº“å°¤è¯­ or å¥¥é‡Œäºšè¯­ uk ä¹Œå…‹å…°è¯­ de å¾·è¯­ kj å®½äºšç›è¯­ os å¥¥å¡æ¢¯è¯­ ur ä¹Œå°”éƒ½è¯­ dv è¿ªç»´è¥¿è¯­ kk å“ˆè¨å…‹è¯­ pa æ—é®æ™®è¯­ uz ä¹Œå…¹åˆ«å…‹è¯­ dz ä¸ä¸¹è¯­ kl æ ¼é™µå…°è¯­ pi å·´åˆ©è¯­ ve æ–‡è¾¾è¯­ ee åŸƒç»´è¯­ km é«˜æ£‰è¯­ pl æ³¢å…°è¯­ vi è¶Šå—è¯­ el ç°ä»£å¸Œè…Šè¯­ kn å¡çº³è¾¾è¯­ ps æ™®ä»€å›¾è¯­ vo æ²ƒæ‹‰æ™®å…‹è¯­ en è‹±è¯­ ko æœé²œè¯­ã€éŸ©è¯­ pt è‘¡è„ç‰™è¯­ wa ç“¦éš†è¯­ eo ä¸–ç•Œè¯­ kr å¡åŠªé‡Œè¯­ qu å…‹ä¸˜äºšè¯­ wo æ²ƒæ´›å¤«è¯­ es è¥¿ç­ç‰™è¯­ ks å…‹ä»€ç±³å°”è¯­ rm ç½—æ›¼ä»€è¯­ xh ç§‘è¨è¯­ et çˆ±æ²™å°¼äºšè¯­ ku åº“å°”å¾·è¯­ rn åŸºéš†è¿ªè¯­ yi ä¾åœ°è¯­ eu å·´æ–¯å…‹è¯­ kv ç§‘ç±³è¯­ ro ç½—é©¬å°¼äºšè¯­ yo çº¦é²å·´è¯­ fa æ³¢æ–¯è¯­ kw åº·æ²ƒå°”è¯­ ru ä¿„è¯­ za å£®è¯­ ff å¯Œæ‹‰è¯­ ky å‰å°”å‰æ–¯è¯­ rw å¢æ—ºè¾¾è¯­ zh ä¸­æ–‡ã€æ±‰è¯­ fi èŠ¬å…°è¯­ la æ‹‰ä¸è¯­ sa æ¢µè¯­ zu ç¥–é²è¯­ fj æ–æµè¯­ lb å¢æ£®å ¡è¯­ sc æ’’ä¸è¯­ fo æ³•ç½—è¯­ lg å¢å¹²è¾¾è¯­ sd ä¿¡å¾·è¯­ è‡ª RFC 3066 å‡ºç‰ˆåï¼ŒISO 639-1 æ–°å¢äº†ä»¥ä¸‹è¯­è¨€ï¼š ISO 639-1 ISO 639-2 åç§° æ›´æ”¹æ—¥æœŸ æ›´æ”¹ç±»å‹ æ›¾ç”¨ä»£ç  io ido ä¼Šå¤šè¯­ 2002å¹´1æœˆ15æ—¥ æ–°å¢ art wa wln ç“¦éš†è¯­ 2002å¹´1æœˆ29æ—¥ æ–°å¢ roa li lim æ—å ¡è¯­ 2002å¹´8æœˆ2æ—¥ æ–°å¢ gem ii iii å››å·çœå½è¯­ï¼ˆè¯ºè‹è¯­ï¼‰ 2002å¹´10æœˆ14æ—¥ æ–°å¢ an arg é˜¿æ‹‰è´¡è¯­ 2002å¹´12æœˆ23æ—¥ æ–°å¢ roa ht hat æµ·åœ°å…‹é‡Œå¥¥å°”è¯­ 2003å¹´2æœˆ26æ—¥ æ–°å¢ cpf 15.1.5 å­—ç¬¦ä¸²æ’åº äº‹å®ä¸Š R è‡ªå¸¦çš„ sort() å’Œ order() å°±å·²ç»å¾ˆå¥½ç”¨äº†ï¼Œèƒ½ä¾æ®ç³»ç»Ÿè®¾ç½®åŒºåŸŸæ¥æ’åºã€‚ä½†å¦‚æœä½ æƒ³è¦è‡ªå®šä¹‰åŠŸèƒ½ï¼Œé‚£ str_sort() å¯èƒ½æ˜¯æ›´ä¼˜è§£ã€‚ str_sort(fruit, locale = &quot;en&quot;) # ä½¿ç”¨ English æ’åº #&gt; [1] &quot;apple&quot; &quot;banana&quot; &quot;pear&quot; str_sort(fruit, locale = &quot;haw&quot;) # ä½¿ç”¨ Hawaiian æ’åº #&gt; [1] &quot;apple&quot; &quot;banana&quot; &quot;pear&quot; 15.2 æ­£åˆ™è¡¨è¾¾å¼ 15.2.1 åŸºæœ¬åŒ¹é… ä½¿ç”¨ str_view() å¯ä»¥å¯è§†åŒ–åœ°è§‚å¯ŸåŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ï¼š str_view(fruit, &quot;an&quot;) #&gt; [2] â”‚ b&lt;an&gt;&lt;an&gt;a åŒ¹é…å­—ç¬¦ä¸²éµå¾ª regexps è§„åˆ™ï¼Œå…¶ä¸­ â€œ.â€ è¡¨ç¤ºä»»æ„å­—ç¬¦ï¼š str_view(fruit, &quot;.a.&quot;) #&gt; [2] â”‚ &lt;ban&gt;ana #&gt; [3] â”‚ p&lt;ear&gt; ä½†æˆ‘ä»¬å¾ˆå¿«å°±å‘ç°ä¸€ä¸ªé—®é¢˜ï¼šâ€œ.â€ å›ºç„¶å¥½ç”¨ï¼Œä½†å½“æˆ‘ä»¬çœŸæ­£è¦åŒ¹é…å­—ç¬¦ â€œ.â€ çš„æ—¶å€™ï¼Œå°±ä¼šå˜å¾—æ£˜æ‰‹ã€‚regexps æä¾›äº†è½¬ä¹‰æ³•ï¼Œå³ \\.ï¼Œä½†è¿™ä¸ª â€œâ€ ä¼šä¸æˆ‘ä»¬çš„ R è¯­è¨€è§„èŒƒç›¸å†²çªã€‚æ‰€ä»¥æˆ‘ä»¬æå‡ºäº†è½¬ä¹‰æ–œæ ã€‚ # åŒæ–œæ ä¼šè½¬ä¹‰æ–œæ  dot_symbol &lt;- &quot;\\\\.&quot; # å®é™…æ‰“å°å‡ºæ¥çš„è¡¨è¾¾å¼æ˜¯å•æ–œæ  writeLines(dot_symbol) #&gt; \\. # è€Œé€šè¿‡ regexps è½¬æ¢åŒ¹é…æ—¶ï¼Œåˆšå¥½å°±åªæ˜¯ä¸€ä¸ª â€œ.â€ è€Œå·² str_view(c(&quot;abc&quot;, &quot;a.c&quot;, &quot;bef&quot;), &quot;a\\\\.c&quot;) #&gt; [2] â”‚ &lt;a.c&gt; åŒç†ï¼ŒåŒ¹é…ä¸€ä¸ªåæ–œæ åˆ™éœ€è¦4ä¸ªæ–œæ ï¼š x &lt;- &quot;a\\\\b&quot; writeLines(x) #&gt; a\\b str_view(x, &quot;\\\\\\\\&quot;) #&gt; [1] â”‚ a&lt;\\&gt;b 15.2.2 é”šç‚¹å®šä½ ä»¥é”šç‚¹ä¸ºèµ·å§‹ï¼Œä¼šä¸€ç›´æŒ‡å‘å­—ç¬¦ä¸²çš„å¼€å§‹æˆ–ç»“å°¾ç‚¹æ¯”è¾ƒç‰¹å¾è¿›è¡ŒåŒ¹é…ã€‚å¦‚ï¼š ^ + åŒ¹é…ä¸²ï¼šåˆšå¥½ä¸å­—ç¬¦ä¸²çš„å¼€å¤´ç›¸åŒ¹é…ã€‚ åŒ¹é…ä¸² + $ï¼šåˆšå¥½ä¸å­—ç¬¦ä¸²çš„æœ«å°¾ç›¸åŒ¹é…ã€‚ apple &lt;- c(&quot;bad apple&quot;, &quot;milk with apple &amp; banana&quot;, &quot;apple music&quot;, &quot;apple&quot;) str_view(apple, &quot;^a&quot;) # ä»¥ â€œaâ€ å¼€å¤´çš„å­—ç¬¦ä¸² #&gt; [3] â”‚ &lt;a&gt;pple music #&gt; [4] â”‚ &lt;a&gt;pple str_view(apple, &quot;a$&quot;) # ä»¥ â€œaâ€ ç»“å°¾çš„å­—ç¬¦ä¸² #&gt; [2] â”‚ milk with apple &amp; banan&lt;a&gt; str_view(x, &quot;^apple$&quot;) # ä»¥ â€œappleâ€ å¼€å¤´å’Œç»“æŸï¼ˆä¸å¤šä¸å°‘å®Œå…¨åŒ¹é…ï¼‰çš„å­—ç¬¦ä¸² æˆ‘çŸ¥é“ä½ ä¼šè®°æ··çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä» Evan Misshula é‚£é‡Œæ¬å‡ºäº†è¿™ä¸ªå£è¯€ï¼š å¦‚æœä½ ä»æƒåŠ›å¼€å§‹ï¼ˆ^ï¼‰ï¼Œä½ æœ€ç»ˆä¼šå¾—åˆ°è´¢å¯Œï¼ˆ$ï¼‰ã€‚ æ­¤å¤–æˆ‘ä»¬è¿˜å¯ä»¥å°†å•è¯è¾¹ç•Œ \\b åŒ¹é…ã€‚åœ¨ R é‡Œæˆ‘ä»¬å¯èƒ½ä¸é‚£ä¹ˆå¸¸å¸¸ç”¨åˆ°ï¼Œä½†åœ¨ RStudio ç­‰ IDE é‡Œæœç´¢æ—¶ï¼Œå½“æƒ³æ‰¾åˆ°ä½œä¸ºå…¶ä»–å‡½æ•°ç»„æˆéƒ¨åˆ†çš„å‡½æ•°çš„åç§°æ—¶ï¼Œæœ‰æ—¶ä¼šç”¨åˆ°å®ƒã€‚å¦‚ï¼Œæœç´¢ \\bsum\\bï¼Œå¯ä»¥é¿å…åŒ¹é…åˆ° summariseã€summaryã€rowsum ç­‰ã€‚ 15.2.3 å­—ç¬¦å‹ä¸æ›¿ä»£æ³•åŒ¹é… é™¤äº†ä¸Šé¢æåˆ°çš„ $ã€^ã€\\b é”šç‚¹å®šä½æ³•ï¼Œæˆ‘ä»¬è¿˜æœ‰å­—ç¬¦å®šä½æ³•ï¼š \\dï¼šåŒ¹é…ä»»ä½•æ•°å­—ã€‚ \\sï¼šåŒ¹é…ä»»ä½•ç©ºç™½ç¬¦ï¼ˆå¦‚ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ç­‰ï¼‰ã€‚ [abc]ï¼šåŒ¹é… aã€b æˆ– cã€‚ [^abc]ï¼šåŒ¹é…é™¤ aã€b æˆ– c ä¹‹å¤–çš„ä»»ä½•å†…å®¹ã€‚ æ³¨æ„å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œåœ¨ä½¿ç”¨æ—¶ä»ç„¶è¦å¸¸å¸¸è¿›è¡ŒäºŒæ¬¡è½¬ä¹‰ã€‚ä¸è¿‡è¯´åˆ°è¿™é‡Œï¼Œæ¯”èµ·äºŒæ¬¡è½¬ä¹‰ï¼Œæœ‰å¾ˆå¤šäººè®¤ä¸ºä¸­æ‹¬å·è½¬ä¹‰ä¼šæ›´èˆ’æœï¼š abc &lt;- c(&quot;abc&quot;, &quot;a.c&quot;, &quot;a*c&quot;, &quot;a c&quot;) str_view(abc, &quot;a[.]c&quot;) #&gt; [2] â”‚ &lt;a.c&gt; str_view(abc, &quot;.[*]c&quot;) #&gt; [3] â”‚ &lt;a*c&gt; str_view(abc, &quot;a[ ]&quot;) #&gt; [4] â”‚ &lt;a &gt;c è¿™ç§æ–¹æ³•é€‚ç”¨äºå¤§å¤šæ•°æ­£åˆ™è¡¨è¾¾å¼å…ƒå­—ç¬¦ã€‚ä½†è¯·ä¸è¦è¿‡åº¦ä¾èµ–ï¼Œå› ä¸ºä»ç„¶æœ‰éƒ¨åˆ†ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ä¸ä¼šè¢«æ­£å¸¸ç¿»è¯‘è½¬ä¹‰ã€‚ æ­¤å¤–æˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ›¿ä»£æ¨¡å¼ä¹‹é—´é€‰æ‹©æ–¹æ¡ˆï¼Œå¦‚ï¼šabc|d..f å°†åŒ¹é… â€œabcâ€ æˆ– â€œdeafâ€ã€‚ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œ| çš„ä¼˜å…ˆçº§é€šå¸¸å¾ˆä½ï¼Œå› æ­¤ abc|xyz ä¼šåŒ¹é… â€œabcâ€ æˆ– â€œxyzâ€ï¼Œè€Œä¸æ˜¯ â€œabcyzâ€ æˆ– â€œabxyzâ€ã€‚ä¸æ•°å­¦è¡¨è¾¾å¼ä¸€æ ·ï¼Œå¦‚æœä¼˜å…ˆçº§å˜å¾—ä»¤äººå›°æƒ‘ï¼Œå°±è¯·ä½¿ç”¨æ‹¬å·æ¥æ˜ç¡®ä½ æƒ³è¦ä»€ä¹ˆï¼š str_view(c(&quot;grey&quot;, &quot;gray&quot;), &quot;gr(e|a)y&quot;) #&gt; [1] â”‚ &lt;grey&gt; #&gt; [2] â”‚ &lt;gray&gt; 15.2.4 é‡å¤åŒ¹é… é‡å¤åŒ¹é…ç”¨æ¥åŒ¹é…0ä¸ªã€ä¸€ä¸ªç”šè‡³å¤šä¸ªç›¸åŒçš„å†…å®¹ã€‚å…¶ä¸­ï¼š åŒ¹é…å­—ç¬¦ + ?ï¼š0 æˆ– 1 æ¬¡å­—ç¬¦åŒ¹é…ï¼ˆè¿™ä¸ªå­—ç¬¦å¯æœ‰å¯æ— ï¼‰ åŒ¹é…å­—ç¬¦ + +ï¼š1 æˆ–æ›´å¤šæ¬¡å­—ç¬¦åŒ¹é…ï¼ˆè¿™ä¸ªå­—ç¬¦å…è®¸å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼‰ åŒ¹é…å­—ç¬¦ + *ï¼š0 æˆ–æ›´å¤šæ¬¡å­—ç¬¦åŒ¹é…ï¼ˆè¿™ä¸ªå­—ç¬¦å¯èƒ½æ²¡æœ‰ï¼Œä¹Ÿå¯èƒ½æœ‰å¾ˆå¤šä¸ªï¼‰ æŸ¥æ‰¾ â€œCCâ€ æˆ–è€… â€œCâ€ ä¸²ï¼š x &lt;- &quot;1888 is the longest year in Roman numerals: MDCCCLXXXVIII&quot; str_view(x, &quot;CC?&quot;) #&gt; [1] â”‚ 1888 is the longest year in Roman numerals: MD&lt;CC&gt;&lt;C&gt;LXXXVIII æŸ¥æ‰¾ â€œCCâ€ æˆ–è€… â€œCCCâ€¦â€ ä¸²ï¼š str_view(x, &quot;CC+&quot;) #&gt; [1] â”‚ 1888 is the longest year in Roman numerals: MD&lt;CCC&gt;LXXXVIII æŸ¥æ‰¾ â€œCLâ€ã€â€œCXâ€ã€â€œCLXâ€ã€â€œCXLâ€ï¼Œæˆ–è€… â€œCLLLâ€¦â€ã€â€œCXXXâ€¦â€ã€â€œCLXXXâ€¦â€ã€â€œCLLLâ€¦Xâ€â€¦ str_view(x, &quot;C[LX]+&quot;) #&gt; [1] â”‚ 1888 is the longest year in Roman numerals: MDCC&lt;CLXXX&gt;VIII æ³¨æ„è¿™äº›è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å¾ˆé«˜ï¼Œå¹¶å¾ˆå¤šæ—¶å€™ä¼šç”¨äºåŒ¹é…ç¾å¼æˆ–è‹±å¼æ‹¼å†™ã€‚è¿™æ„å‘³ç€å¤§å¤šæ•°ç”¨é€”éƒ½éœ€è¦æ‹¬å·ï¼Œå¦‚ï¼šcolou?r æˆ– bana(na)+ æ­¤å¤–åœ¨æ•°é‡ä¸Šæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨è¯´æ˜ï¼š {n}ï¼šæ­£å¥½ n ä¸ª {n,}ï¼šn æˆ–æ›´å¤š {,m}ï¼š 0 åˆ° m ä¸ª {n,m}ï¼šä»‹äº n å’Œ m ä¸ªä¹‹é—´ str_view(x, &quot;C{2}&quot;) #&gt; [1] â”‚ 1888 is the longest year in Roman numerals: MD&lt;CC&gt;CLXXXVIII str_view(x, &quot;C{2,}&quot;) #&gt; [1] â”‚ 1888 is the longest year in Roman numerals: MD&lt;CCC&gt;LXXXVIII str_view(x, &quot;C{2,3}&quot;) #&gt; [1] â”‚ 1888 is the longest year in Roman numerals: MD&lt;CCC&gt;LXXXVIII åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœç¢°åˆ°äº†èƒ½åŒæ—¶åŒ¹é…åˆ°åŒä¸€ä¸ªç‚¹ä½çš„æƒ…å†µï¼ŒRegex ä¼šè‡ªåŠ¨é€‰æ‹©æœ€é•¿çš„ã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨ â€œ?â€ æ¥åå…¶é“è€Œè¡Œä¹‹ï¼š str_view(x, &quot;C{2,3}?&quot;) #&gt; [1] â”‚ 1888 is the longest year in Roman numerals: MD&lt;CC&gt;CLXXXVIII str_view(x, &quot;C[LX]+?&quot;) #&gt; [1] â”‚ 1888 is the longest year in Roman numerals: MDCC&lt;CL&gt;XXXVIII 15.3 å®é™…åº”ç”¨ åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šæ­£å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼éå¸¸å¼ºå¤§ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å€¾å‘äºå°è¯•ç”¨å•ä¸ªæ­£åˆ™è¡¨è¾¾å¼è§£å†³æ¯ä¸ªé—®é¢˜ã€‚ç”¨ Jamie Zawinski çš„è¯æ¥è¯´ï¼š Some people, when confronted with a problem, think â€œI know, Iâ€™ll use regular expressions.â€ Now they have two problems. æœ‰äº›äººåœ¨é¢å¯¹é—®é¢˜æ—¶ï¼Œä¼šè¿™æ ·æƒ³ï¼šâ€œæˆ‘çŸ¥é“ï¼Œæˆ‘ä¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚â€ é‚£ç°åœ¨ä»–ä»¬æœ‰ä¸¤ä¸ªå¤§é—®é¢˜ã€‚ æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæ£€æŸ¥ç”µå­é‚®ä»¶çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š (?:(?:\\r\\n)?[ \\t])*(?:(?:(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t] )+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?: \\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:( ?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*@(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\0 31]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\ ](?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+ (?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?: (?:\\r\\n)?[ \\t])*))*|(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z |(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n) ?[ \\t])*)*\\&lt;(?:(?:\\r\\n)?[ \\t])*(?:@(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\ r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n) ?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t] )*))*(?:,@(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])* )(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t] )+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*))*) *:(?:(?:\\r\\n)?[ \\t])*)?(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+ |\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r \\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?: \\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t ]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*@(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031 ]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\]( ?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(? :(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(? :\\r\\n)?[ \\t])*))*\\&gt;(?:(?:\\r\\n)?[ \\t])*)|(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(? :(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)? [ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)*:(?:(?:\\r\\n)?[ \\t])*(?:(?:(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]| \\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt; @,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot; (?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*@(?:(?:\\r\\n)?[ \\t] )*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\ &quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(? :[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[ \\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*))*|(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000- \\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|( ?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)*\\&lt;(?:(?:\\r\\n)?[ \\t])*(?:@(?:[^()&lt;&gt;@,; :\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([ ^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot; .\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\ ]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*))*(?:,@(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\ [\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\ r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\] |\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*))*)*:(?:(?:\\r\\n)?[ \\t])*)?(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\0 00-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\ .|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@, ;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(? :[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*))*@(?:(?:\\r\\n)?[ \\t])* (?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;. \\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t])*(?:[ ^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\] ]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*))*\\&gt;(?:(?:\\r\\n)?[ \\t])*)(?:,\\s*( ?:(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\ &quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:( ?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[ \\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t ])*))*@(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t ])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*)(? :\\.(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+| \\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*))*|(?: [^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\ ]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)*\\&lt;(?:(?:\\r\\n) ?[ \\t])*(?:@(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot; ()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n) ?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt; @,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*))*(?:,@(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@, ;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?:\\r\\n)?[ \\t] )*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\ &quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*))*)*:(?:(?:\\r\\n)?[ \\t])*)? (?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;. \\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t])*)(?:\\.(?:(?: \\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z|(?=[\\[ &quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|&quot;(?:[^\\&quot;\\r\\\\]|\\\\.|(?:(?:\\r\\n)?[ \\t]))*&quot;(?:(?:\\r\\n)?[ \\t]) *))*@(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t]) +|\\Z|(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*)(?:\\ .(?:(?:\\r\\n)?[ \\t])*(?:[^()&lt;&gt;@,;:\\\\&quot;.\\[\\] \\000-\\031]+(?:(?:(?:\\r\\n)?[ \\t])+|\\Z |(?=[\\[&quot;()&lt;&gt;@,;:\\\\&quot;.\\[\\]]))|\\[([^\\[\\]\\r\\\\]|\\\\.)*\\](?:(?:\\r\\n)?[ \\t])*))*\\&gt;(?:( ?:\\r\\n)?[ \\t])*))*)?;\\s*) è¿™ä¹ˆå˜æ€çš„ä¸œè¥¿å®Œå…¨ä¸èƒ½çœ‹ï¼ä¸è¿‡è¿™ç¡®å®å¯èƒ½ä¼šæ˜¯æˆ‘ä»¬å®é™…åœ¨å†™ä»£ç çš„æ—¶å€™ç”¨åˆ°çš„ä¸œè¥¿ï¼ˆæ‚² 15.3.1 åŒ¹é…æ£€æµ‹ å¦‚æœåªæ˜¯è¦ç¡®å®šå­—ç¬¦å‘é‡æ˜¯å¦ä¸æ¨¡å¼åŒ¹é…ï¼Œè¯·ä½¿ç”¨ str_detect() ã€‚å®ƒå°†è¿”å›ä¸è¾“å…¥é•¿åº¦ç›¸åŒçš„é€»è¾‘å‘é‡ï¼š fruit &lt;- c(&quot;apple&quot;, &quot;banana&quot;, &quot;pear&quot;) str_detect(fruit, &quot;e&quot;) #&gt; [1] TRUE FALSE TRUE ä¸è¿‡ç”±äº TRUE å’Œ FALSE åˆ†åˆ«ä»£è¡¨ 0 æˆ– 1ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ¥è®¡æ•°ï¼ˆwords æ˜¯è‡ªå¸¦çš„ä¸€å †æœ‰åºå•è¯ç»„æˆçš„å‘é‡ï¼‰ï¼š # How many common words start with t? sum(str_detect(words, &quot;^t&quot;)) #&gt; [1] 65 # What proportion of common words end with a vowel? mean(str_detect(words, &quot;[aeiou]$&quot;)) #&gt; [1] 0.2765306 äº‹å®ä¸Šï¼Œå½“æˆ‘ä»¬å…·æœ‰å¤æ‚çš„é€»è¾‘æ¡ä»¶ï¼ˆå¦‚åŒ¹é… a æˆ– bï¼Œä½†ä¸åŒ¹é… cï¼Œé™¤é dï¼‰ï¼Œé€šå¸¸æ›´å®¹æ˜“å°†å¤šä¸ªè°ƒç”¨ä¸é€»è¾‘è¿ç®—ç¬¦ç»„åˆåœ¨ä¸€èµ·ï¼Œè€Œä¸æ˜¯å°è¯•åˆ›å»ºå•ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚å¦‚åˆšåˆšçš„åŒ¹é…å…ƒéŸ³å­—æ¯ï¼š # æŸ¥æ‰¾æ‰€æœ‰åŒ…å«ä¸€ä¸ªå…ƒéŸ³çš„æ‰€æœ‰å•è¯å¹¶åå‘å¦å®š no_vowels_1 &lt;- !str_detect(words, &quot;[aeiou]&quot;) # æŸ¥æ‰¾æ‰€æœ‰ä»…ç”±è¾…éŸ³ç»„æˆçš„å•è¯ï¼ˆéå…ƒéŸ³å•è¯ï¼‰ no_vowels_2 &lt;- str_detect(words, &quot;^[^aeiou]+$&quot;) identical(no_vowels_1, no_vowels_2) # identical() ç”¨äºè¿”å›ä¸¤ä¸ªå†…å®¹æ˜¯å¦ç›¸åŒ #&gt; [1] TRUE å°½ç®¡ç»“æœæ˜¯ç›¸åŒçš„ï¼Œä½†æˆ‘è®¤ä¸ºç¬¬ä¸€ç§æ–¹æ³•æ›´å®¹æ˜“ç†è§£ã€‚å¦‚æœä½ çš„æ­£åˆ™è¡¨è¾¾å¼å˜å¾—è¿‡äºå¤æ‚ï¼Œè¯·å°è¯•å°†å…¶åˆ†è§£æˆæ›´å°çš„éƒ¨åˆ†ï¼Œä¸ºæ¯ä¸ªéƒ¨åˆ†å‘½åï¼Œç„¶åå°†è¿™äº›éƒ¨åˆ†ä¸é€»è¾‘è¿ç®—ç›¸ç»“åˆã€‚ words[str_detect(words, &quot;x$&quot;)] # é€‰æ‹©æ¨¡å¼ï¼Œè¿”å› T/Fï¼Œéœ€è¦ä¸­æ‹¬å·é€‰å‡ºå•è¯ #&gt; [1] &quot;box&quot; &quot;sex&quot; &quot;six&quot; &quot;tax&quot; str_subset(words, &quot;x$&quot;) # åŒ¹é…æ¨¡å¼ï¼Œè¿”å›åŒ¹é…åˆ°æˆåŠŸçš„å­å…ƒç´ ï¼ˆæ³¨æ„å¹¶ä¸æ˜¯é€‰å‡ºåŒ¹é…åˆ°çš„éƒ¨åˆ†å†…å®¹ï¼‰ #&gt; [1] &quot;box&quot; &quot;sex&quot; &quot;six&quot; &quot;tax&quot; ä½†æ˜¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œä½ è¦è¯†åˆ«çš„å­—ç¬¦ä¸²å¯èƒ½æ˜¯ dataframe æˆ– tibble çš„ä¸€åˆ—ã€‚æ‰€ä»¥æˆ‘ä»¬é€šå¸¸å¯¹è¿‡æ»¤å™¨ä¸‹æ‰‹ï¼š df &lt;- tibble( word = words, i = seq_along(word) # é’ˆå¯¹æŒ‡å®šåˆ—ç”Ÿæˆä¸€åˆ—åºå· ) df %&gt;% filter(str_detect(word, &quot;x$&quot;)) # è¿‡æ»¤ç­›é€‰ä»¥ x ç»“å°¾çš„å•è¯ï¼ˆå…ƒç´ ï¼‰ #&gt; # A tibble: 4 Ã— 2 #&gt; word i #&gt; &lt;chr&gt; &lt;int&gt; #&gt; 1 box 108 #&gt; 2 sex 747 #&gt; 3 six 772 #&gt; 4 tax 841 str_detect() çš„å˜ä½“æ˜¯ str_count()ã€‚å®ƒä¸æ˜¯ç®€å•çš„ yes æˆ– noï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªå‘é‡ï¼Œå‘Šè¯‰ä½ å­—ç¬¦ä¸²ä¸­æœ‰å¤šå°‘ä¸ªåŒ¹é…é¡¹ï¼š fruit &lt;- c(&quot;apple&quot;, &quot;banana&quot;, &quot;pear&quot;) str_count(fruit, &quot;a&quot;) #&gt; [1] 1 3 1 # æ±‚å¹³å‡æ¯ä¸ªå•è¯æœ‰å‡ ä¸ªå…ƒéŸ³ mean(str_count(words, &quot;[aeiou]&quot;)) #&gt; [1] 1.991837 ç”¨çš„å¥½å°±ä¼šéå¸¸è‡ªç„¶ï¼š df %&gt;% mutate( vowels = str_count(word, &quot;[aeiou]&quot;), consonants = str_count(word, &quot;[^aeiou]&quot;) ) #&gt; # A tibble: 980 Ã— 4 #&gt; word i vowels consonants #&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 a 1 1 0 #&gt; 2 able 2 2 2 #&gt; 3 about 3 3 2 #&gt; 4 absolute 4 4 4 #&gt; 5 accept 5 2 4 #&gt; 6 account 6 3 4 #&gt; 7 achieve 7 4 3 #&gt; 8 across 8 2 4 #&gt; 9 act 9 1 2 #&gt; 10 active 10 3 3 #&gt; # â€¦ with 970 more rows 15.3.2 æå–åŒ¹é…é¡¹ æå–åŒ¹é…é¡¹çš„å®é™…æ–‡æœ¬ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨ str_extract()ã€‚ä¸ºäº†å±•ç¤ºè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ã€‚è¿™é‡Œä½¿ç”¨å“ˆä½›å¥å­ï¼ˆHarvard sentencesï¼‰ stringr::sentencesï¼ˆå·²åŒ…å«åœ¨ tidyverseï¼‰ï¼Œè¿™äº›å¥å­æ—¨åœ¨æµ‹è¯• VOIP ç³»ç»Ÿï¼Œå€’æ˜¯å¯¹äºç»ƒä¹ æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ ¼å¤–æœ‰ç”¨ï¼š length(sentences) #&gt; [1] 720 head(sentences) #&gt; [1] &quot;The birch canoe slid on the smooth planks.&quot; #&gt; [2] &quot;Glue the sheet to the dark blue background.&quot; #&gt; [3] &quot;It&#39;s easy to tell the depth of a well.&quot; #&gt; [4] &quot;These days a chicken leg is a rare dish.&quot; #&gt; [5] &quot;Rice is often served in round bowls.&quot; #&gt; [6] &quot;The juice of lemons makes fine punch.&quot; æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬è¦æ‰¾åˆ°æ‰€æœ‰åŒ…å«é¢œè‰²çš„å¥å­ã€‚æˆ‘ä»¬é€‰æ‹©é¦–å…ˆåˆ›å»ºä¸€ä¸ªé¢œè‰²åç§°çš„å‘é‡ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºå•ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š colours &lt;- c(&quot;red&quot;, &quot;orange&quot;, &quot;yellow&quot;, &quot;green&quot;, &quot;blue&quot;, &quot;purple&quot;) colour_match &lt;- str_c(colours, collapse = &quot;|&quot;) colour_match #&gt; [1] &quot;red|orange|yellow|green|blue|purple&quot; ç„¶åæˆ‘ä»¬å¯ä»¥é€‰æ‹©åŒ…å«é¢œè‰²çš„å¥å­ï¼Œå¹¶æå–é¢œè‰²ä»¥ç¡®å®šå®ƒæ˜¯å“ªä¸€ç§ï¼š matches &lt;- str_subset(sentences, colour_match) %&gt;% # ç­›é€‰å‡ºå¸¦æœ‰é¢œè‰²çš„å¥å­ str_extract(colour_match) # æå–åŒ¹é…ä¸Šçš„å†…å®¹ head(matches) #&gt; [1] &quot;blue&quot; &quot;blue&quot; &quot;red&quot; &quot;red&quot; &quot;red&quot; &quot;blue&quot; ä½†éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬è¿™é‡Œä»…æå–äº†ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ã€‚é€šè¿‡é€‰æ‹©æ‰€æœ‰å…·æœ‰1ä¸ªä»¥ä¸ŠåŒ¹é…é¡¹çš„å¥å­ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°çœ‹åˆ°ï¼Œå…¶å®è¿™æ ·çš„æ•°æ®æœ‰ä¸å°‘ï¼š more &lt;- sentences[str_count(sentences, colour_match) &gt; 1] str_view_all(more, colour_match) # #&gt; Warning: `str_view()` was deprecated in stringr 1.5.0. #&gt; â„¹ Please use `str_view_all()` instead. #&gt; This warning is displayed once every 8 hours. #&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #&gt; generated. #&gt; [1] â”‚ It is hard to erase &lt;blue&gt; or &lt;red&gt; ink. #&gt; [2] â”‚ The &lt;green&gt; light in the brown box flicke&lt;red&gt;. #&gt; [3] â”‚ The sky in the west is tinged with &lt;orange&gt; &lt;red&gt;. å¯ä»¥æ˜æ˜¾çœ‹åˆ°ä¸€ä¸ªå¥å­åŒ¹é…åˆ°äº†å¤šä¸ªé¢œè‰²ã€‚ str_extract(more, colour_match) # ä½† stringr å®ƒçœŸå°±åªåŒ¹é…ä¸€ä¸ªã€‚ã€‚ #&gt; [1] &quot;blue&quot; &quot;green&quot; &quot;orange&quot; str_extract_all(more, colour_match) # ä½¿ç”¨ str_extract_all() è§£å†³é—®é¢˜ï¼ #&gt; [[1]] #&gt; [1] &quot;blue&quot; &quot;red&quot; #&gt; #&gt; [[2]] #&gt; [1] &quot;green&quot; &quot;red&quot; #&gt; #&gt; [[3]] #&gt; [1] &quot;orange&quot; &quot;red&quot; å¦‚æœæƒ³è¦ç”¨çŸ©é˜µè¡¨ç°ç»“æœçš„è¯ï¼Œsimplify é…ç½®é¡¹å¯èƒ½ä¼šå¾ˆæœ‰ç”¨ã€‚æ³¨æ„è¿”å›çš„çŸ©é˜µï¼Œè¡Œè¡¨ç¤ºå…ƒç´ ï¼Œåˆ—è¡¨ç¤ºåŒ¹é…åˆ°ç¬¬ä¸€æ¬¡ã€ç¬¬äºŒæ¬¡â€¦åˆ†åˆ«åŒ¹é…åˆ°çš„ç»“æœã€‚ x &lt;- c(&quot;a&quot;, &quot;a b&quot;, &quot;a b c&quot;) str_extract_all(x, &quot;[a-z]&quot;, simplify = TRUE) #&gt; [,1] [,2] [,3] #&gt; [1,] &quot;a&quot; &quot;&quot; &quot;&quot; #&gt; [2,] &quot;a&quot; &quot;b&quot; &quot;&quot; #&gt; [3,] &quot;a&quot; &quot;b&quot; &quot;c&quot; 15.4 åˆ†ç»„åŒ¹é… ä¾‹å¦‚ï¼Œæˆ‘æ˜¯è¯´å‡å¦‚ï¼Œæˆ‘ä»¬è¦ä»å¥å­ä¸­æå–åè¯ã€‚ä½œä¸ºå¯å‘å¼æ–¹æ³•ï¼Œæˆ‘ä»¬å°†æŸ¥æ‰¾ â€œaâ€ æˆ– â€œtheâ€ ä¹‹åçš„ä»»ä½•å•è¯ï¼Œå¹¶æ ‡è®°ä¸ºåè¯ã€‚åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å®šä¹‰ä¸€ä¸ª â€œå•è¯â€ å…¶å®è›®éº»çƒ¦çš„ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä½¿ç”¨ä¸€ä¸ªç®€å•çš„è¿‘ä¼¼æ–¹æ³•ï¼šè‡³å°‘ä¸æ˜¯ä¸€ä¸ªç©ºæ ¼ã€‚ noun &lt;- &quot;(a|the) ([^ ]+)&quot; has_noun &lt;- sentences %&gt;% str_subset(noun) # str_extract() ä¼šè¿›è¡Œå®Œæ•´åŒ¹é… has_noun %&gt;% str_extract(noun) %&gt;% head(10) #&gt; [1] &quot;the smooth&quot; &quot;the sheet&quot; &quot;the depth&quot; &quot;a chicken&quot; &quot;the parked&quot; #&gt; [6] &quot;the sun&quot; &quot;the huge&quot; &quot;the ball&quot; &quot;the woman&quot; &quot;a helps&quot; # str_match() åˆ™ä¼šæŒ‰ç»„ç»™å‡ºæ¯ä¸ªå•ç‹¬åŒ¹é…å†…å®¹ï¼›è¿”å›çŸ©é˜µ has_noun %&gt;% str_match(noun) %&gt;% head(10) #&gt; [,1] [,2] [,3] #&gt; [1,] &quot;the smooth&quot; &quot;the&quot; &quot;smooth&quot; #&gt; [2,] &quot;the sheet&quot; &quot;the&quot; &quot;sheet&quot; #&gt; [3,] &quot;the depth&quot; &quot;the&quot; &quot;depth&quot; #&gt; [4,] &quot;a chicken&quot; &quot;a&quot; &quot;chicken&quot; #&gt; [5,] &quot;the parked&quot; &quot;the&quot; &quot;parked&quot; #&gt; [6,] &quot;the sun&quot; &quot;the&quot; &quot;sun&quot; #&gt; [7,] &quot;the huge&quot; &quot;the&quot; &quot;huge&quot; #&gt; [8,] &quot;the ball&quot; &quot;the&quot; &quot;ball&quot; #&gt; [9,] &quot;the woman&quot; &quot;the&quot; &quot;woman&quot; #&gt; [10,] &quot;a helps&quot; &quot;a&quot; &quot;helps&quot; ä¸å‡ºæ‰€æ–™ï¼Œæˆ‘ä»¬æ£€æµ‹åè¯çš„å¯å‘å¼æ–¹æ³•å¾ˆæ‹‰å®ï¼Œå¹¶ä¸”è¿˜è·å–äº†åƒæ˜¯ smoothã€huge ç­‰å½¢å®¹è¯ã€‚ å¦‚æœä½ åœ¨è‡ªåŠ¨åŒ¹é…ä¸Šé‡åˆ°äº†å›°éš¾ï¼Œè¯•ç€ä½¿ç”¨ tidyr::extract() æ‰‹åŠ¨å¯¹æ¯”æŸ¥çœ‹å®ƒä»¬ã€‚å®ƒçš„å·¥ä½œæ–¹å¼ç±»ä¼¼äº str_match()ï¼Œä½†éœ€è¦æ‰‹åŠ¨å‘½ååŒ¹é…é¡¹ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨æ–°åˆ—ä¸­ï¼š tibble(sentence = sentences) %&gt;% tidyr::extract( sentence, c(&quot;article&quot;, &quot;noun&quot;), &quot;(a|the) ([^ ]+)&quot;, remove = FALSE ) #&gt; # A tibble: 720 Ã— 3 #&gt; sentence article noun #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 The birch canoe slid on the smooth planks. the smooth #&gt; 2 Glue the sheet to the dark blue background. the sheet #&gt; 3 It&#39;s easy to tell the depth of a well. the depth #&gt; 4 These days a chicken leg is a rare dish. a chicken #&gt; 5 Rice is often served in round bowls. &lt;NA&gt; &lt;NA&gt; #&gt; 6 The juice of lemons makes fine punch. &lt;NA&gt; &lt;NA&gt; #&gt; 7 The box was thrown beside the parked truck. the parked #&gt; 8 The hogs were fed chopped corn and garbage. &lt;NA&gt; &lt;NA&gt; #&gt; 9 Four hours of steady work faced us. &lt;NA&gt; &lt;NA&gt; #&gt; 10 A large size in stockings is hard to sell. &lt;NA&gt; &lt;NA&gt; #&gt; # â€¦ with 710 more rows 15.4.1 æ‹†åˆ† ç”¨äºå°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¥å­æ‹†åˆ†ä¸ºå•è¯ï¼š sentences %&gt;% head(5) %&gt;% str_split(&quot; &quot;) #&gt; [[1]] #&gt; [1] &quot;The&quot; &quot;birch&quot; &quot;canoe&quot; &quot;slid&quot; &quot;on&quot; &quot;the&quot; &quot;smooth&quot; #&gt; [8] &quot;planks.&quot; #&gt; #&gt; [[2]] #&gt; [1] &quot;Glue&quot; &quot;the&quot; &quot;sheet&quot; &quot;to&quot; &quot;the&quot; #&gt; [6] &quot;dark&quot; &quot;blue&quot; &quot;background.&quot; #&gt; #&gt; [[3]] #&gt; [1] &quot;It&#39;s&quot; &quot;easy&quot; &quot;to&quot; &quot;tell&quot; &quot;the&quot; &quot;depth&quot; &quot;of&quot; &quot;a&quot; &quot;well.&quot; #&gt; #&gt; [[4]] #&gt; [1] &quot;These&quot; &quot;days&quot; &quot;a&quot; &quot;chicken&quot; &quot;leg&quot; &quot;is&quot; &quot;a&quot; #&gt; [8] &quot;rare&quot; &quot;dish.&quot; #&gt; #&gt; [[5]] #&gt; [1] &quot;Rice&quot; &quot;is&quot; &quot;often&quot; &quot;served&quot; &quot;in&quot; &quot;round&quot; &quot;bowls.&quot; # ä½¿ç”¨ simplify é…ç½®é¡¹æ”¶ç¼©åˆ°ä¸€ä¸ªçŸ©é˜µ sentences %&gt;% head(5) %&gt;% str_split(&quot; &quot;, simplify = TRUE) #&gt; [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] #&gt; [1,] &quot;The&quot; &quot;birch&quot; &quot;canoe&quot; &quot;slid&quot; &quot;on&quot; &quot;the&quot; &quot;smooth&quot; &quot;planks.&quot; #&gt; [2,] &quot;Glue&quot; &quot;the&quot; &quot;sheet&quot; &quot;to&quot; &quot;the&quot; &quot;dark&quot; &quot;blue&quot; &quot;background.&quot; #&gt; [3,] &quot;It&#39;s&quot; &quot;easy&quot; &quot;to&quot; &quot;tell&quot; &quot;the&quot; &quot;depth&quot; &quot;of&quot; &quot;a&quot; #&gt; [4,] &quot;These&quot; &quot;days&quot; &quot;a&quot; &quot;chicken&quot; &quot;leg&quot; &quot;is&quot; &quot;a&quot; &quot;rare&quot; #&gt; [5,] &quot;Rice&quot; &quot;is&quot; &quot;often&quot; &quot;served&quot; &quot;in&quot; &quot;round&quot; &quot;bowls.&quot; &quot;&quot; #&gt; [,9] #&gt; [1,] &quot;&quot; #&gt; [2,] &quot;&quot; #&gt; [3,] &quot;well.&quot; #&gt; [4,] &quot;dish.&quot; #&gt; [5,] &quot;&quot; # é…ç½® n å¯ä»¥é™åˆ¶è¿”å›å‰å‡ ä¸ª fields &lt;- c(&quot;Name: Hadley&quot;, &quot;Country: NZ&quot;, &quot;Age: 35&quot;) fields %&gt;% str_split(&quot;: &quot;, n = 2, simplify = TRUE) #&gt; [,1] [,2] #&gt; [1,] &quot;Name&quot; &quot;Hadley&quot; #&gt; [2,] &quot;Country&quot; &quot;NZ&quot; #&gt; [3,] &quot;Age&quot; &quot;35&quot; é™¤äº†æŒ‰æ¨¡å¼æ‹†åˆ†å­—ç¬¦ä¸²ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ boundary() æŒ‰å­—ç¬¦ã€è¡Œã€å¥å­å’Œå•è¯è¿›è¡Œæ‹†åˆ†ï¼š x &lt;- &quot;This is a sentence. This is another sentence.&quot; str_view_all(x, boundary(&quot;word&quot;)) #&gt; [1] â”‚ &lt;This&gt; &lt;is&gt; &lt;a&gt; &lt;sentence&gt;. &lt;This&gt; &lt;is&gt; &lt;another&gt; &lt;sentence&gt;. 15.5 æ­£åˆ™è¡¨è¾¾å¼å…¶ä»–ç”¨æ³• ç”¨äºæŸ¥æ‰¾å…¨å±€ç¯å¢ƒä¸­æ‰€æœ‰å¯ç”¨çš„å¯¹è±¡ apropos()ï¼šå¦‚æœé‡Œä¸å¤ªè®°å¾—å‡½æ•°çš„åç§°ï¼Œè¿™å°†éå¸¸æœ‰ç”¨ã€‚ apropos(&quot;replace&quot;) #&gt; [1] &quot;%+replace%&quot; &quot;replace&quot; &quot;replace_na&quot; &quot;setReplaceMethod&quot; #&gt; [5] &quot;str_replace&quot; &quot;str_replace_all&quot; &quot;str_replace_na&quot; &quot;theme_replace&quot; åˆ—å‡ºç›®å½•ä¸­çš„æ‰€æœ‰æŒ‡å®šæ–‡ä»¶ dir()ï¼šè¯¥å‚æ•°é‡‡ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”ä»…è¿”å›ä¸æ¨¡å¼åŒ¹é…çš„æ–‡ä»¶åã€‚ head(dir(pattern = &quot;\\\\.Rmd$&quot;)) #&gt; [1] &quot;01-introduction.Rmd&quot; &quot;02-explore-intro.Rmd&quot; &quot;15-factors.Rmd&quot; #&gt; [4] &quot;22-model-intro.Rmd&quot; &quot;23-model-basics.Rmd&quot; &quot;24-model-building.Rmd&quot; "],["factors.html", "Chapter 16 Factors 16.1 åˆ›å»ºå› å­ 16.2 å¯¹ gss_cat æ•°æ®é›†ç ”ç©¶ 16.3 ä¿®æ”¹å› å­é¡ºåº 16.4 ç¼–è¾‘å› å­", " Chapter 16 Factors åœ¨ R ä¸­ï¼Œå› å­å¸¸å¸¸ç”¨äºå¤„ç†ç±»åˆ«å˜é‡ï¼Œå³ä¸€ç³»åˆ—çš„å¯¹äºå›ºå®šä¸”å·²çŸ¥å¯èƒ½å€¼çš„ç»„åˆ«å˜é‡ã€‚åŒæ ·çš„ï¼Œæƒ³è¦ä»¥éå­—æ¯é¡ºåºæ˜¾ç¤ºå­—ç¬¦å‘é‡æ—¶ï¼Œå®ƒä»¬ä¹ŸåŒæ ·å¾ˆæœ‰ç”¨ã€‚ library(tidyverse) 16.1 åˆ›å»ºå› å­ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«æœˆä»½çš„å‘é‡ x1ï¼š x1 &lt;- c(&quot;Dec&quot;, &quot;Apr&quot;, &quot;Jan&quot;, &quot;Mar&quot;) ç°åœ¨æˆ‘ä»¬è¦ç”¨æ¥æµ‹è¯•å› å­ã€‚è¦æ±‚è¦æ£€æŸ¥æœˆä»½æ˜¯å¦æ­£ç¡®ï¼Œæ’åºæ˜¯å¦æœ‰æ„ä¹‰ï¼š # åˆ›å»ºä¸€ä¸ªåˆå§‹å‘é‡ï¼Œå¹¶ä¿è¯å®ƒçš„å†…å®¹å’Œé¡ºåºæ˜¯æœ‰æ„ä¹‰çš„ month_levels &lt;- c( &quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;, &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot; ) # åˆ›å»ºå°† x1 â€œå› å­åŒ–â€ çš„å‘é‡ y1 y1 &lt;- factor(x1, levels = month_levels) y1 #&gt; [1] Dec Apr Jan Mar #&gt; Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec # æ­¤æ—¶å®ƒçš„æ’åºå°±æ˜¯æœ‰æ„ä¹‰çš„æ’åºäº† sort(y1) #&gt; [1] Jan Mar Apr Dec #&gt; Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec # ç›¸åŒçš„ï¼Œå¯¹äºå†…å®¹ä¹Ÿä¼šç”„åˆ«ï¼ŒåŒ¹é…ä¸ä¸Šçš„å†…å®¹ä¼šè¿”å› NA x2 &lt;- c(&quot;Dec&quot;, &quot;Apr&quot;, &quot;Jam&quot;, &quot;Mar&quot;) # Jan å†™é”™äº† y2 &lt;- factor(x2, levels = month_levels) y2 #&gt; [1] Dec Apr &lt;NA&gt; Mar #&gt; Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec å¯¹äºåŒ¹é…ä¸ä¸Šçš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ readr::parse_factor() æ›¿æ¢ factor() ä½¿å…¶å¼ºåˆ¶æŠ¥é”™ã€‚ è€Œ levels çš„çœç•¥åˆ™ä¼šä½¿ levels å‚æ•°è®¾ç½®æˆå› å­åŒ–çš„å‘é‡æœ¬èº«ã€‚ 16.2 å¯¹ gss_cat æ•°æ®é›†ç ”ç©¶ æ¥ä¸‹æ¥æˆ‘ä»¬å°†é‡ç‚¹ç ”ç©¶ forcats::gss_cat æ•°æ®é›†ã€‚è¿™æ˜¯ä¸€ä»½æ¥è‡ª ä¸€èˆ¬æ€§ç¤¾ä¼šè°ƒæŸ¥ çš„æ•°æ®æ ·æœ¬ï¼Œæ˜¯ç”±èŠåŠ å“¥å¤§å­¦ç‹¬ç«‹ç ”ç©¶æœºæ„ NORC è¿›è¡Œçš„ä¸€é¡¹é•¿æœŸçš„ç¾å›½è°ƒæŸ¥ã€‚è¯¥è°ƒæŸ¥åŒ…å«äº†æ•°åƒä¸ªé—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬å°†é€‰æ‹©å‡ ä¸ªé—®é¢˜ï¼Œç”¨äºè¯´æ˜æˆ‘ä»¬åœ¨å¤„ç†å› å­æ—¶å¯èƒ½ä¼šé‡åˆ°çš„ä¸€äº›å¸¸è§æŒ‘æˆ˜ã€‚ gss_cat #&gt; # A tibble: 21,483 Ã— 9 #&gt; year marital age race rincome partyid relig denom tvhours #&gt; &lt;int&gt; &lt;fct&gt; &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt; #&gt; 1 2000 Never married 26 White $8000 to 9999 Ind,near â€¦ Protâ€¦ Soutâ€¦ 12 #&gt; 2 2000 Divorced 48 White $8000 to 9999 Not str râ€¦ Protâ€¦ Baptâ€¦ NA #&gt; 3 2000 Widowed 67 White Not applicable Independeâ€¦ Protâ€¦ No dâ€¦ 2 #&gt; 4 2000 Never married 39 White Not applicable Ind,near â€¦ Orthâ€¦ Not â€¦ 4 #&gt; 5 2000 Divorced 25 White Not applicable Not str dâ€¦ None Not â€¦ 1 #&gt; 6 2000 Married 25 White $20000 - 24999 Strong deâ€¦ Protâ€¦ Soutâ€¦ NA #&gt; 7 2000 Never married 36 White $25000 or more Not str râ€¦ Chriâ€¦ Not â€¦ 3 #&gt; 8 2000 Divorced 44 White $7000 to 7999 Ind,near â€¦ Protâ€¦ Luthâ€¦ NA #&gt; 9 2000 Married 44 White $25000 or more Not str dâ€¦ Protâ€¦ Other 0 #&gt; 10 2000 Married 47 White $25000 or more Strong reâ€¦ Protâ€¦ Soutâ€¦ 3 #&gt; # â€¦ with 21,473 more rows å…ˆç¹ä¸ºå¿«ï¼æˆ‘ä»¬å…ˆç”»ä¸ª ggplot å›¾æ¥åº·åº·ï¼š ggplot(gss_cat, aes(race)) + geom_bar() + scale_x_discrete(drop = FALSE) # å¯¹ x è½´è¿›è¡Œè°ƒæ•´ï¼šç¦æ­¢ä¸¢å¼ƒæ²¡æœ‰æ•°æ®çš„ç»Ÿè®¡åˆ†ç±» 16.3 ä¿®æ”¹å› å­é¡ºåº æ¯«æ— ç–‘é—®ï¼Œåœ¨å¯è§†åŒ–ä¸­æ¨ªå‘æ›´æ”¹å› å­çš„é¡ºåºé€šå¸¸å¾ˆæœ‰ç”¨ã€‚å¦‚æˆ‘ä»¬è¦æ¢ç´¢ä¸åŒå®—æ•™æµæ´¾æ¯å¤©èŠ±åœ¨çœ‹ç”µè§†ä¸Šçš„å¹³å‡å°æ—¶æ•°ï¼š relig_summary &lt;- gss_cat %&gt;% group_by(relig) %&gt;% summarise( age = mean(age, na.rm = TRUE), # å¹³å‡å¹´é¾„ tvhours = mean(tvhours, na.rm = TRUE), # å¹³å‡çœ‹ç”µè§†æ—¶é•¿ n = n() # æµæ´¾äººæ•° ) ggplot(relig_summary, aes(tvhours, relig)) + geom_point() å¯æƒœï¼Œæˆ‘ä»¬å¾ˆéš¾è§£é‡Šè¿™ä¸ªå›¾çš„å†…åœ¨é€»è¾‘ï¼Œå› ä¸ºæˆ‘ä»¬å®Œå…¨æ²¡æœ‰ä¸€ä¸ªæ²¡æœ‰æ•´ä½“æ¨¡å¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ fct_reorder() å‡½æ•°ï¼Œä»¥ relig ä½œä¸ºå‚è€ƒæ¥æ”¹è¿›å®ƒã€‚æ³¨æ„è¿™ä¸ªå‡½æ•°éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼š fï¼šæƒ³è¦ä¿®æ”¹å…¶é¡ºåºçš„å› å­ã€‚ xï¼šç”¨äºé‡æ–°æ’åºçš„æ•°å­—å‚è€ƒå‘é‡ã€‚ funï¼šå¦‚æœ f çš„æ¯ä¸ªå€¼éƒ½æœ‰å¤šä¸ªå¯¹åº”çš„ x å€¼ï¼Œåˆ™ä½¿ç”¨è¯¥å‡½æ•°ï¼ˆç¼ºçœå€¼ä¸º medianï¼‰ã€‚ ggplot( relig_summary, # ä»¥ tvhours ä¸ºæ¨ªåæ ‡ï¼Œä»¥ é’ˆå¯¹ tvhours æ’åºè¿‡çš„ relig ä¸ºçºµåæ ‡ aes(tvhours, fct_reorder(relig, tvhours)) ) + geom_point() é‡æ–°æ’åºåå¯ä»¥æ›´æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œæµæ´¾ä¸º â€œä¸çŸ¥é“â€ çš„äººçœ‹ç”µè§†æ—¶é—´é€šå¸¸è¦æ¯”å…¶ä»–äººå¤šå¾—å¤šï¼Œè€Œå°åº¦æ•™å’Œå…¶ä»–ä¸œæ–¹å®—æ•™çœ‹ç”µè§†æ—¶é—´è¦å°‘å¾ˆå¤šã€‚åˆæ­¥åˆ¤æ–­å¯èƒ½ä¸ºï¼Œæ²¡æœ‰æµæ´¾å€¾å‘çš„äººæ›´éšæ€§ç”Ÿæ´»æ›´ä¸°å¯Œå¤šå½©ï¼Œè€Œå°åº¦æ•™æˆ–ä¸œæ–¹å®—æ•™çš„äººå¯èƒ½ä¹°ä¸èµ·ç”µè§†ã€‚ ä¸è¿‡è¿˜æ˜¯å»ºè®®ä¸è¦è¿‡åˆ†åœ°åœ¨ ggplot è¡¨è¾¾å¼é‡Œå¡ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„å¤„ç†ã€‚å¦‚æœä½ è¦è¿›è¡Œæ›´å¤æ‚çš„è½¬æ¢ï¼Œè¯·ä½¿ç”¨ mutateã€‚ relig_summary %&gt;% mutate(relig = fct_reorder(relig, tvhours)) %&gt;% ggplot(aes(tvhours, relig)) + geom_point() å¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç±»ä¼¼çš„å›¾ï¼Œçœ‹çœ‹ä¸åŒå¹´é¾„åœ¨æŠ¥å‘Šä¸Šçš„å¹³å‡æ”¶å…¥æ°´å¹³æ˜¯å¦‚ä½•å˜åŒ–çš„å‘¢ï¼Ÿ rincome_summary &lt;- gss_cat %&gt;% group_by(rincome) %&gt;% summarise( age = mean(age, na.rm = TRUE), tvhours = mean(tvhours, na.rm = TRUE), n = n() ) ggplot(rincome_summary, aes(age, fct_reorder(rincome, age))) + geom_point() å¥½å®¶ä¼™ã€‚è§„å¾‹æœ‰äº†ï¼Œä½†æ”¶å…¥å› å­çš„é¡ºåºä¹±äº†ã€‚è¿˜æ˜¯å°†æ”¶å…¥æŒ‰ç†æƒ³é¡ºåºæ’æ’å§ï¼š # å°† â€œNot applicableâ€ ä¸é€‚ç”¨åˆ†ç±»ä¼˜å…ˆçº§æåˆ°æœ€é«˜ã€‚å› ä¸ºä»–ä»¬çš„æ”¶å…¥ç”šè‡³è¿˜æ»¡è¶³ä¸äº†è¿™ä¸ªç»Ÿè®¡çš„æœ€ä½æ ‡å‡† ggplot(rincome_summary, aes(age, fct_relevel(rincome, &quot;Not applicable&quot;))) + geom_point() å½“ä½¿ç”¨ plot.fct_reorder2() ä¸ºå› å­é‡æ–°æ’åºæ—¶ï¼Œè¿™æ ·çš„å¦ä¸€ç§ç±»å‹çš„é‡æ–°æ’åºéå¸¸æœ‰ç”¨ã€‚è¿™ä½¿å¾—æƒ…èŠ‚æ›´å®¹æ˜“é˜…è¯»ï¼Œå› ä¸ºçº¿æ¡é¢œè‰²ä¸å›¾ä¾‹ç›¸ç¬¦ï¼Œéå¸¸ä¾¿äºå¯¹ç…§è§‚å¯Ÿã€‚ by_age &lt;- gss_cat %&gt;% filter(!is.na(age)) %&gt;% # å‰”é™¤ age ä¸º NA çš„è¡Œæ•°æ® count(age, marital) %&gt;% # ç»Ÿè®¡ä¸åŒå¹´é¾„ã€å©šå§»çš„äººæ•°æ•°æ® group_by(age) %&gt;% mutate(prop = n / sum(n)) # ä»¥å¹´é¾„åˆ†ç»„ï¼Œè®¡ç®—ä¸åŒå©šå§»çŠ¶å†µå è¯¥å¹´é¾„äººæ•°çš„æ¯”ä¾‹ ggplot(by_age, aes(age, prop, colour = marital)) + geom_line(na.rm = TRUE) ggplot(by_age, aes(age, prop, colour = fct_reorder2(marital, age, prop))) + geom_line() + labs(colour = &quot;marital&quot;) 16.4 ç¼–è¾‘å› å­ æ¯”æ›´æ”¹çº§åˆ«é¡ºåºæ›´å¼ºå¤§çš„è‡ªç„¶æ˜¯æ›´æ”¹å…¶å€¼ã€‚è¿™ä½¿æ‚¨å¯ä»¥é˜æ˜ç”¨äºå‘å¸ƒçš„æ ‡ç­¾ï¼Œä»¥åŠç”¨äºé«˜çº§æ˜¾ç¤ºçš„æŠ˜å çº§åˆ«ã€‚æœ€é€šç”¨å’Œæœ€å¼ºå¤§çš„å·¥å…·ä¾¿æ˜¯ fct_recode()ï¼Œå®ƒå…è®¸æˆ‘ä»¬é‡æ–°ç¼–ç æˆ–æ›´æ”¹æ¯ä¸ªçº§åˆ«çš„å€¼ã€‚å¦‚æˆ‘ä»¬å–gss_cat$partyidï¼š gss_cat %&gt;% count(partyid) #&gt; # A tibble: 10 Ã— 2 #&gt; partyid n #&gt; &lt;fct&gt; &lt;int&gt; #&gt; 1 No answer 154 #&gt; 2 Don&#39;t know 1 #&gt; 3 Other party 393 #&gt; 4 Strong republican 2314 #&gt; 5 Not str republican 3032 #&gt; 6 Ind,near rep 1791 #&gt; 7 Independent 4119 #&gt; 8 Ind,near dem 2499 #&gt; 9 Not str democrat 3690 #&gt; 10 Strong democrat 3490 # æ³¨æ„ç”¨è¯çš„æœºæ¢°æ€§å’Œå¯å¤ç”¨æ€§ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼š gss_cat %&gt;% mutate(partyid = fct_recode(partyid, &quot;Republican, strong&quot; = &quot;Strong republican&quot;, &quot;Republican, weak&quot; = &quot;Not str republican&quot;, &quot;Independent, near rep&quot; = &quot;Ind,near rep&quot;, &quot;Independent, near dem&quot; = &quot;Ind,near dem&quot;, &quot;Democrat, weak&quot; = &quot;Not str democrat&quot;, &quot;Democrat, strong&quot; = &quot;Strong democrat&quot; )) %&gt;% count(partyid) #&gt; # A tibble: 10 Ã— 2 #&gt; partyid n #&gt; &lt;fct&gt; &lt;int&gt; #&gt; 1 No answer 154 #&gt; 2 Don&#39;t know 1 #&gt; 3 Other party 393 #&gt; 4 Republican, strong 2314 #&gt; 5 Republican, weak 3032 #&gt; 6 Independent, near rep 1791 #&gt; 7 Independent 4119 #&gt; 8 Independent, near dem 2499 #&gt; 9 Democrat, weak 3690 #&gt; 10 Democrat, strong 3490 # åŒç†ï¼Œåˆå¹¶æ“ä½œåŒæ ·å¯è¡Œï¼š gss_cat %&gt;% mutate(partyid = fct_recode(partyid, &quot;Republican, strong&quot; = &quot;Strong republican&quot;, &quot;Republican, weak&quot; = &quot;Not str republican&quot;, &quot;Independent, near rep&quot; = &quot;Ind,near rep&quot;, &quot;Independent, near dem&quot; = &quot;Ind,near dem&quot;, &quot;Democrat, weak&quot; = &quot;Not str democrat&quot;, &quot;Democrat, strong&quot; = &quot;Strong democrat&quot;, &quot;Other&quot; = &quot;No answer&quot;, &quot;Other&quot; = &quot;Don&#39;t know&quot;, &quot;Other&quot; = &quot;Other party&quot; )) %&gt;% count(partyid) #&gt; # A tibble: 8 Ã— 2 #&gt; partyid n #&gt; &lt;fct&gt; &lt;int&gt; #&gt; 1 Other 548 #&gt; 2 Republican, strong 2314 #&gt; 3 Republican, weak 3032 #&gt; 4 Independent, near rep 1791 #&gt; 5 Independent 4119 #&gt; 6 Independent, near dem 2499 #&gt; 7 Democrat, weak 3690 #&gt; 8 Democrat, strong 3490 "],["model-intro.html", "Chapter 17 Introduction 17.1 è®¤çŸ¥", " Chapter 17 Introduction ç°åœ¨æˆ‘ä»¬å·²ç»é…å¤‡äº†å¼ºå¤§çš„ç¼–ç¨‹å·¥å…·ï¼Œç»ˆäºå¯ä»¥å›åˆ°å»ºæ¨¡äº†ã€‚ data-science-model æ¨¡å‹çš„ç›®æ ‡æ˜¯æä¾›æ•°æ®é›†çš„ç®€å•ä½ç»´æ‘˜è¦ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œè¯¥æ¨¡å‹å°†æ•è·çœŸæ­£çš„ â€œä¿¡å·â€ï¼ˆå³ç”±æ„Ÿå…´è¶£ç°è±¡äº§ç”Ÿçš„æ¨¡å¼ï¼‰ï¼Œå¹¶å¿½ç•¥ â€œå™ªå£°â€ï¼ˆå³æˆ‘ä»¬ä¸æ„Ÿå…´è¶£çš„éšæœºå˜åŒ–ï¼‰ã€‚ åœ¨æ¨¡å‹åŸºç¡€çŸ¥è¯†ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£æ¨¡å‹å¦‚ä½•å·¥ä½œï¼Œé‡ç‚¹ä»‹ç»é‡è¦çš„çº¿æ€§æ¨¡å‹ç³»åˆ—ã€‚ åœ¨æ¨¡å‹æ„å»ºä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨æ¨¡å‹åœ¨å®é™…æ•°æ®ä¸­æå–å·²çŸ¥æ¨¡å¼ã€‚ åœ¨è®¸å¤šæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨è®¸å¤šç®€å•æ¨¡å‹æ¥å¸®åŠ©ç†è§£å¤æ‚çš„æ•°æ®é›†ã€‚æ³¨æ„å­¦ä¹ æ—¶å¤šåŠ ç»“åˆå»ºæ¨¡å’Œç¼–ç¨‹å·¥å…·ã€‚ 17.1 è®¤çŸ¥ ä¼ ç»Ÿçš„æ¥è¯´ï¼Œå»ºæ¨¡çš„é‡ç‚¹æ˜¯æ¨ç†ï¼Œæˆ–ç¡®è®¤å‡è®¾æ˜¯æ­£ç¡®çš„ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å½¢æˆä¸¤ä¸ªå¿…è¦çš„è§‚å¿µï¼š æ¯ä¸ªè§‚æµ‹å€¼æ—¢å¯ä»¥ç”¨äºæ¢ç´¢ï¼Œä¹Ÿå¯ä»¥ç”¨äºç¡®è®¤ï¼Œè€Œä¸èƒ½ä¸¤è€…å…¼è€Œæœ‰ä¹‹ã€‚ æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦å¤šæ¬¡ä½¿ç”¨è§‚æµ‹å€¼è¿›è¡Œæ¢ç´¢ï¼Œä½†åªèƒ½ä½¿ç”¨ä¸€æ¬¡è¿›è¡Œç¡®è®¤ã€‚ä¸€æ—¦ä½¿ç”¨è§‚å¯Ÿç»“æœä¸¤æ¬¡ï¼Œæˆ‘ä»¬å°±ç®—å·²ç»ä»ç¡®è®¤åˆ‡æ¢åˆ°äº†æ¢ç´¢ã€‚ "],["model-basics.html", "Chapter 18 Model basics 18.1 å¯¹ sim1 æ¨¡å‹ç ”ç©¶ 18.2 å¯¹ sim2 æ¨¡å‹ç ”ç©¶ 18.3 å¯¹ sim3ï¼ˆåˆ†ç±»å˜é‡ï¼‰æ¨¡å‹ç ”ç©¶ 18.4 å¯¹ sim4ï¼ˆè¿ç»­ä¸”ç›¸äº’ä½œç”¨ï¼‰æ¨¡å‹ç ”ç©¶ 18.5 å¯¹ sim5ï¼ˆæ¨¡å‹è½¬æ¢ï¼‰æ¨¡å‹ç ”ç©¶ 18.6 å…¶ä»–å¸¸è§çº¿æ€§æ¨¡å‹", " Chapter 18 Model basics æ¨¡å‹ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š å®šä¹‰ä¸€ç³»åˆ—æ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹è¡¨ç¤ºè¦æ•è·çš„ç²¾ç¡®ä½†é€šç”¨çš„æ¨¡å¼ã€‚ é€šè¿‡ä»æœ€æ¥è¿‘æ•°æ®é›†ä¸­æŸ¥æ‰¾æ¨¡å‹æ¥ç”Ÿæˆæ‹Ÿåˆæ¨¡å‹ã€‚è¿™å°†é‡‡ç”¨é€šç”¨æ¨¡å‹ç³»åˆ—ï¼Œå¹¶ä½¿å…¶å…·ä½“åŒ–ã€‚ library(tidyverse) library(modelr) options(na.action = na.warn) 18.1 å¯¹ sim1 æ¨¡å‹ç ”ç©¶ 18.1.1 ç®€å•å»ºç«‹ sim1 æ¨¡å‹ ggplot(sim1, aes(x, y)) + geom_point() ç”±å›¾å¯ä»¥å‘ç°ï¼Œx å˜é‡å’Œ y å˜é‡å¯èƒ½æœ‰æ˜æ˜¾çº¿æ€§å…³ç³»ã€‚ random_models &lt;- tibble( # éšæœºç”Ÿæˆ 250 ä¸ªä¸Šé™ -20 ä¸‹é™ 40 çš„ a1 å‘é‡ a1 = runif(n = 250, min = -20, max = 40), # åŒç†éšæœºç”Ÿæˆ 250 ä¸ªä¸Šé™ -5 ä¸‹é™ 5 çš„ a2 å‘é‡ a2 = runif(250, -5, 5) ) å¦‚æœç”¨éšæœºç”Ÿæˆæ•°æ®çš„è¯ï¼Œæ¨¡å‹ä¼šçœ‹èµ·æ¥éå¸¸ç³Ÿç³•ï¼š ggplot() + geom_abline( data = random_models, mapping = aes(intercept = a1, slope = a2), # interceptï¼šæˆªè·ï¼Œslopeï¼šæ–œç‡ alpha = 1 / 4 ) + geom_point( data = sim1, mapping = aes(x, y) ) æˆ‘ä»¬å¸Œæœ›æœ‰ç›´çº¿ y = a2*x + a1 æ¥æ¦‚æ‹¬è¿™ä¸ªæ•°æ®é›†çš„ç‰¹å¾ã€‚æ‰€ä»¥æˆ‘ä»¬åˆ›é€ äº† model1ï¼š model1 &lt;- function(a, data) { # æ³¨æ„æˆ‘ä»¬ä¼ å…¥çš„ data æ˜¯ä¸€ä¸ªæ•°æ®é›†ã€‚è¿™ä¸ªè®¾è®¡çš„å‡½æ•°ä¼šé’ˆå¯¹æ•°æ®é›†é‡Œçš„æ•°æ®åå¤ä»£å…¥è®¡ç®—ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªå‘é‡ a[1] + data$x * a[2] } è¯•å›¾ç”¨ a1 = 7 å’Œ a2 = 1.5 æ•°æ®æ¥åˆ†æ sim1ã€‚è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†ç†æƒ³æ¨¡å‹ä¸‹å¯¹åº” y çš„å€¼ model1(c(7, 1.5), sim1) #&gt; [1] 8.5 8.5 8.5 10.0 10.0 10.0 11.5 11.5 11.5 13.0 13.0 13.0 14.5 14.5 14.5 #&gt; [16] 16.0 16.0 16.0 17.5 17.5 17.5 19.0 19.0 19.0 20.5 20.5 20.5 22.0 22.0 22.0 éªŒè¯æˆ–è€…æ±‚å¾—å›å½’æ›²çº¿çš„æ‹Ÿåˆåº¦ä½¿æˆ‘ä»¬é€šå¸¸é‡‡ç”¨æ–¹å·®ï¼Œåº¦é‡éšæœºå˜é‡å’Œå…¶æ•°å­¦æœŸæœ›ï¼ˆå³å‡å€¼ï¼‰ä¹‹é—´çš„åç¦»ç¨‹åº¦ã€‚æ‰€ä»¥æˆ‘ä»¬æ–°å»ºäº†å‡½æ•°æ¥è·å¾—æ–¹å·®ï¼š measure_distance &lt;- function(mod, data) { diff &lt;- data$y - model1(mod, data) # diff ä¸º data ä¸­å®é™… y å€¼ä¸ model1 å¾—åˆ°çš„ç†æƒ³ y å€¼çš„å·® sqrt(mean(diff^2)) # è¿”å›æ‰€æœ‰ diff å¹³æ–¹çš„å‡å€¼è¿›è¡Œçš„å¼€æ–¹ï¼ˆæ–¹å·®ï¼‰ } # è¯•å›¾ç”¨ a1 = 7 å’Œ a2 = 1.5 æ•°æ®æ±‚å¾—å…³äº sim1 çš„æ–¹å·® measure_distance(c(7, 1.5), sim1) #&gt; [1] 2.665212 ç”±äºæˆ‘ä»¬è¿™é‡Œä»…ç”¨æ¥ç ”ç©¶ sim1 æ•°æ®é›†ï¼Œæ‰€ä»¥è¿™é‡Œæ–°å»ºå‡½æ•°ç”¨æ¥æäº¤ç»™ sim1ï¼Œæ–¹ä¾¿åé¢ map2_dbl å¤„ç†ï¼š sim1_dist &lt;- function(a1, a2) { measure_distance(c(a1, a2), sim1) # nolint } # é€šè¿‡ mutate æ–°å¢è®¡ç®—å¾—åˆ°çš„åˆ— dist å¹¶èµ‹å€¼å›å»ï¼ˆæ–¹å·®ï¼‰ models &lt;- random_models %&gt;% mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist)) models #&gt; # A tibble: 250 Ã— 3 #&gt; a1 a2 dist #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 -19.6 -1.61 45.3 #&gt; 2 27.6 1.93 22.8 #&gt; 3 21.9 2.76 21.8 #&gt; 4 -1.81 1.91 7.13 #&gt; 5 4.87 -1.71 22.9 #&gt; 6 9.82 3.90 16.8 #&gt; 7 12.1 -3.63 28.5 #&gt; 8 20.8 3.73 26.3 #&gt; 9 16.6 -3.89 26.5 #&gt; 10 28.3 0.642 17.0 #&gt; # â€¦ with 240 more rows æ³¨æ„è¿™é‡Œçš„ map2_dbl ä¼šè¿”å›ç¦»æ•£ç¨‹åº¦è¾ƒå°çš„ï¼Œå³æ‹Ÿåˆç¨‹åº¦æœ€é«˜çš„ã€‚ä¾‹å¦‚ï¼š df &lt;- data.frame( x = c(1, 2, 5), y = c(5, 4, 8) ) # è¿™ä¸ªåŒ…çš„ map2_dbl è¡¨è¾¾å¼ç›¸å½“äº pmin(df$x, df$y) purrr::map2_dbl(df$x, df$y, min) #&gt; [1] 1 2 5 æœ€åå°†å®é™…å¾—åˆ°çš„æ¨¡å‹ç®€å•ç›´è§‚åœ°å±•ç¤ºå‡ºæ¥ï¼š ggplot(sim1, aes(x, y)) + geom_point(size = 2, colour = &quot;grey30&quot;) + geom_abline( aes(intercept = a1, slope = a2, colour = -dist), # ç”± dist åå‘ä¸Šè‰²ï¼Œå³è¶Šç²¾ç¡®é¢œè‰²è¶Šé²œäº® data = filter(models, rank(dist) &lt;= 10) # ä¸æ˜¯æ‰€æœ‰çº¿æ¡éƒ½éœ€è¦æ˜¾ç¤ºï¼Œè¿™é‡Œé€‰æ‹© dist æ’åå‰ 10 ) # å°† a1 å’Œ a2 ç”¨å›¾è¡¨ç¤ºå‡ºæ¥ï¼ˆåŒæ ·ä¸Šè‰²ï¼‰ï¼Œè¿™é‡Œé€‰æ‹© dist æ’åå‰ 10 æ¥é«˜äº®æ˜¾ç¤ºï¼ˆå åŠ ï¼‰ ggplot(models, aes(a1, a2)) + geom_point( data = filter(models, rank(dist) &lt;= 10), # å…ˆç”»é«˜äº®éƒ¨åˆ† size = 4, colour = &quot;red&quot; ) + geom_point(aes(colour = -dist)) äº‹å®ä¸Šé™¤äº†ç”¨ runif åˆ›å»ºéšæœºæ¨¡å‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¸¸å¸¸ä½¿ç”¨æ ‡å‡†æ­¥é•¿çš„è§„æ•´çŸ©é˜µæ•°æ®æ¨¡å‹æ¥éªŒç®—å·²çŸ¥çš„å›å½’æ¨¡å‹ï¼š grid_models &lt;- expand.grid( # expand.grid ç”¨äºäºå¿«é€Ÿåˆ›å»ºæ•°æ®é›†ï¼ˆdata frameæ ¼å¼ï¼‰ a1 = seq(-5, 20, length = 25), # seq ç”¨äºå¿«é€Ÿç”Ÿæˆåºåˆ—ï¼Œå‚æ•°åˆ†åˆ«ä»£è¡¨èµ·å§‹ã€ç»“æŸå’Œåºåˆ—é•¿ a2 = seq(1, 3, length = 25) ) %&gt;% mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist)) ggplot(grid_models, aes(a1, a2)) + geom_point( data = filter(grid_models, rank(dist) &lt;= 10), size = 4, colour = &quot;red&quot; ) + geom_point(aes(colour = -dist)) åŒæ ·ï¼Œæˆ‘ä»¬æŠŠæ‹Ÿåˆå‡ºçš„å›å½’æ¨¡å‹æ”¾åˆ°åŸå§‹æ•°æ®é›†å¯¹ç…§ï¼Œäº‹å®å‘Šè¯‰æˆ‘ä»¬æ‹Ÿåˆçš„æ•ˆæœéå¸¸å¥½ï¼š ggplot(sim1, aes(x, y)) + geom_point(size = 2, colour = &quot;grey30&quot;) + geom_abline( aes(intercept = a1, slope = a2, colour = -dist), data = filter(grid_models, rank(dist) &lt;= 10) ) å½“ç„¶è¿™å¯¹ a1ã€a2 æ•°æ®æ˜¯æˆ‘ä»¬æ ¹æ®çŸ©é˜µæ•°æ®é›†æ‹Ÿåˆå¾—åˆ°çš„ã€‚æˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡å¤§è‡´æ‹Ÿåˆåº¦ï¼Œç»§ç»­ç»†åŒ–æ•°æ®ã€‚è¿™æ ·å·²çŸ¥ç»†åŒ–ä¸‹å»ï¼Œæˆ‘ä»¬ç»ˆç©¶å¾—åˆ°æ‹Ÿåˆåº¦æé«˜çš„æ•°æ®ã€‚ æ‰€ä»¥æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªåä¸ºç‰›é¡¿-æ‹‰å¤«æ£®æœç´¢çš„æ•°å­—æœ€å°åŒ–å·¥å…·ã€‚ç‰›é¡¿-æ‹‰å¤«æ£®å·¥å…·çš„æ€æƒ³å¾ˆç®€å•ï¼šä½ é€‰æ‹©ä¸€ä¸ªèµ·ç‚¹ï¼Œç¯é¡¾å››å‘¨æœ€é™¡å³­çš„æ–œå¡ã€‚ç„¶åï¼Œä½ æ²¿ç€æ–œå¡æ»‘äº†ä¸€ç‚¹ï¼Œç„¶åä¸€éåˆä¸€éåœ°é‡å¤ï¼Œç›´åˆ°ä½ ä¸èƒ½å†ä½äº†ã€‚ åœ¨ R ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ optim() åšåˆ°è¿™ä¸€ç‚¹ï¼š best &lt;- optim( par = c(0, 0), # è¦ä¼˜åŒ–çš„å‚æ•°çš„åˆå§‹å€¼ fn = measure_distance, # è¦æœ€å°åŒ–ï¼ˆæˆ–æœ€å¤§åŒ–ï¼‰çš„å‡½æ•°ï¼Œæ‰€ä»¥ par å‚æ•°æ˜¯è¦è¿›è¡Œæœ€å°åŒ–çš„å‚æ•°å‘é‡ã€‚å®ƒåº”è¯¥è¿”å›æ ‡é‡ç»“æœ data = sim1 ) æ³¨æ„ optm() å°†è¿”å›ä¸€ä¸ª listï¼Œå…¶ä¸­ par ä¸ºæ‰¾åˆ°çš„æœ€ä½³å‚æ•°å‘é‡ï¼Œvalue ä¸ºå‚æ•°å‘é‡å¯¹åº”çš„è¿”å›å€¼ï¼š best$par #&gt; [1] 4.222248 2.051204 æˆ‘ä»¬ç”»å›¾éªŒè¯ä¸€ä¸‹åˆšåˆšå¾—åˆ°çš„ a1 å’Œ a2ã€‚ç›¸åº”çš„ï¼Œå®ƒçš„æ‹Ÿåˆç¨‹åº¦ä¹Ÿç›¸å½“å®Œç¾ï¼š ggplot(sim1, aes(x, y)) + geom_point(size = 2, colour = &quot;grey30&quot;) + geom_abline(intercept = best$par[1], slope = best$par[2], colour = &quot;blue&quot;) çº¿æ€§æ¨¡å‹çš„ä¸€èˆ¬å½¢å¼ä¸º y = a_1 + a_2 * x_1 + a_3 * x_2 + â€¦ + a_n * x_(n - 1)ã€‚åœ¨ R é‡Œæœ‰ä¸€ä¸ªä¸“é—¨ä¸ºæ‹Ÿåˆçº¿æ€§æ¨¡å‹è€Œè®¾è®¡çš„å·¥å…· lm()ã€‚ lm() ç”¨ä¸€ç§ç‰¹æ®Šçš„æ–¹å¼æ¥æŒ‡å®šæ¨¡å‹ï¼Œå³å…¬å¼ã€‚å…¬å¼ä¾‹å¦‚ y ~ xï¼Œlm() å°†è‡ªåŠ¨è½¬æ¢ä¸º y = a_1 + a_2 * x è¿™æ ·çš„å‡½æ•°ï¼š sim1_mod &lt;- lm(y ~ x, data = sim1) # ç»“æœä¸é¢„æœŸå®Œå…¨ä¸€è‡´ coef(sim1_mod) # coef() æ˜¯ä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œç”¨äºä»å»ºæ¨¡å‡½æ•°è¿”å›çš„å¯¹è±¡ä¸­æå–æ¨¡å‹ç³»æ•° #&gt; (Intercept) x #&gt; 4.220822 2.051533 18.1.2 å¯¹ sim1 æ¨¡å‹å¯è§†åŒ–è§‚å¯Ÿåˆ†æ ç°åœ¨æˆ‘ä»¬å°†é€šè¿‡æŸ¥çœ‹æ¨¡å‹çš„é¢„æµ‹æ¥ä¸“æ³¨äºç†è§£æ¨¡å‹ã€‚æ¯ç§ç±»å‹çš„é¢„æµ‹æ¨¡å‹éƒ½éœ€è¦è¿›è¡Œé¢„æµ‹ã€‚æŸ¥çœ‹æ¨¡å‹æœªæ•è·çš„å†…å®¹ï¼ˆå³ä»æ•°æ®ä¸­å‡å»é¢„æµ‹å€¼åç•™ä¸‹çš„æ‰€è°“æ®‹å·®ï¼‰ä¹Ÿå¾ˆæœ‰ç”¨ã€‚æˆ‘ä»¬å¯ä»¥ç”¨æ¥ç ”ç©¶å‰©ä½™çš„æ›´å¾®å¦™çš„è¶‹åŠ¿ã€‚ 18.1.2.1 åˆ†æé¢„æµ‹æ•°æ® ä¸ºäº†æ¨¡å‹çš„é¢„æµ‹ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºç½‘æ ¼ï¼Œå…¶æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ data_grid() å‡½æ•°ï¼š grid &lt;- sim1 %&gt;% # ç›¸å½“äºå¯¹ sim1 å®šåˆ¶å¯¹åº”çš„ x æ•°æ®é›† data_grid(x) grid #&gt; # A tibble: 10 Ã— 1 #&gt; x #&gt; &lt;int&gt; #&gt; 1 1 #&gt; 2 2 #&gt; 3 3 #&gt; 4 4 #&gt; 5 5 #&gt; 6 6 #&gt; 7 7 #&gt; 8 8 #&gt; 9 9 #&gt; 10 10 æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹é¢„æµ‹ã€‚è¯·æ³¨æ„ sim1_mod æ¥è‡ªä¹‹å‰ lm() å‡½æ•°ç”Ÿæˆçš„ä»£ç ï¼š #&gt; sim1_mod &lt;- lm(y ~ x, data = sim1) predictions &lt;- grid %&gt;% add_predictions(sim1_mod) predictions #&gt; # A tibble: 10 Ã— 2 #&gt; x pred #&gt; &lt;int&gt; &lt;dbl&gt; #&gt; 1 1 6.27 #&gt; 2 2 8.32 #&gt; 3 3 10.4 #&gt; 4 4 12.4 #&gt; 5 5 14.5 #&gt; 6 6 16.5 #&gt; 7 7 18.6 #&gt; 8 8 20.6 #&gt; 9 9 22.7 #&gt; 10 10 24.7 æœ€åç»˜åˆ¶é¢„æµ‹ç»“æœï¼š ggplot(sim1, aes(x)) + geom_point(aes(y = y)) + geom_line(aes(y = pred), data = predictions, colour = &quot;red&quot;, size = 1) #&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. #&gt; â„¹ Please use `linewidth` instead. #&gt; This warning is displayed once every 8 hours. #&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #&gt; generated. 18.1.2.2 åˆ†ææ®‹å·® æ®‹å·®æ˜¯æˆ‘ä»¬çš„é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„è·ç¦»ï¼š residuals &lt;- sim1 %&gt;% # æ³¨æ„è¿™é‡Œä½¿ç”¨çš„å‚æ•°æ˜¯ sim1ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åŸå§‹æ•°æ®é›†æ‰èƒ½å‘ç°æ®‹å·® add_residuals(sim1_mod) # ç”¨æ³•ä¸ add_predictions() éå¸¸ç›¸ä¼¼ residuals #&gt; # A tibble: 30 Ã— 3 #&gt; x y resid #&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 4.20 -2.07 #&gt; 2 1 7.51 1.24 #&gt; 3 1 2.13 -4.15 #&gt; 4 2 8.99 0.665 #&gt; 5 2 10.2 1.92 #&gt; 6 2 11.3 2.97 #&gt; 7 3 7.36 -3.02 #&gt; 8 3 10.5 0.130 #&gt; 9 3 10.5 0.136 #&gt; 10 4 12.4 0.00763 #&gt; # â€¦ with 20 more rows æœ€åç»˜åˆ¶æ®‹å·®å…³äº x çš„å›¾ï¼š ggplot(residuals, aes(resid)) + # geom_freqpoly å³é¢‘ç‡å¤šè¾¹å½¢ï¼Œéå¸¸é€‚åˆæ¨¡ç³ŠåŒ–åœ°ç»˜åˆ¶è¡¨ç°ä¸€ä¸ªå‘é‡çš„æ•°æ®çš„å¤§å°å’Œå‡ºç°æ¬¡æ•° geom_freqpoly(binwidth = 0.5) # æˆ–è€…åŠ å…¥æ•°æ® x æ¥çœ‹åˆ°æ›´å¤šçš„æ•°æ®ã€‚å¾ˆå®¹æ˜“å‘ç°å®ƒçš„åˆ†å¸ƒéå¸¸å®Œç¾ï¼š ggplot(residuals, aes(x, resid)) + geom_ref_line(h = 0) + # è°ƒæ•´åŸºçº¿ä¸º 0 è€Œä¸æ˜¯æœ€å° geom_point(aes(colour = -abs(resid))) 18.2 å¯¹ sim2 æ¨¡å‹ç ”ç©¶ 18.2.1 å…³äº model_matrix() è¦æƒ³æå–å…³é”®è‡ªå®šä¹‰å˜é‡çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ model_matrix() å‡½æ•°ã€‚å¦‚ï¼š df &lt;- tribble( ~y, ~x1, ~x2, 4, 2, 5, 5, 1, 6 ) model_matrix(df, y ~ x1) #&gt; # A tibble: 2 Ã— 2 #&gt; `(Intercept)` x1 #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 2 #&gt; 2 1 1 # å¦‚æœæ·»åŠ å…¶ä»–å˜é‡ï¼š model_matrix(df, y ~ x1 + x2) #&gt; # A tibble: 2 Ã— 3 #&gt; `(Intercept)` x1 x2 #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 2 5 #&gt; 2 1 1 6 # R å°†æˆªè·æ·»åŠ åˆ°æ¨¡å‹çš„æ–¹å¼æ˜¯ç›´æ¥å¡«å……åä¸ºæˆªè·çš„åˆ—ï¼ˆå½“ç„¶è¿™ä¸ªåˆ—å¡«å……å‰çš„å€¼æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼‰ã€‚ # é»˜è®¤æ·»åŠ ã€‚å¦‚æœä¸éœ€è¦ï¼Œä½¿ç”¨ â€œ-1â€ å‘½ä»¤æ˜¾å¼åˆ é™¤å®ƒï¼š model_matrix(df, y ~ x1 + x2 - 1) #&gt; # A tibble: 2 Ã— 2 #&gt; x1 x2 #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2 5 #&gt; 2 1 6 å¯¹äºåˆ†ç±»å˜é‡ï¼Œå°¤å…¶æ˜¯åˆ†ç±»ä¸ºå­—ç¬¦çš„ï¼šæƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ª tibble æ•°æ®é›†ï¼Œå…¶ä¸­æ€§åˆ«å¯ä»¥æ˜¯ç”·æ€§æˆ–å¥³æ€§ã€‚å°†å…¶è½¬æ¢ä¸ºåˆå§‹æ•°æ®æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºä¸æ˜¯æ•°å­— â€”â€” ä½ ä¸èƒ½ç®€å•åœ°è®¡ç®—å®ƒï¼ df &lt;- tribble( ~sex, ~response, &quot;male&quot;, 1, &quot;female&quot;, 2, &quot;male&quot;, 1 ) # å¯ä»¥çœ‹åˆ°å‡½æ•°ä¼šè‡ªåŠ¨å°†è‡ªå˜é‡çš„ååä¸º â€œåˆ—â€ â€œæŸç§å€¼â€ï¼Œå…¶æ•°æ®ç”¨æ¥è¡¨ç¤ºè¯¥åˆ—æ•°æ®æ˜¯å¦æ˜¯æŒ‡å®šçš„ â€œæŸç§å€¼â€ï¼š model_matrix(df, response ~ sex) #&gt; # A tibble: 3 Ã— 2 #&gt; `(Intercept)` sexmale #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 1 #&gt; 2 1 0 #&gt; 3 1 1 å¯¹äº sim2ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨ ggplot() è¿›è¡Œå¯è§†åŒ–è§‚å¯Ÿï¼š ggplot(sim2) + geom_point(aes(x, y)) åŒç†æˆ‘ä»¬å¯ä»¥å¯¹ sim2 æ•°æ®é›†ä¹Ÿè¿™æ ·å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºåˆå§‹æ•°æ®å¹¶é¢„æµ‹ï¼š mod2 &lt;- lm(y ~ x, data = sim2) # äº§ç”Ÿç†æƒ³çº¿æ€§å›å½’æ¨¡å‹ æ³¨æ„å›å½’æ¨¡å‹ä¸­æ¯ä¸ª x çš„åˆ†ç±»å¯¹åº”ä¸€ä¸ª â€œæ–œç‡â€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ª x çš„ æŸå€¼åœ¨æ¨¡å‹ä¸Šåªä¼šå¯¹åº”ä¸€ä¸ªå€¼ï¼Œå³å¹³å‡å€¼ï¼š grid2 &lt;- sim2 %&gt;% data_grid(x) %&gt;% # äº§ç”Ÿåˆå§‹æ•°æ® add_predictions(mod2) # ä¾æ®åˆå§‹æ•°æ®å¯¹æ¨¡å‹è¿›è¡Œé¢„æµ‹ grid2 #&gt; # A tibble: 4 Ã— 2 #&gt; x pred #&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 a 1.15 #&gt; 2 b 8.12 #&gt; 3 c 6.13 #&gt; 4 d 1.91 æˆ‘ä»¬å¯¹ç†æƒ³æ¨¡å‹ä¸åŸå§‹æ•°æ®å åŠ è¿›è¡Œå¯è§†åŒ–ï¼š ggplot(sim2, aes(x)) + geom_point(aes(y = y)) + geom_point(data = grid2, aes(y = pred), colour = &quot;red&quot;, size = 4) 18.3 å¯¹ sim3ï¼ˆåˆ†ç±»å˜é‡ï¼‰æ¨¡å‹ç ”ç©¶ sim3 åŒæ—¶åŒ…å« x1 çš„æ•°å€¼å’Œ x2 çš„å­—æ¯åˆ†ç±»ï¼š ggplot(sim3, aes(x1, y)) + geom_point(aes(colour = x2)) ç”±äºå¹¶ä¸çŸ¥é“ x1 å’Œ x2 åŒæ—¶å½±å“äº† y çš„å€¼ï¼Œæˆ‘ä»¬å‡è®¾äº†ä¸¤ä¸ªæ¨¡å‹ï¼š mod1 &lt;- lm(y ~ x1 + x2, data = sim3) mod2 &lt;- lm(y ~ x1 * x2, data = sim3) ä½¿ç”¨ â€œ+â€ æ¥é˜è¿°å˜é‡ä¹‹é—´çš„å…³ç³»æ—¶ï¼Œæ¨¡å‹å°†ç‹¬ç«‹è®¡ç®—æ¯ä¸ªåˆå§‹æ•°æ®çš„æ•ˆåº”ã€‚å¦‚ y ~ x1 + x2 è¢«è½¬æ¢ä¸º y = a_0 + a_1 * x1 + a_2 * x2ã€‚ ä½†ä½¿ç”¨ * æ¥é˜è¿°æ—¶ï¼Œå‡½æ•°å°†ç»“åˆä¸¤è€…çš„æ•°æ®å»åˆå§‹åŒ–æ¨¡å‹ã€‚å¦‚ y ~ x1 * x2 è¢«è½¬æ¢ä¸º y = a_0 + a_1 * x1 + a_2 * x2 + a_12 * x1 * x2ã€‚ æ³¨æ„ä¸€æ—¦ä½¿ç”¨ *ï¼Œæ‰€æœ‰æ¨¡å‹çš„å‚æ•°éƒ½ä¼šåŒ…å«åœ¨æ¨¡å‹ä¸­ã€‚â€œå®è·µå‡ºçœŸçŸ¥â€ï¼Œæˆ‘ä»¬å†³å®šå°è¯•åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªæ¨¡å‹è®¡ç®—å‡ºç»“æœå»æ‹ŸåˆåŸå§‹æ•°æ®å¹¶è§‚å¯Ÿï¼š grid3 &lt;- sim3 %&gt;% data_grid(x1, x2) %&gt;% # ç”±äºåˆå§‹å€¼æœ‰ä¸¤ä¸ªï¼Œè¿™é‡Œå°±éœ€è¦å¡«å…¥ä¸¤ä¸ªå˜é‡æ¥äº§ç”Ÿåˆå§‹æ•°æ® # åŒæ—¶ä»ä¸¤ä¸ªæ¨¡å‹ä¸€èµ·è¿ç®—ä½¿ç”¨ gather_prediction()ï¼Œç›¸åçš„ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ spread_prediction() gather_predictions(mod1, mod2) # ä¼šåœ¨ç”Ÿæˆçš„ tibble ä¸­ç¬¬ä¸€åˆ—å£°æ˜ä½¿ç”¨çš„å“ªä¸ªæ¨¡å‹å¾—åˆ°çš„é¢„æœŸæ•°æ® grid3 #&gt; # A tibble: 80 Ã— 4 #&gt; model x1 x2 pred #&gt; &lt;chr&gt; &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; #&gt; 1 mod1 1 a 1.67 #&gt; 2 mod1 1 b 4.56 #&gt; 3 mod1 1 c 6.48 #&gt; 4 mod1 1 d 4.03 #&gt; 5 mod1 2 a 1.48 #&gt; 6 mod1 2 b 4.37 #&gt; 7 mod1 2 c 6.28 #&gt; 8 mod1 2 d 3.84 #&gt; 9 mod1 3 a 1.28 #&gt; 10 mod1 3 b 4.17 #&gt; # â€¦ with 70 more rows æœ€åæˆ‘ä»¬å°†å¾—åˆ°çš„æ•°æ®ç”»å›¾åˆ†æï¼š ggplot(sim3, aes(x1, y, colour = x2)) + geom_point() + geom_line(data = grid3, aes(y = pred)) + facet_wrap(~model) # åˆ‡å›¾åˆ†ç»„ å“ªç§æ¨¡å‹æ›´é€‚åˆæ­¤æ•°æ®ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹çœ‹æ®‹å·®ï¼š sim3_resid &lt;- sim3 %&gt;% # å¤šä¸ªæ¨¡å‹è·å¾—æ®‹å·®ä¸å¾—åˆ°é¢„æœŸå€¼æ ·ï¼Œä¹Ÿæœ‰ gather_residuals() gather_residuals(mod1, mod2) ggplot(sim3_resid, aes(x1, resid, colour = x2)) + geom_point() + # geom_ref_line(h = 0) + # è°ƒæ•´åŸºçº¿ä¸º 0 è€Œä¸æ˜¯æœ€å°ï¼ˆæ•ˆæœä¸å¥½å·²æ³¨é‡Šæ‰ï¼‰ # è¿™é‡Œæˆ‘ä»¬æŒ‰ç…§æ¨¡å‹å’Œ x2 çš„å€¼åˆ‡å›¾ï¼Œå› ä¸ºå®ƒå¯ä»¥æ›´å®¹æ˜“åœ°çœ‹åˆ°æ¯ä¸ªç»„ä¸­çš„æƒ…å†µ facet_grid(model ~ x2) å¯ä»¥çœ‹åˆ°ï¼Œmod2 çš„æ‹Ÿåˆåº¦æ›´å¥½ï¼Œæ®‹å·®æ›´æ¥è¿‘ 0ã€‚ 18.4 å¯¹ sim4ï¼ˆè¿ç»­ä¸”ç›¸äº’ä½œç”¨ï¼‰æ¨¡å‹ç ”ç©¶ æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å»ºç«‹ä¸¤ä¸ªæ¨¡å‹ï¼š mod1 &lt;- lm(y ~ x1 + x2, data = sim4) mod2 &lt;- lm(y ~ x1 * x2, data = sim4) grid4 &lt;- sim4 %&gt;% data_grid( # ä»¥ x1 / x2 çš„æœ€å¤§å’Œæœ€å°ä¸ºç•Œé™ï¼Œç”ŸæˆåŒ…å«äº”ä¸ªæ•°æ®çš„ç­‰å·®æ•°åˆ— x1 = seq_range(x1, 5), x2 = seq_range(x2, 5) ) %&gt;% gather_predictions(mod1, mod2) %&gt;% # å¯¹ä¸¤ä¸ªæ¨¡å‹æ±‚å–é¢„æœŸç»“æœå¹¶åˆå¹¶ print() #&gt; # A tibble: 50 Ã— 4 #&gt; model x1 x2 pred #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 mod1 -1 -1 0.996 #&gt; 2 mod1 -1 -0.5 -0.395 #&gt; 3 mod1 -1 0 -1.79 #&gt; 4 mod1 -1 0.5 -3.18 #&gt; 5 mod1 -1 1 -4.57 #&gt; 6 mod1 -0.5 -1 1.91 #&gt; 7 mod1 -0.5 -0.5 0.516 #&gt; 8 mod1 -0.5 0 -0.875 #&gt; 9 mod1 -0.5 0.5 -2.27 #&gt; 10 mod1 -0.5 1 -3.66 #&gt; # â€¦ with 40 more rows grid4 #&gt; # A tibble: 50 Ã— 4 #&gt; model x1 x2 pred #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 mod1 -1 -1 0.996 #&gt; 2 mod1 -1 -0.5 -0.395 #&gt; 3 mod1 -1 0 -1.79 #&gt; 4 mod1 -1 0.5 -3.18 #&gt; 5 mod1 -1 1 -4.57 #&gt; 6 mod1 -0.5 -1 1.91 #&gt; 7 mod1 -0.5 -0.5 0.516 #&gt; 8 mod1 -0.5 0 -0.875 #&gt; 9 mod1 -0.5 0.5 -2.27 #&gt; 10 mod1 -0.5 1 -3.66 #&gt; # â€¦ with 40 more rows 18.4.1 å…³äº seq_range() å®é™…ä½¿ç”¨ä¸Šï¼Œå°±åƒ group_by ä¸ summarize ä¸€æ ·ï¼Œseq_range å¸¸å¸¸ç»‘å®š data_grid ä½¿ç”¨ï¼š # seq_range çœŸçš„å¯ä»¥å¾ˆè½»æ˜“åœ°ç”Ÿæˆç­‰å·®æ•°åˆ—ï¼š seq_range(c(0.0123, 0.923423), n = 5) #&gt; [1] 0.0123000 0.2400808 0.4678615 0.6956423 0.9234230 # pretty å‚æ•°è¿˜å¯ä»¥è®©æ•°æ®æ›´ç®€åŒ– seq_range(c(0.0123, 0.923423), n = 5, pretty = TRUE) #&gt; [1] 0.0 0.2 0.4 0.6 0.8 1.0 # trim å‚æ•°ç”¨äºæ”¶ç¼©èŒƒå›´ï¼Œä½¿å¾—ç”Ÿæˆçš„åºåˆ—æ›´æ¥è¿‘ä¸­å€¼ (x1 &lt;- rcauchy(100)) # ç”Ÿæˆå…·æœ‰æŸ¯è¥¿åˆ†å¸ƒç‰¹æ€§çš„éšæœºæ•° #&gt; [1] 1.287927912 983.323273166 -0.357024023 -0.674447737 -0.224068431 #&gt; [6] 0.903225543 -0.338728386 2.221298462 -0.160619505 1.468088516 #&gt; [11] 0.390513558 9.734690557 -0.872233193 1.691404045 2.036414389 #&gt; [16] 0.662269407 -0.744473381 -0.069868390 11.175718614 0.098666726 #&gt; [21] -0.078456491 -0.257308118 -0.147732901 -2.317817518 0.160194594 #&gt; [26] 0.915243736 -0.763477981 -11.621093880 0.548335408 -0.994420096 #&gt; [31] 1.407825447 -5.131727573 6.598763462 2.706544164 -26.178151348 #&gt; [36] 0.183661107 0.421162420 0.753604780 -0.481886882 -0.714556275 #&gt; [41] 2.423470110 -1.467169161 1.162153110 -0.525949154 -40.993707764 #&gt; [46] 8.181409410 0.521260580 0.489637348 -8.013924900 -0.228801750 #&gt; [51] -2.190980508 -0.009795052 6.407825520 -0.082795345 -2.003274730 #&gt; [56] -1.344087578 3.771828298 10.709601613 3.859202335 0.432793393 #&gt; [61] 4.807420652 1.086559308 10.508962844 -0.951600614 -0.286034333 #&gt; [66] 2.526870481 -2.096088947 4.567061930 0.732064020 5.602050712 #&gt; [71] 38.538289731 -0.363325845 -2.993338495 -0.568155310 0.211120774 #&gt; [76] 4.148102090 4.854797973 -1.687649671 1.594430964 -0.126995362 #&gt; [81] 1.075982865 1.779520491 25.135068547 -0.339197536 -2.097722187 #&gt; [86] -2.436165868 0.866232687 0.385031250 0.181939025 -1.543996303 #&gt; [91] -0.023343955 0.818333653 -1.334457110 0.698334455 -3.774421304 #&gt; [96] -0.256704344 0.215818442 -1.584099563 0.239431900 -1.265428963 seq_range(x1, n = 5) #&gt; [1] -40.99371 215.08554 471.16478 727.24403 983.32327 seq_range(x1, n = 5, trim = 0.10) # æ”¶ç¼©æŒ‡å®šèŒƒå›´å¤´å°¾ 10% #&gt; [1] -3.8422866 -0.2519663 3.3383541 6.9286744 10.5189948 seq_range(x1, n = 5, trim = 0.25) # æ”¶ç¼©æŒ‡å®šèŒƒå›´å¤´å°¾ 25% #&gt; [1] -1.884915 -0.234365 1.416185 3.066736 4.717286 seq_range(x1, n = 5, trim = 0.50) # æ”¶ç¼©æŒ‡å®šèŒƒå›´å¤´å°¾ 50% #&gt; [1] -0.7220356 -0.1666081 0.3888193 0.9442467 1.4996741 # ä¸ä¹‹ç›¸åï¼Œexpand å‚æ•°ä¼šæ‰©å¢èŒƒå›´ x2 &lt;- c(0, 1) seq_range(x2, n = 5) #&gt; [1] 0.00 0.25 0.50 0.75 1.00 seq_range(x2, n = 5, expand = 0.10) #&gt; [1] -0.050 0.225 0.500 0.775 1.050 seq_range(x2, n = 5, expand = 0.25) #&gt; [1] -0.1250 0.1875 0.5000 0.8125 1.1250 seq_range(x2, n = 5, expand = 0.50) #&gt; [1] -0.250 0.125 0.500 0.875 1.250 18.4.2 å¯¹ sim4 æ¨¡å‹å¯è§†åŒ–ç»˜å›¾ å’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬å¯¹ sim4 çš„ä¸¤ä¸ªæ¨¡å‹è¿›è¡Œå¯è§†åŒ–ç»˜å›¾ã€‚ ggplot(grid4, aes(x1, x2)) + geom_tile(aes(fill = pred)) + # è¿™ç§ç –å—å›¾éå¸¸ä¾¿äºè§‚å¯Ÿæ‹Ÿåˆåº¦ facet_wrap(~model) x1 ä¸ x2 ä¼¼ä¹å­˜åœ¨æŸç§æ˜æ˜¾çš„å…³ç³»ï¼æˆ‘ä»¬å°è¯•ç»§ç»­æ·±å…¥è§‚å¯Ÿï¼š p &lt;- list() p[[1]] &lt;- ggplot(grid4, aes(x1, pred, colour = x2, group = x2)) + geom_line() + facet_wrap(~model) p[[2]] &lt;- ggplot(grid4, aes(x2, pred, colour = x1, group = x1)) + geom_line() + facet_wrap(~model) library(grid) grid.newpage() # æ–°å»ºå¸ƒå±€åŒ… pushViewport(viewport(layout = grid.layout(2, 1))) # è®¾ç½® 2x1 å¸ƒå±€ print(p[[1]], vp = viewport(layout.pos.row = 1, layout.pos.col = 1)) print(p[[2]], vp = viewport(layout.pos.row = 2, layout.pos.col = 1)) å¯ä»¥çœ‹åˆ°æœ‰æ˜æ˜¾çš„ç›¸äº’ä½œç”¨å…³ç³»ï¼ä¸ºäº†é¢„æµ‹ yï¼Œæˆ‘ä»¬éœ€è¦åŒæ—¶è€ƒè™‘ x1 å’Œ x2 çš„å€¼ã€‚ 18.5 å¯¹ sim5ï¼ˆæ¨¡å‹è½¬æ¢ï¼‰æ¨¡å‹ç ”ç©¶ å› ä¸ºåŒ…ä¸è‡ªå¸¦ sim5ï¼Œè¿™é‡Œæˆ‘ä»¬åªèƒ½è‡ªå·±å»ºï¼ˆæ¼ sim5 &lt;- tibble( x = seq(0, 3.5 * pi, length = 50), y = 4 * sin(x) + rnorm(length(x)) # éšæœºç”Ÿæˆä¸ x å‘é‡é•¿åº¦ç›¸åŒçš„å‘é‡å¹¶åŠ ä¸Š 4 å€ sin(x) ) sim5 #&gt; # A tibble: 50 Ã— 2 #&gt; x y #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 0 1.80 #&gt; 2 0.224 -1.25 #&gt; 3 0.449 2.04 #&gt; 4 0.673 1.86 #&gt; 5 0.898 4.11 #&gt; 6 1.12 3.04 #&gt; 7 1.35 4.57 #&gt; 8 1.57 2.86 #&gt; 9 1.80 2.32 #&gt; 10 2.02 4.59 #&gt; # â€¦ with 40 more rows 18.5.1 å…³äº I() å’Œ model_matrix()ï¼ˆç»­ï¼‰ æˆ‘ä»¬è¿˜å¯ä»¥åœ¨æ¨¡å‹å…¬å¼å†…éšæ„è½¬æ¢ã€‚ä¾‹å¦‚ï¼Œlog(y) ~ sqrt(x1) + x2 å°†è½¬æ¢ä¸º log(y) = a_1 + a_2 * sqrt(x1) + a_3 * x2ã€‚ å¦‚æœè½¬æ¢æ¶‰åŠ +ã€*ã€^ æˆ– -ï¼Œåˆ™æˆ‘ä»¬éœ€è¦å°†å…¶åŒ…è£…åœ¨ I() å‡½æ•°ä¸­ï¼Œè¿™æ · R å°±ä¸ä¼šå°†å…¶è§†ä¸ºæ¨¡å‹è§„èŒƒçš„ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œy ~ x + I(x ^ 2) ç¿»è¯‘ä¸º y = a_1 + a_2 * x + a_3 * x^2ã€‚å¦‚æœä¸Šè¿°æƒ…å†µå¿˜è®°äº† I() æŒ‡å®šæˆ y ~ x ^ 2 + xï¼ŒR å°†è§†ä¸º y ~ x * x + xã€‚ x * x è¡¨ç¤º x ä¸è‡ªèº«çš„ç›¸äº’ä½œç”¨ï¼Œè¿™ä¸ x æ•ˆæœç›¸åŒã€‚R ä¼šè‡ªåŠ¨åˆ é™¤å†—ä½™å˜é‡ï¼Œä¼šç›´æ¥è½¬æ¢æˆ y = a_1 + a_2 * xã€‚è¿™å¾ˆç³Ÿç³•ï¼Œæ¯•ç«Ÿè¿™å¹¶ä¸æ˜¯ä½ æƒ³è¦çš„æ•ˆæœã€‚æ‰€ä»¥ä¸€å®šè¦æ³¨æ„é¿å…ï¼ è€Œå¯¹äºè‡ªå·±åˆ›ç«‹çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ model_matrix() æ¥å‡†ç¡®æŸ¥çœ‹æ‹Ÿåˆçš„æ–¹ç¨‹ï¼š tb &lt;- tribble( ~y, ~x, 1, 1, 2, 2, 3, 3 ) model_matrix(tb, y ~ x^2 + x) #&gt; # A tibble: 3 Ã— 2 #&gt; `(Intercept)` x #&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 1 #&gt; 2 1 2 #&gt; 3 1 3 model_matrix(tb, y ~ I(x^2) + x) #&gt; # A tibble: 3 Ã— 3 #&gt; `(Intercept)` `I(x^2)` x #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 1 1 #&gt; 2 1 4 2 #&gt; 3 1 9 3 18.5.2 å…³äº poly() è½¬æ¢æ¨¡å‹éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥è¿‘ä¼¼éçº¿æ€§å‡½æ•°ã€‚å¾®ç§¯åˆ†è¯¾ä¸Šæˆ‘ä»¬å­¦è¿‡æ³°å‹’å®šç†ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬å¯ä»¥ç”¨æ— é™çš„å¤šé¡¹å¼å’Œæ¥è¿‘ä¼¼ä»»ä½•å¹³æ»‘æ›²çº¿å‡½æ•°ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å¤šé¡¹å¼å‡½æ•°é€šè¿‡æ‹Ÿåˆã€‚ æ‰‹åŠ¨é”®å…¥è¯¥åºåˆ—å¾ˆç¹çå¤æ‚ï¼Œè€Œ R æä¾›äº†ä¸€ä¸ªå‡½æ•°ï¼špoly() model_matrix(tb, y ~ poly(x, 2)) # æ³¨æ„è¿™ä¸ª â€œ2â€ æ˜¯ degree å‚æ•°ï¼Œè¡¨ç¤ºå¤šé¡¹å¼çš„æœ€é«˜æ¬¡æ•° #&gt; # A tibble: 3 Ã— 3 #&gt; `(Intercept)` `poly(x, 2)1` `poly(x, 2)2` #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 -7.07e- 1 0.408 #&gt; 2 1 -7.85e-17 -0.816 #&gt; 3 1 7.07e- 1 0.408 18.5.3 å…³äº ns() æ³¨æ„ poly ç”Ÿæˆçš„å¤šé¡¹å¼å‡½æ•°åŒæ³°å‹’å‡½æ•°ä¸€æ ·ï¼Œå‡ºç°äº†ä¸€ä¸ªç›¸å¯¹æ£˜æ‰‹çš„é—®é¢˜ï¼šåœ¨æ•°æ®èŒƒå›´ä¹‹å¤–ï¼Œå¤šé¡¹å¼æ€»æ˜¯è¿…é€Ÿæ¥è¿‘æ— ç©·å¤§ã€‚ æ‰€ä»¥æˆ‘ä»¬å‰”é™¤äº†å¦ä¸€ç§æ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå³æ ·æ¡å›å½’ï¼šsplines::ns() library(splines) model_matrix(tb, y ~ ns(x, 2)) #&gt; # A tibble: 3 Ã— 3 #&gt; `(Intercept)` `ns(x, 2)1` `ns(x, 2)2` #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1 0 0 #&gt; 2 1 0.566 -0.211 #&gt; 3 1 0.344 0.771 å°è¯•å¯è§†åŒ–ï¼æˆ‘ä»¬å»ºç«‹äº†ä¸åŒæ¬¡æ•°çš„ 5 ä¸ªæ¨¡å‹ï¼š mod1 &lt;- lm(y ~ ns(x, 1), data = sim5) mod2 &lt;- lm(y ~ ns(x, 2), data = sim5) mod3 &lt;- lm(y ~ ns(x, 3), data = sim5) mod4 &lt;- lm(y ~ ns(x, 4), data = sim5) mod5 &lt;- lm(y ~ ns(x, 5), data = sim5) grid &lt;- sim5 %&gt;% data_grid(x = seq_range(x, n = 50, expand = 0.1)) %&gt;% # å‘å¤–æ‰©å¼  10% ç”ŸæˆçŸ©é˜µ # .pred å‚æ•°ç”¨æ¥ä¿®æ”¹ç”ŸæˆæœŸæœ›å€¼åˆ—çš„åˆ—å gather_predictions(mod1, mod2, mod3, mod4, mod5, .pred = &quot;y&quot;) ggplot(sim5, aes(x, y)) + geom_point() + geom_line(data = grid, colour = &quot;red&quot;) + facet_wrap(~model) # ä»¥ model åˆ†ç»„ å°±åƒæˆ‘ä»¬åœ¨æ•°å­¦ä¸­å­¦ä¹ çš„æ³°å‹’å…¬å¼ä¸€æ ·ï¼Œé¡¹çš„æ¬¡æ•°è¶Šé«˜ï¼Œå…¶æ‹Ÿåˆæ€§å¾€å¾€è¶Šå¥½ã€‚mod5 çš„æ‹Ÿåˆåº¦å°±æ˜æ˜¾å¤§äºå…¶ä»–æ¨¡å‹ã€‚ 18.5.4 NA å€¼ï¼ˆç¼ºå°‘å€¼ï¼‰é—®é¢˜ å¦‚æœä½ çš„æ•°æ®ä½ è¿˜æœ‰ NA å€¼çš„è¯ï¼ŒR å½“ç„¶ä¼šæç¤ºä½ é”™è¯¯ï¼ df &lt;- tribble( ~x, ~y, 1, 2.2, 2, NA, 3, 3.5, 4, 8.3, NA, 10 ) # mod &lt;- lm(y ~ x, data = df) #&gt; Warning: Dropping 2 rows with missing values # åŠ ä¸Š â€œna.action = na.excludeâ€ è¡¨ç¤ºä¸åŒ…å« NA å€¼è®¡ç®—ï¼š mod &lt;- lm(y ~ x, data = df, na.action = na.exclude) # è¿™æ ·è¿™ä¸ªæ¨¡å‹å°±åªæœ‰ 3 ç§è§‚æµ‹å€¼å¯ç”¨äº†ï¼š nobs(mod) # nobs() ç”¨äºæŸ¥çœ‹å¯è§‚æµ‹æ¬¡æ•° #&gt; [1] 3 18.6 å…¶ä»–å¸¸è§çº¿æ€§æ¨¡å‹ æœ¬ç« åªå…³æ³¨çº¿æ€§ç±»å‹çš„æ¨¡å‹ï¼Œå®ƒä»¬å‡è®¾å½¢å¼ä¸º y = a_1 * x1 + a_2 * x2 + ... + a_n * xnã€‚åŒæ ·ï¼Œå¯¹äºçº¿æ€§æ¨¡å‹çš„æ®‹å·®ï¼Œå®ƒå¯èƒ½è¿˜æœ‰ä¸€äº›ç‰¹æ€§ï¼Œå¦‚è¿˜å¯èƒ½å…·æœ‰æ­£æ€åˆ†å¸ƒã€‚æœ‰è®¸å¤šæ¨¡å‹ä»¥å„ç§æœ‰è¶£çš„æ–¹å¼æ‰©å±•çº¿æ€§æ¨¡å‹ï¼Œç›¸å¯¹å¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ç§ï¼š å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGeneralised Linear Modelsï¼‰ï¼Œå¦‚ stats::glm()ã€‚ çº¿æ€§æ¨¡å‹çš„æ•°æ®é€šå¸¸æ˜¯è¿ç»­çš„ï¼Œå¹¶ä¸”å…¶æ®‹å·®å…·æœ‰æ­£æ€åˆ†å¸ƒã€‚è¯¥æ¨¡å‹å¯¹çº¿æ€§æ¨¡å‹è¿›è¡Œäº†æ‰©å±•ï¼Œç”šè‡³å›Šæ‹¬äº†éè¿ç»­å“åº”ï¼ˆä¾‹å¦‚äºŒè¿›åˆ¶æ•°æ®æˆ–è®¡æ•°ï¼‰ã€‚è€Œå…¶å·¥ä½œåŸç†æ˜¯åŸºäºå¯èƒ½æ€§çš„ç»Ÿè®¡å»å®šä¹‰è·ç¦»åº¦é‡ã€‚ æœ‰å…³å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGLMï¼‰çš„å®é™…è¿ä½œå‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/110387248 å¹¿ä¹‰åŠ æ€§æ¨¡å‹ï¼ˆGeneralised Additive Modelsï¼‰ï¼Œå¦‚ mgcv::gam()ã€‚å®ƒæ‰©å±•å¹¿ä¹‰çº¿æ€§æ¨¡å‹ä»¥åŒ…å«ä»»æ„å…‰æ»‘å‡½æ•°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç¼–å†™è¯¸å¦‚ y ~ s(x) è¿™æ ·çš„å…¬å¼ã€‚è¿™æ ·çš„æ¨¡å‹å…¬å¼å°†ä½¿ç”¨ y = f(x) å’Œ letgamï¼Œå³ gam() å»ä¼°è®¡è¯¥å‡½æ•°æ˜¯ä»€ä¹ˆæ ·çš„ã€‚ æœ‰å…³å¹¿ä¹‰åŠ æ€§æ¨¡å‹ï¼ˆGAMï¼‰çš„å®é™…è¿ä½œå‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/53001283 æƒ©ç½šçº¿æ€§æ¨¡å‹ï¼ˆPenalised Linear Modelsï¼‰ï¼Œå¦‚ glmnet::glmnet()ã€‚ è¯¥æ¨¡å‹ä½¿å¾—åœ¨ â€œæƒ©å¤„â€ ä¸€ä¸ªå¤æ‚æ¨¡å‹çš„è·ç¦»ä¸­æ·»åŠ ä¸€ä¸ª â€œæƒ©å¤„â€ é¡¹ï¼ˆç”±å‚æ•°å‘é‡å’ŒåŸç‚¹ä¹‹é—´çš„è·ç¦»å†³å®šï¼‰ã€‚è¿™å¾€å¾€ä½¿æ¨¡å‹å¯ä»¥æ›´å¥½åœ°æ¨å¹¿åˆ°æ¥è‡ªåŒä¸€äººç¾¤çš„æ–°æ•°æ®é›†ã€‚ ç¨³å¥çº¿æ€§æ¨¡å‹ï¼ˆRobust linear modelsï¼‰ï¼Œå¦‚ MASS::rlm()ã€‚ è¯¥æ¨¡å‹ç”¨äºè°ƒæ•´ä¸æ¨¡å‹é¢„æœŸè·ç¦»éå¸¸è¿œçš„ç‚¹çš„æƒé‡ï¼Œä½¿å¾—æ¨¡å‹å¯¹äºå¼‚å¸¸å€¼é—®é¢˜ä¸é‚£ä¹ˆæ•æ„Ÿã€‚ä½†å…¶ä»£ä»·åˆ™æ˜¯åœ¨æ²¡æœ‰å¼‚å¸¸å€¼æ—¶é€šå¸¸ä¸å¦‚å…¶ä»–æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœé‚£ä¹ˆå¼ºã€‚ æœ‰å…³ç¨³å¥çº¿æ€§æ¨¡å‹ï¼ˆRLMï¼‰çš„å®é™…è¿ä½œå‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/398805690 æ ‘æ¨¡å‹ï¼ˆTreesï¼‰ï¼Œå¦‚ rpart::rpart()ã€‚ è¿™ç§æ¨¡å‹åˆ™æ˜¯ä»¥ä¸çº¿æ€§æ¨¡å‹å®Œå…¨ä¸åŒçš„æ–¹å¼å»è§£å†³é—®é¢˜ï¼Œé€‚åˆåˆ†æ®µæ’å®šæ¨¡å‹ï¼Œå¹¶å°†æ•°æ®æ‹†åˆ†å¤šä¸ªæˆè¶³å¤Ÿå°çš„éƒ¨åˆ†ã€‚æ ‘æ¨¡å‹æœ¬èº«å¹¶ä¸å‡ºè‰²ï¼Œä½†å½“è¢«éšæœºæ£®æ—ï¼ˆRandom Forestsï¼‰ï¼Œåƒæ˜¯ randomForest::randomForest()ï¼Œæˆ–æ˜¯æ¢¯åº¦æå‡æœºï¼ˆGradient Boosting Machinesï¼‰ï¼Œåƒæ˜¯ xgboost::xgboost() ç­‰å¤šç§æ¨¡å‹èšåˆä½¿ç”¨æ—¶ï¼Œæ ‘æ¨¡å‹ä¼šå˜å¾—éå¸¸å¼ºå¤§ã€‚ æœ‰å…³éšæœºæ£®æ—ï¼ˆRFï¼‰çš„å®é™…è¿ä½œå‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/125505067 æœ‰å…³æ¢¯åº¦æå‡æœºï¼ˆGBMï¼‰çš„å®é™…è¿ä½œå‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/36011508 "],["model-building.html", "Chapter 19 Model building 19.1 åˆ†æ diamonds å“è´¨ä¸ä»·æ ¼åå¸¸çš„åŸå›  19.2 åˆ†æ flights æ¯æ—¥èˆªç­æ•°é‡å˜åŒ–å› ç´  19.3 å…³äºè®¡ç®—å˜é‡ 19.4 æœ‰å…³æ¨¡å‹çš„æ›´å¤šä¿¡æ¯", " Chapter 19 Model building ä¸Šä¸€ç« æˆ‘ä»¬ä¾§é‡äºæ¨¡æ‹Ÿæ•°æ®é›†ã€‚æœ¬ç« å°†é‡ç‚¹ä»‹ç»çœŸå®æ•°æ®ï¼Œä»¥åŠå¦‚ä½•æ„å»ºæ¨¡å‹ä»¥ä¾¿ç†è§£æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥å°†æ•°æ®åˆ’åˆ†ä¸ºæ¨¡å¼å’Œæ®‹å·®æ¨¡å‹ã€‚æ³¨æ„æ¨¡å‹å»ºç«‹æœ‰æ—¶ä¸å°½äººæ„ï¼Œæœ‰æ—¶å»ºç«‹å¾—å¾ˆå¥½ä½†ä½ ä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚ å¦‚æœä½ é‡åˆ°äº†ä»»ä½•å›°æƒ‘ â€”â€” è¯·ä¸è¦ç•æƒ§é‡æ–°å¼€å§‹ï¼æ¢ä¸ªå…¨æ–°æ€è·¯å¯èƒ½å¯¹ä½ éå¸¸æœ‰ç”¨ã€‚ library(tidyverse) library(modelr) options(na.action = na.warn) library(nycflights13) library(lubridate) 19.1 åˆ†æ diamonds å“è´¨ä¸ä»·æ ¼åå¸¸çš„åŸå›  è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰ç ”ç©¶çš„å¥‡æ€ªç°è±¡å—ï¼Ÿå“è´¨è¶Šå·®çš„é’»çŸ³ï¼Œä»·æ ¼è¶Šé«˜ã€‚ä¸åªæ˜¯è´¨é‡ï¼Œåœ¨é¢œè‰²ã€çº¯å‡€åº¦æ–¹é¢éƒ½æ˜¯è¿™æ ·è¡¨ç°çš„ï¼š ggplot(diamonds, aes(cut, price)) + geom_boxplot() ggplot(diamonds, aes(color, price)) + geom_boxplot() ggplot(diamonds, aes(clarity, price)) + geom_boxplot() æ³¨æ„æœ€å·®çš„é’»çŸ³é¢œè‰²æ˜¯ Jï¼ˆå¾®é»„è‰²ï¼‰ï¼Œæœ€å·®çš„çº¯å‡€åº¦æ˜¯ I1ï¼ˆè‚‰çœ¼å¯è§çš„æ‚ç‰©ï¼‰ã€‚ 19.1.1 é‡é‡ä¸ä»·æ ¼ ggplot(diamonds, aes(carat, price)) + geom_hex(bins = 50) æˆ‘ä»¬å†³å®šå¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤å¤„ç†ï¼š diamonds_new &lt;- diamonds %&gt;% filter(carat &lt;= 2.5) %&gt;% # è´¨é‡å°äº 2.5 mutate(lprice = log2(price), lcarat = log2(carat)) # å¯¹ä»·æ ¼å’Œè´¨é‡å–å¯¹æ•°ï¼ˆåŸºæ•°ä¸º 2 çš„å¯¹æ•°ï¼‰ ggplot(diamonds_new, aes(lcarat, lprice)) + geom_hex(bins = 50) é€šè¿‡è½¬åŒ–ï¼Œå®ƒä»¬çš„å…³ç³»å˜æˆäº†æ˜æ˜¾æ¼‚äº®çš„çº¿æ€§åŒ–ï¼æˆ‘ä»¬è¯•ç€åˆ›å»ºæ¨¡å‹å»æ‹Ÿåˆå®ƒï¼š mod_diamonds &lt;- lm(lprice ~ lcarat, data = diamonds_new) grid &lt;- diamonds_new %&gt;% data_grid(carat = seq_range(carat, 20)) %&gt;% # åˆ›å»ºçŸ©é˜µ mutate(lcarat = log2(carat)) %&gt;% # çŸ©é˜µç”Ÿæˆçš„ carat ä¹Ÿéœ€è¦å–å¯¹æ•° add_predictions(mod_diamonds, &quot;lprice&quot;) %&gt;% # é¢„æµ‹ mutate(price = 2^lprice) # å°†ä»·æ ¼è¿˜åŸå›å» æœ€åç»˜åˆ¶æ•°æ®å›¾ï¼š ggplot(diamonds_new, aes(carat, price)) + geom_hex(bins = 50) + geom_line(data = grid, colour = &quot;red&quot;, size = 1) #&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. #&gt; â„¹ Please use `linewidth` instead. #&gt; This warning is displayed once every 8 hours. #&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #&gt; generated. è¿™å‘Šè¯‰æˆ‘ä»¬ä¸€äº›å…³äºè¿™äº›æ•°æ®çš„æœ‰è¶£ä¿¡æ¯ï¼šå¦‚æœæˆ‘ä»¬ç›¸ä¿¡æˆ‘ä»¬åˆ›é€ çš„æ¨¡å‹ï¼Œé‚£ä¹ˆå¤§é’»çŸ³æ¯”é¢„æœŸçš„è¦ä¾¿å®œå¾—å¤šã€‚ æˆ‘ä»¬æ¥åˆ†ææ®‹å·®çš„æ•°æ®ï¼š diamonds_new &lt;- diamonds_new %&gt;% add_residuals(mod_diamonds, &quot;lresid&quot;) # æ³¨æ„è¿™é‡Œåˆ†æå¾—åˆ°çš„æ•°æ®æ˜¯å–è¿‡å¯¹æ•°çš„ ggplot(diamonds_new, aes(lcarat, lresid)) + geom_hex(bins = 50) æˆ‘ä»¬å†³å®šèˆå¼ƒæ‰ä»·æ ¼å˜é‡ï¼Œå› ä¸º lrisid å˜é‡å¯èƒ½æœ‰å…¶ä»–å‚è€ƒä»·å€¼ï¼š ggplot(diamonds_new, aes(cut, lresid)) + geom_boxplot() ggplot(diamonds_new, aes(color, lresid)) + geom_boxplot() ggplot(diamonds_new, aes(clarity, lresid)) + geom_boxplot() ç°åœ¨æˆ‘ä»¬çœ‹åˆ°äº†æ‰€æœŸæœ›çš„ç»“æœï¼šé’»çŸ³å“è´¨è¶Šé«˜ï¼Œå…¶ç›¸å¯¹ä»·æ ¼ä¹Ÿè¶Šé«˜ã€‚ 19.1.2 æ¨å¹¿å‡ºæ›´å¤æ‚çš„æ¨¡å‹ æ—¢ç„¶ä»·æ ¼å¯¹æ•°ä¸è´¨é‡å¯¹æ•°ã€é¢œè‰²ã€è´¨é‡å’Œå“è´¨éƒ½æœ‰é‡è¦å…³ç³»ï¼Œé‚£æˆ‘ä»¬ä¸å¦¨æŠŠå®ƒä»¬éƒ½åŠ å…¥æ¨¡å‹ï¼š mod_diamond_new &lt;- lm( lprice ~ lcarat + color + cut + clarity, data = diamonds_new ) grid &lt;- diamonds_new %&gt;% # ç”¨ data_grid() æ¥åˆ›å»ºæ•°æ®è¶Šæ¥è¶Šéº»çƒ¦äº†ã€‚ # å¥½åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªå« â€œ.modelâ€ çš„å‚æ•°å¸®æˆ‘ä»¬å®Œæˆï¼š data_grid(cut, .model = mod_diamond_new) %&gt;% add_predictions(mod_diamond_new) grid #&gt; # A tibble: 5 Ã— 5 #&gt; cut lcarat color clarity pred #&gt; &lt;ord&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 Fair -0.515 G VS2 11.2 #&gt; 2 Good -0.515 G VS2 11.3 #&gt; 3 Very Good -0.515 G VS2 11.4 #&gt; 4 Premium -0.515 G VS2 11.4 #&gt; 5 Ideal -0.515 G VS2 11.4 ggplot(grid, aes(cut, pred)) + geom_point() å¦‚æœæ¨¡å‹éœ€è¦æˆ‘ä»¬æœªæ˜¾å¼æä¾›çš„å˜é‡ï¼Œdata_grid() å°†è‡ªåŠ¨ä½¿ç”¨ â€œå…¸å‹å€¼â€ å¡«å……å®ƒä»¬ã€‚å¯¹äºè¿ç»­å˜é‡ï¼Œå®ƒä½¿ç”¨ä¸­ä½æ•°ï¼Œåˆ†ç±»å˜é‡ä½¿ç”¨æœ€å¸¸è§çš„å€¼ï¼ˆå¦‚æœå­˜åœ¨å¹¶åˆ—ï¼Œåˆ™ä½¿ç”¨æˆ–å€¼ï¼‰ã€‚ diamonds_new &lt;- diamonds_new %&gt;% # æ–°çš„ lrisid æ·»åŠ äº†é¢œè‰²ã€è´¨é‡å’Œå“è´¨å…³ç³» add_residuals(mod_diamond_new, &quot;lresid_new&quot;) ggplot(diamonds_new, aes(lcarat, lresid_new)) + geom_hex(bins = 50) æˆ‘ä»¬ä¼šå‘ç°æœ‰ä¸€äº›é’»çŸ³æ•°æ®çš„æ®‹å·®ç›¸å½“å¤§ â€”â€” å°¤å…¶æ˜¯å› ä¸ºå–å¯¹æ•°çš„å…³ç³»ï¼Œæ®‹å·®ä¸º 2 è¡¨ç¤ºé’»çŸ³çš„ä»·æ ¼æ˜¯æˆ‘ä»¬é¢„æœŸçš„ 4 å€ã€‚å•ç‹¬æŸ¥çœ‹å¼‚å¸¸å€¼é€šå¸¸å¾ˆæœ‰ç”¨ï¼š diamonds_new %&gt;% filter(abs(lresid_new) &gt; 1) %&gt;% # æ®‹å·®ç»å¯¹å€¼å¤§äº 1 add_predictions(mod_diamond_new) %&gt;% # å¯¹è¿™äº›æ•°æ®ç”ŸæˆæœŸæœ›å€¼å¯¹æ•° mutate(pred = round(2^pred)) %&gt;% # å¯¹æœŸæœ›å€¼åå¯¹æ•°å¹¶å–æ•´ select(price, pred, carat:table, x:z) %&gt;% # é‡æ–°é€‰å–éœ€è¦çš„æ•°æ® arrange(price) # æŒ‰ç…§ä»·æ ¼æ’åˆ— #&gt; # A tibble: 16 Ã— 11 #&gt; price pred carat cut color clarity depth table x y z #&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;ord&gt; &lt;ord&gt; &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 1013 264 0.25 Fair F SI2 54.4 64 4.3 4.23 2.32 #&gt; 2 1186 284 0.25 Premium G SI2 59 60 5.33 5.28 3.12 #&gt; 3 1186 284 0.25 Premium G SI2 58.8 60 5.33 5.28 3.12 #&gt; 4 1262 2644 1.03 Fair E I1 78.2 54 5.72 5.59 4.42 #&gt; 5 1415 639 0.35 Fair G VS2 65.9 54 5.57 5.53 3.66 #&gt; 6 1415 639 0.35 Fair G VS2 65.9 54 5.57 5.53 3.66 #&gt; 7 1715 576 0.32 Fair F VS2 59.6 60 4.42 4.34 2.61 #&gt; 8 1776 412 0.29 Fair F SI1 55.8 60 4.48 4.41 2.48 #&gt; 9 2160 314 0.34 Fair F I1 55.8 62 4.72 4.6 2.6 #&gt; 10 2366 774 0.3 Very Good D VVS2 60.6 58 4.33 4.35 2.63 #&gt; 11 3360 1373 0.51 Premium F SI1 62.7 62 5.09 4.96 3.15 #&gt; 12 3807 1540 0.61 Good F SI2 62.5 65 5.36 5.29 3.33 #&gt; 13 3920 1705 0.51 Fair F VVS2 65.4 60 4.98 4.9 3.23 #&gt; 14 4368 1705 0.51 Fair F VVS2 60.7 66 5.21 5.11 3.13 #&gt; 15 10011 4048 1.01 Fair D SI2 64.6 58 6.25 6.2 4.02 #&gt; 16 10470 23622 2.46 Premium E SI2 59.7 59 8.82 8.76 5.25 ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆå‡ºäººæ„æ–™çš„æ•°æ®ï¼Œä½†å¯èƒ½å€¼å¾—èŠ±æ—¶é—´è€ƒè™‘ï¼Œè¿™æ˜¯å¦è¡¨æ˜æˆ‘ä»¬çš„æ¨¡å‹å­˜åœ¨é—®é¢˜ï¼Œæˆ–è€…æ•°æ®ä¸­å­˜åœ¨é”™è¯¯ã€‚ 19.2 åˆ†æ flights æ¯æ—¥èˆªç­æ•°é‡å˜åŒ–å› ç´  æŒ‰ç…§å¤©æ¥çœ‹ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å« 365 é¡¹çš„ç®€å•æ•°æ®é›†ï¼š daily &lt;- flights %&gt;% # åŒç†æˆ‘ä»¬è¿˜æœ‰ make_datetimeï¼Œä½œç”¨æ˜¯å°†æ—¥æœŸå„å› ç´ æ‹¼æ¥ï¼Œå¹¶è¿”å› â€œæ—¥æœŸâ€ æ ¼å¼æ•°æ® mutate(date = make_date(year, month, day)) %&gt;% group_by(date) %&gt;% summarise(n = n()) daily #&gt; # A tibble: 365 Ã— 2 #&gt; date n #&gt; &lt;date&gt; &lt;int&gt; #&gt; 1 2013-01-01 842 #&gt; 2 2013-01-02 943 #&gt; 3 2013-01-03 914 #&gt; 4 2013-01-04 915 #&gt; 5 2013-01-05 720 #&gt; 6 2013-01-06 832 #&gt; 7 2013-01-07 933 #&gt; 8 2013-01-08 899 #&gt; 9 2013-01-09 902 #&gt; 10 2013-01-10 932 #&gt; # â€¦ with 355 more rows ggplot(daily, aes(date, n)) + geom_line() ä¸éš¾å‘ç°ï¼Œèˆªç­ä¹¦æ€»æ˜¯å‘ˆç°å‡ºå‘¨æœŸæ€§å˜åŒ–ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥æŒ‰æ˜ŸæœŸå‡ åˆ’åˆ†ã€‚ 19.2.1 æ˜ŸæœŸå‡ å¯¹èˆªç­çš„å½±å“ daily &lt;- daily %&gt;% # å¯¹æŒ‡å®šçš„æ—¥æœŸæ¥è¿”å›æ˜ŸæœŸå‡ ï¼ˆlabel é…ç½®é¡¹ä¸ºæ˜¯å¦è¦ç”¨å½“åœ°è¯­è¨€è¡¨ç¤º,é»˜è®¤ FALSE ç”¨æ•°å­—è¡¨ç¤ºï¼‰ mutate(wday = wday(date, label = TRUE)) ggplot(daily, aes(wday, n)) + # æ³¨æ„è¿™é‡Œé»˜è®¤å‘¨æœ«æ’æœ€å‰ geom_boxplot() åŒä¼‘æ—¥çš„èˆªç­ç›¸å¯¹è¦å°‘äº›ï¼Œå› ä¸ºå¤§å¤šæ•°æ—…è¡Œéƒ½æ˜¯å•†åŠ¡æ—…è¡Œã€‚è¿™ç§å½±å“åœ¨å‘¨å…­å°¤ä¸ºæ˜æ˜¾ï¼šä½ æœ‰æ—¶å¯èƒ½ä¼šåœ¨å‘¨æ—¥ç¦»å¼€å»å‚åŠ å‘¨ä¸€ä¸Šåˆçš„ä¼šè®®ï¼Œä½†ä½ å¾ˆå°‘åœ¨å‘¨å…­ç¦»å¼€ï¼Œå› ä¸ºä½ æ›´æ„¿æ„åœ¨å®¶å’Œå®¶äººä»¬åœ¨ä¸€èµ·ã€‚ æ¶ˆé™¤è¿™ç§å½±å“æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ¨¡å‹çŸ«æ­£ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ‹Ÿåˆæ¨¡å‹ï¼Œå¹¶å°†å…¶é¢„æµ‹è¦†ç›–åœ¨åŸå§‹æ•°æ®ä¸Šæ¥å¯è§†åŒ–ï¼š mod_wday &lt;- lm(n ~ wday, data = daily) grid &lt;- daily %&gt;% data_grid(wday) %&gt;% add_predictions(mod_wday, &quot;n&quot;) ggplot(daily, aes(wday, n)) + geom_boxplot() + geom_point(data = grid, colour = &quot;red&quot;, size = 4) è¿™æ ·ï¼Œæˆ‘ä»¬å°±æŠŠé—®é¢˜è½¬åŒ–ä¸ºåˆ†ææ®‹å·®ï¼š daily &lt;- daily %&gt;% add_residuals(mod_wday) daily %&gt;% ggplot(aes(date, resid)) + geom_ref_line(h = 0) + # åŸºçº¿è°ƒæ•´åˆ° 0 è€Œä¸æ˜¯æœ€å° geom_line() ç°åœ¨ï¼Œé€šè¿‡æ˜ŸæœŸå‡ é¢„ä¼°æ¨¡å‹ï¼Œæˆ‘ä»¬å‘ç°èˆªç­æ•°é‡ä»ç„¶æ˜æ˜¾åç¦»äº†é¢„æœŸèˆªç­æ•°é‡ã€‚è™½ç„¶ç°åœ¨æˆ‘ä»¬å·²ç»æ¶ˆé™¤äº†å¤§éƒ¨åˆ†å¤§çš„æ¯å‘¨æ•ˆåº”ï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥çœ‹åˆ°ä¸€äº›æ›´å¾®å¦™çš„å˜åŒ–ï¼šæœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œæˆ‘æ˜¯è¯´å¯èƒ½ï¼Œè¿™ä¸ªæ¨¡å‹çš„å˜åŒ–ä¸åªæ˜¯å•çº¯çš„è¢«æ˜ŸæœŸå‡ ï¼Ÿ ä»6æœˆä»½å¼€å§‹ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å¾ˆæ˜¯å¤±è´¥ã€‚ä¸ºä¸€å‘¨ä¸­çš„æ¯ä¸€å¤©ç»˜åˆ¶ä¸€æ¡çº¿ï¼Œä½¿åŸå› æ›´å®¹æ˜“çœ‹åˆ°ï¼š ggplot(daily, aes(date, resid, colour = wday)) + geom_ref_line(h = 0) + geom_line() æœ‰äº›çº¿æ¡ä»ç„¶åœ¨ä¹±é£ï¼å°¤å…¶æ˜¯å‘¨å…­çš„èˆªç­æ•°é‡ï¼šå¤å­£çš„èˆªç­æ¯”æˆ‘ä»¬é¢„æœŸçš„è¦å¤šï¼Œç§‹å­£çš„èˆªç­åˆ™å°‘å¾—å¤šã€‚ä¹‹åæˆ‘ä»¬ä¼šç€é‡åˆ†æã€‚ è¿™é‡Œå°†åç¦»è¿‡å¤§çš„ â€œå¼‚å¸¸â€ æ•°æ®å•ç‹¬å–å‡ºä»”ç»†ç ”ç©¶ï¼š daily %&gt;% filter(resid &lt; -100) #&gt; # A tibble: 11 Ã— 4 #&gt; date n wday resid #&gt; &lt;date&gt; &lt;int&gt; &lt;ord&gt; &lt;dbl&gt; #&gt; 1 2013-01-01 842 Tue -109. #&gt; 2 2013-01-20 786 Sun -105. #&gt; 3 2013-05-26 729 Sun -162. #&gt; 4 2013-07-04 737 Thu -229. #&gt; 5 2013-07-05 822 Fri -145. #&gt; 6 2013-09-01 718 Sun -173. #&gt; 7 2013-11-28 634 Thu -332. #&gt; 8 2013-11-29 661 Fri -306. #&gt; 9 2013-12-24 761 Tue -190. #&gt; 10 2013-12-25 719 Wed -244. #&gt; 11 2013-12-31 776 Tue -175. è¯·æ³¨æ„è¿™äº›æ—¥æœŸå¹¶ä¸æ˜¯å·§åˆã€‚ä»ç¾å›½å…¬å…±å‡æ—¥è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™äº›æ•°æ®åŒ…å«å…ƒæ—¦ã€ç¾å›½ç‹¬ç«‹æ—¥ï¼ˆ7æœˆ4æ—¥ï¼‰ã€æ„Ÿæ©èŠ‚å’Œåœ£è¯èŠ‚ã€‚ è€Œé™¤ä¸Šè¿°ä¸ªåˆ«çªå‡ºçš„æ•°æ®ä»¥å¤–ï¼Œä¹Ÿæœ‰ä¸€äº›æ•´ä½“æ€§çš„è¶‹åŠ¿ï¼š daily %&gt;% ggplot(aes(date, resid)) + geom_ref_line(h = 0) + geom_line(colour = &quot;grey50&quot;) + geom_smooth(se = FALSE, span = 0.20) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; å†¬å­£ï¼ˆ12æœˆè‡³3æœˆï¼‰çš„èˆªç­ç›¸å¯¹è¾ƒå°‘ï¼Œè€Œå¤å­£ï¼ˆ5æœˆè‡³9æœˆï¼‰çš„èˆªç­æ˜æ˜¾æ›´å¤šã€‚å°½ç®¡æˆ‘ä»¬åªæœ‰ä¸€å¹´çš„æ•°æ®ï¼Œæ²¡æœ‰æ›´å¥½åœ°ä½è¯è¿™ä¸ªè§‚ç‚¹ã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡æ€è€ƒè·å–æ½œåœ¨çš„è§£é‡Šã€‚ 19.2.2 å­£èŠ‚æ€§å‘¨å…­æ•ˆåº” ä¹‹å‰æˆ‘ä»¬å‘ç°ä»…å‘¨å…­åœ¨å‘¨é¢„æµ‹æ¨¡å‹å¯¹äºå…¨å¹´æ•°æ®ä¸­ï¼Œå‡ºç°æ˜æ˜¾åå·®ã€‚è¿™é‡Œä¸“é—¨æå–è¿›è¡Œç ”ç©¶ï¼š daily %&gt;% filter(wday == &quot;å‘¨å…­&quot;) %&gt;% # å¦‚æœæ˜¯è‹±è¯­ä½œä¸º R çš„è¯­è¨€è®¾ç½®çš„è¯ï¼šfilter(wday == &quot;Sat&quot;) %&gt;% ggplot(aes(date, n)) + geom_point() + geom_line() + # å¯¹ x è½´çš„ç¼©æ”¾æ¯”ä¾‹è¿›è¡Œè°ƒæ•´ï¼Œå…¶ä¸­æ•°æ®ç±»å‹ä¸º date scale_x_date( name = &quot;æœˆä»½&quot;, # æ¯”ä¾‹å°ºåç§° date_breaks = &quot;1 month&quot;, # é—´éš”ä¸ºä¸€ä¸ªæœˆ date_labels = &quot;%b&quot; # æŒ‡å®šå±•ç¤ºè§„èŒƒä¸ºä»…æ˜¾ç¤ºæœˆ ) åŒæ ·æ˜¯å‘¨å…­ï¼Œä¸åŒçš„å‘¨å…­åé¦ˆçš„æ•°æ®å·®å¼‚å·¨å¤§ï¼å¾ˆéš¾ä¸ä¼šå¼•èµ·æ€€ç–‘ â€”â€” è¿™æ˜¯ç”±æš‘å‡å¼•èµ·çš„ï¼š å½“åœ°äººä»¬é€šå¸¸åœ¨å¤å¤©å»åº¦å‡ï¼Œä¹Ÿä¸ä»‹æ„é€‰æ‹©å‘¨å…­åº¦å‡ã€‚é€‰æ‹©è¿™ä¸ªæ—¶é—´æ®µåº¦å‡ï¼Œå¾ˆå¯èƒ½æ˜¯å› ä¸ºå­©å­ä»¬æ­£å¥½åœ¨æ”¾æš‘å‡ã€‚æ‰€ä»¥æˆ‘ä»¬æœ‰ç†ç”±æ¨æµ‹æš‘å‡æ˜¯ä»6æœˆåˆåˆ°8æœˆä¸‹æ—¬ã€‚ å®é™…æŸ¥è¯¢æ•°æ®æˆ‘ä»¬å¾—åˆ°ï¼Œè¯¥å·åœ¨2013å¹´çš„æš‘å‡å®‰æ’æ˜¯6æœˆ26æ—¥è‡³9æœˆ9æ—¥ã€‚ä½†ä¸ºä»€ä¹ˆæ˜¥å­£çš„å‘¨å…­èˆªç­æ¯”ç§‹å­£å¤šï¼Ÿè°ƒç ”å¾—çŸ¥è®¡åˆ’ç§‹å¤©åº¦å‡çš„å®¶åº­å®åœ¨ä¸å¤ªå¸¸è§ï¼Œå› ä¸ºæ„Ÿæ©èŠ‚å’Œåœ£è¯èŠ‚å‡æœŸçœŸçš„å·²ç»è¶³å¤Ÿé•¿ã€‚ è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¤§è‡´åŒ…å«ä¸‰ä¸ªå­¦æ ¡å­¦æœŸçš„ â€œtermâ€ å˜é‡ï¼Œå¹¶ç”¨ä¸€ä¸ªå‡½æ•°æ¥éªŒè¯æˆ‘ä»¬çš„æ¨è®ºï¼š term &lt;- function(date) { # cut ä¼šåˆ‡å‰²æˆ‘ä»¬æœ¬æœ‰çš„æ•°æ®é›†ï¼Œbreak ç¡®è®¤åˆ‡å‰²ç‚¹ä½ cut(date, breaks = ymd(20130101, 20130605, 20130825, 20140101), # åˆ›å»ºæ—¥æœŸå‘é‡ labels = c(&quot;spring&quot;, &quot;summer&quot;, &quot;fall&quot;) # åˆ‡å‰²åç±»åˆ«çš„å‘½åæ ‡ç­¾ ) } # é€šè¿‡åˆ‡å‰²è·å–å­¦æœŸæ ‡ç­¾ daily &lt;- daily %&gt;% mutate(term = term(date)) daily %&gt;% filter(wday == &quot;å‘¨å…­&quot;) %&gt;% ggplot(aes(date, n, colour = term)) + geom_point(alpha = 1 / 3) + geom_line() + scale_x_date(name = &quot;æœˆä»½&quot;, date_breaks = &quot;1 month&quot;, date_labels = &quot;%b&quot;) ä¸åŒå­£èŠ‚å­¦æœŸä¹‹é—´çš„æ–­å±‚éå¸¸æ˜æ˜¾ï¼å­¦ç”Ÿä¸€æ—¦å¤„äºæš‘å‡ï¼Œå‘¨å…­å‡ºè¡Œåº¦å‡çš„æ•°é‡å°±ä¼šå±…é«˜ä¸ä¸‹ã€‚ æˆ‘ä»¬è¯•ç€æŠŠè¿™ä¸ªè§„å¾‹æ¨å¹¿åˆ°å…¶ä»–æ˜ŸæœŸå‡ ï¼š daily %&gt;% ggplot(aes(wday, n, colour = term)) + geom_boxplot() æ¯ä¸ªæ˜ŸæœŸå‡ éƒ½å‘ˆç°è¿™æ ·çš„è¶‹åŠ¿ï¼šæ˜¥å­£æ•°æ®å¤šå˜ï¼ˆç”±äºèŠ‚æ—¥ï¼Œæ˜¥å­£å¼€å¤´ä¸ç»“å°¾å·®å¼‚è¾ƒå¤§ï¼‰ã€å¤å­£ï¼ˆæ•°æ®ï¼‰èˆªç­åå¤šã€‚å‘¨å…­ç”¨äºæš‘å‡åº¦å‡çš„è¶‹åŠ¿ä¹Ÿå¾ˆæ˜æ˜¾ã€‚ æ—¢ç„¶åŒæ—¶å­˜åœ¨ä¸¤ä¸ªå› ç´ ï¼Œæˆ‘ä»¬ä¸å¦¨å»ºç«‹ä¸¤ä¸ªæ¨¡å‹è¿›è¡Œå¯¹æ¯”ï¼š mod_wday &lt;- lm(n ~ wday, data = daily) mod_wday_term &lt;- lm(n ~ wday * term, data = daily) daily %&gt;% gather_residuals(without_term = mod_wday, with_term = mod_wday_term) %&gt;% ggplot(aes(date, resid, colour = model)) + geom_ref_line(h = 0) + geom_line(alpha = 0.75) å…¶å®è¿™é‡Œå°±å·²ç»è¡¨ç°å‡ºæ¥äº†ï¼ŒåŒ…å« term çš„æ¨¡å‹çš„é¢„æœŸæ•ˆæœæ˜æ˜¾ä¼˜äºä¸åŒ…å«çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¨¡å‹ä¸å®é™…æ•°æ®å¯¹åº”ä¸Šï¼š grid &lt;- daily %&gt;% data_grid(wday, term) %&gt;% gather_predictions( without_term = mod_wday, with_term = mod_wday_term, .pred = &quot;n&quot; ) ggplot(daily, aes(wday, n)) + geom_boxplot() + geom_point(data = grid, colour = &quot;red&quot;) + facet_grid(term ~ model) æˆ‘ä»¬çš„æ¨¡å‹æ€»æ˜¯åœ¨èµ°å‘ä¸€ä¸ªæˆ‘ä»¬æ‰€æœŸæœ›çš„ â€œå¯»å¸¸æ€â€ï¼Œä½†å¾ˆä¸å¹¸å…ƒæ•°æ®æœ‰è®¸å¤šéå¸¸çªå‡ºçš„å¼‚å¸¸å€¼ï¼Œä»¥è‡³äºæˆ‘ä»¬çš„é¢„æµ‹å€¼ä¸ç†æƒ³å€¼ç›¸å»ç”šè¿œã€‚æ‰€ä»¥æˆ‘ä»¬æå‡ºäº†æ–°å‡½æ•° MASS::rlm() æ¥åˆç†å¤„ç†å¼‚å¸¸å€¼ã€‚ mod_wday_term_rlm &lt;- MASS::rlm(n ~ wday * term, data = daily) # ç”¨æ³•ä¸ lm() çœŸçš„å¾ˆç±»ä¼¼ daily %&gt;% gather_residuals(mod_wday_term_rlm, mod_wday_term) %&gt;% ggplot(aes(date, resid)) + geom_hline(yintercept = 0, size = 2, colour = &quot;white&quot;) + geom_line(aes(colour = model), alpha = 0.7) æ–°çš„æ¨¡å‹å¯èƒ½æ›´å®¹æ˜“çœ‹åˆ°é•¿æœŸè¶‹åŠ¿å’Œå¼‚å¸¸å€¼ã€‚ 19.2.3 é’ˆå¯¹ä¸€å¹´ä¸­çš„ä¸åŒæ—¶é—´ç‚¹ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ›´ä¸ºçµæ´»çš„æ¨¡å‹ï¼Œç”¨æ¥æ•è·æˆ‘ä»¬æ„Ÿå…´è¶£çš„å†…å®¹ã€‚ä¸€ä¸ªç®€å•çš„çº¿æ€§è¶‹åŠ¿æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨è‡ªç„¶æ ·æ¡æ¥æ‹Ÿåˆå…¨å¹´çš„å¹³æ»‘æ›²çº¿ï¼š library(splines) # ä¾¿äºä½¿ç”¨è‡ªç„¶æ ·æ¡å‡½æ•° ns() mod &lt;- MASS::rlm(n ~ wday * ns(date, 5), data = daily) # æœ€é«˜ 5 æ¬¡æ–¹ daily %&gt;% data_grid( wday, # é’ˆå¯¹åˆ— wday ç”Ÿæˆæ–°çš„æ— é‡å¤æ•°æ®çš„åŸºç¡€æ•°æ®åˆ— date = seq_range(date, n = 20) # å°† date èŒƒå›´ç­‰è·åˆ‡å‰²å‡º 20 ä¸ªç‚¹ä½ ) %&gt;% add_predictions(mod) %&gt;% ggplot(aes(date, pred, colour = wday)) + geom_line() + geom_point() 19.3 å…³äºè®¡ç®—å˜é‡ åœ¨æˆ‘ä»¬è¯•éªŒå¤šä¸ªæ¨¡å‹å’Œå¯è§†åŒ–æ•ˆæœæ—¶ï¼Œæœ€å¥½å°†å˜é‡çš„åˆ›å»ºæ†ç»‘åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå¦‚ï¼š compute_vars &lt;- function(data) { data %&gt;% mutate( term = term(date), wday = wday(date, label = TRUE) ) } # æˆ–è€…å°†è½¬æ¢ç›´æ¥æ”¾åœ¨æ¨¡å‹å…¬å¼ä¸­ï¼š wday2 &lt;- function(x) wday(x, label = TRUE) mod3 &lt;- lm(n ~ wday2(date) * term(date), data = daily) è¿™ä¸¤ç§æ–¹æ³•éƒ½æ˜¯åˆç†çš„ã€‚ä½†å¦‚æœè¦ç”»å›¾æˆ–æ£€æŸ¥å˜é‡ï¼Œæ˜¾å¼è½¬æ¢å¯èƒ½æ›´å¥½ã€‚ä½†è¯·ä¸è¦éšæ„ä½¿ç”¨è¿”å›å¤šä¸ªåˆ—çš„è½¬æ¢ï¼ˆå¦‚æ ·æ¡æ›²çº¿ï¼‰ã€‚ 19.4 æœ‰å…³æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ æˆ‘ä»¬åªæ˜¯è§¦åŠäº†å»ºæ¨¡è¡¨å±‚çš„ä¸€äº›ä¸œè¥¿ï¼Œä¹Ÿè·å¾—äº†ä¸€äº›ç®€å•é€šç”¨çš„å·¥å…·ï¼Œç”¨äºæ”¹å–„è‡ªå·±çš„æ•°æ®åˆ†æã€‚ ä»ç®€å•å¼€å§‹æ˜¯å¯ä»¥çš„ï¼ä½†æ­£å¦‚æ‰€çœ‹åˆ°çš„é‚£æ ·ï¼Œå³ä½¿æ˜¯éå¸¸ç®€å•çš„æ¨¡å‹ï¼Œä¹Ÿä¼šå¯¹ä½ æ¢³ç†å˜é‡ä¹‹é—´ç›¸äº’ä½œç”¨çš„èƒ½åŠ›äº§ç”Ÿå·¨å¤§çš„å½±å“ã€‚ ä¸‹é¢æœ‰ä¸€äº›å¾ˆæ£’çš„ä¹¦ç±ï¼›å»ºæ¨¡ç¡®å®å€¼å¾—ä¸€æœ¬ä¹¦ï¼Œæ‰€ä»¥æˆ‘å¼ºçƒˆå»ºè®®ä½ è‡³å°‘è¯»å…¶ä¸­çš„ä»»æ„ä¸€æœ¬ï¼š Statistical Modeling: A Fresh Approach by Danny Kaplan ğŸ‘‰ ä¹¦æœ¬å®˜ç½‘ï¼ˆå·²æŒ‚ï¼Œä½†ä¿æœ‰ Archive å†å²ç‰ˆæœ¬ï¼‰ ğŸ‘‰ ç”µå­ç‰ˆè´­ä¹°ï¼ˆäºšé©¬é€Šï¼‰ ğŸ‘‰ åœ¨çº¿é˜…è¯» æœ¬ä¹¦æ¸©å’Œåœ°ï¼ˆã€‚ï¼Ÿï¼‰ä»‹ç»äº†å»ºæ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­å¹¶è¡Œæ„å»ºç›´è§‰ï¼Œæ•°å­¦å·¥å…·å’Œä¸€äº›å…³äº R çš„å°æŠ€å·§ã€‚åŒæ—¶è¿™æœ¬ä¹¦å–ä»£äº†ä¼ ç»Ÿçš„ â€œç»Ÿè®¡å­¦å¯¼è®ºâ€ è¯¾ç¨‹ï¼Œæä¾›äº†ä¸€ä¸ªå…¨æ–°çš„ä¸æ•°æ®ç§‘å­¦ç›¸å…³çš„è¯¾ç¨‹ã€‚ An Introduction to Statistical Learning by Gareth James, Daniela Witten, Trevor Hastie ğŸ‘‰ ä½œè€…å®˜ç½‘ | ä¹¦æœ¬å®˜ç½‘ ğŸ‘‰ ç”µå­ç‰ˆä¸‹è½½ï¼šPDF | EPUB ğŸ‘‰ æ•™å­¦èµ„æºæ–‡ä»¶ä¸‹è½½ æœ¬ä¹¦ä»‹ç»äº†ä¸€ç³»åˆ—ç°ä»£å»ºæ¨¡æŠ€æœ¯ï¼Œç»Ÿç§°ä¸ºç»Ÿè®¡å­¦ä¹ ã€‚ è¦æ›´æ·±å…¥åœ°äº†è§£æ¨¡å‹èƒŒåçš„æ•°å­¦åŸç†ï¼Œåˆ™è¯·é˜…è¯»ï¼š The Elements of Statistical Learning by Trevor Hastie, Robert Tibshirani, and Jerome Friedmanï¼ˆç”µå­ç‰ˆä¸‹è½½ï¼šä¸€ä»£ç‰ˆæœ¬ | äºŒä»£ç‰ˆæœ¬ï¼‰ Applied Predictive Modeling by Max Kuhn and Kjell Johnson ğŸ‘‰ ä¹¦æœ¬å®˜ç½‘ ğŸ‘‰ ç”µå­ç‰ˆè´­ä¹°ï¼ˆäºšé©¬é€Šï¼‰ æœ¬ä¹¦æ›´å¤šæ˜¯é…å¥—äº caret åŒ…ï¼Œä¸ºåº”å¯¹ç°å®ç”Ÿæ´»ä¸­çš„é¢„æµ‹å»ºæ¨¡æŒ‘æˆ˜æä¾›äº†ç›¸å½“ä¸°å¯Œçš„å®ç”¨å·¥å…·ã€‚ ä¸€ä¸ªå¯èƒ½å¯¹ä½ æœ‰ç”¨çš„ä¸‹è½½é›†åˆï¼šTrevor Hastie - Publications (su.domains) "],["introduction-1.html", "Chapter 20 Introduction", " Chapter 20 Introduction åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¹ äº†è®¸å¤šå°†æ•°æ®è¾“å…¥ R çš„å·¥å…·ï¼Œå¹¶å°†å…¶æ•´ç†æˆæ–¹ä¾¿åˆ†æçš„æ ¼å¼ï¼Œç„¶åé€šè¿‡è½¬æ¢ã€å¯è§†åŒ–å’Œå»ºæ¨¡æ¥äº†è¿™äº›æ•°æ®ã€‚ç„¶è€Œå¦‚æœä½ ä¸ä¼šåˆ†äº«çš„è¯ï¼Œè¿™ä¸€åˆ‡éƒ½åªæ˜¯å­¤èŠ³è‡ªèµï¼ä½ éœ€è¦ä¼ è¾¾ä½ çš„ç»“æœã€‚ data-science-communicate åœ¨ R Markdown ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥å­¦ä¹  R Markdown è¿™ç§é›†æˆæ–‡æœ¬ã€ä»£ç å’Œç»“æœçš„å·¥å…·ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ç¬”è®°æœ¬æ¨¡å¼ä¸‹ä½¿ç”¨ R Markdown è¿›è¡Œåˆ†æå¸ˆå¯¹åˆ†æå¸ˆçš„æ²Ÿé€šï¼Œä¹Ÿå¯ä»¥åœ¨æŠ¥å‘Šæ¨¡å¼ä¸‹ä½¿ç”¨åˆ†æå¸ˆå¯¹å†³ç­–è€…çš„æ²Ÿé€šã€‚ åœ¨ Graphics for communication ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•å°†æ¢ç´¢æ€§å›¾å½¢è½¬æ¢ä¸ºè§£é‡Šæ€§å›¾å½¢ï¼Œè¿™äº›å›¾å½¢å¯ä»¥è¾…åŠ©æ–°æ‰‹ï¼ˆé—¨å¤–æ±‰ï¼‰å°½å¯èƒ½å¿«é€Ÿè½»æ¾åœ°äº†è§£æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚ åœ¨ R Markdown æ ¼å¼ ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ä½¿ç”¨ R Markdown ç”Ÿæˆå…¶ä»–æ ¼å¼çš„æ–‡æ¡£ï¼ŒåŒ…æ‹¬ä»ªè¡¨ç›˜ã€ç½‘ç«™å’Œç”µå­ä¹¦ã€‚ æˆ‘ä»¬å°†å­¦ä¹ åˆ° R Markdown å·¥ä½œæµç¨‹ï¼Œä»ä¸­å°†äº†è§£ â€œåˆ†æç¬”è®°æœ¬â€ï¼Œä»¥åŠç³»ç»Ÿå¦‚ä½•è®°å½•æˆ‘ä»¬çš„æˆåŠŸå’Œå¤±è´¥ï¼Œä»¥ä¾¿ä»ä¸­å­¦ä¹ æ€»ç»“ã€‚ "],["r-markdown.html", "Chapter 21 R Markdown 21.1 R Markdown åŸºç¡€çŸ¥è¯† 21.2 ä½¿ç”¨ Markdown ä¹¦å†™å¯Œæ–‡æœ¬ 21.3 ä»£ç å— 21.4 YAML æ ‡å¤´", " Chapter 21 R Markdown åœ¨ R ä¸­ï¼ŒR Markdown ä¸ºæ•°æ®ç§‘å­¦æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„åˆ›ä½œæ¡†æ¶ï¼Œç»“åˆäº†ä»£ç ã€ç»“æœå’Œæ–‡æœ¬åˆ›ä½œã€‚ åŒæ—¶è¿™ç§æ–‡æ¡£å®Œå…¨å¯å¤åˆ¶ï¼Œå¹¶æ”¯æŒæ•°åç§å¯¼å‡ºæ ¼å¼ï¼Œå¦‚ pdfã€docxã€pptx ç­‰ã€‚ R Markdown æ–‡ä»¶æ—¨åœ¨ä»¥ä¸‰ç§æ–¹å¼ä½¿ç”¨ï¼š - ä¸ºäº†ä¸å†³ç­–è€…æ²Ÿé€šï¼Œä»–ä»¬å¸Œæœ›çœ‹åˆ°ç»“è®ºï¼Œè€Œä¸æ˜¯åˆ†æèƒŒåçš„ä»£ç ã€‚ - ä¸å…¶ä»–æ•°æ®ç§‘å­¦å®¶åˆä½œï¼Œæ–¹ä¾¿å¿«é€Ÿå¾—çŸ¥ç»“è®ºå’Œå¾—å‡ºè¿™äº›ç»“è®ºçš„è¿‡ç¨‹ï¼ˆå³ä»£ç ï¼‰ã€‚ - ä½œä¸ºåšæ•°æ®ç§‘å­¦çš„ç¯å¢ƒï¼Œä½œä¸ºç°ä»£å®éªŒå®¤ç¬”è®°æœ¬ï¼Œä½ ä¸ä»…å¯ä»¥æ•æ‰ä½ åšäº†ä»€ä¹ˆï¼Œè¿˜å¯ä»¥æ•æ‰ä½ çš„æƒ³æ³•ã€‚ 21.1 R Markdown åŸºç¡€çŸ¥è¯† ä¸€ä¸ªç®€å•çš„ .Rmd æ–‡ä»¶åº”è¯¥åŒ…å«ï¼š å¯é€‰çš„æ ‡å¤´ï¼š --- title: &quot;Diamond sizes&quot; date: 2016-08-25 output: html_document --- ä¸€äº›è¢«æ ‡è¯†ç¬¦åŒ…å›´çš„ä»£ç å—ï¼š ```{R setup, include = FALSE} library(ggplot2) library(dplyr) smaller &lt;- diamonds %&gt;% filter(carat &lt;= 2.5) ``` æ··åˆäº†ç®€å•æ–‡æœ¬æ ¼å¼çš„æ–‡æœ¬ï¼ˆMarkdown è¯­æ³•ï¼‰ã€‚ å½“ä½ å¼€ä¸€ä¸ª .Rmd æ–‡ä»¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªç¬”è®°æœ¬ç•Œé¢ï¼Œå…¶ä»£ç å’Œè¾“å‡ºäº¤ç»‡åœ¨ä¸€èµ·ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å•å‡»è¿è¡Œå›¾æ ‡ï¼ˆçœ‹èµ·æ¥åƒå—é¡¶éƒ¨çš„æ’­æ”¾æŒ‰é’®ï¼‰æˆ–æŒ‰ Cmd/Ctrl + Shift + Enter æ¥è¿è¡Œæ¯ä¸ªä»£ç å—ã€‚ diamond-sizes-notebook è¦ç”ŸæˆåŒ…å«æ‰€æœ‰æ–‡æœ¬ã€ä»£ç å’Œç»“æœçš„å®Œæ•´æŠ¥å‘Šï¼Œè¯·å•å‡» â€œKnit Rmdâ€ æˆ–æŒ‰Cmd/Ctrl + Shift + Kã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¥ç¼–ç¨‹æ–¹å¼ä½¿ç”¨ï¼Œå¦‚ rmarkdown::render(\"1-example.Rmd\")ã€‚è¿™å°†æ˜¾ç¤ºæŸ¥çœ‹å™¨çª—æ ¼ä¸­çš„æŠ¥å‘Šï¼Œå¹¶åˆ›å»ºä¸€ä¸ªè‡ªåŒ…å«çš„ HTML æ–‡ä»¶ï¼Œä»¥ä¾¿ä¸ä»–äººå…±äº«ã€‚ å½“æˆ‘ä»¬ç”Ÿæˆæ–‡æ¡£æ—¶ï¼ŒR Markdown ä¼šå‘é€ Rmd æ–‡ä»¶åˆ° knitrï¼Œå®ƒæ‰§è¡Œæ‰€æœ‰ä»£ç å—ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ Markdown æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬ä»£ç åŠå…¶è¾“å‡ºã€‚éšåå…¶æ–‡æ¡£å°†è¢« pandoc è½¬æ¢æˆä»»ä½•ä½ æƒ³è¦çš„æ–‡ä»¶æ ¼å¼ã€‚ rmarkdownflow 21.2 ä½¿ç”¨ Markdown ä¹¦å†™å¯Œæ–‡æœ¬ Markdown æ˜¯ä¸€ç»„ç”¨äºè®¾ç½®çº¯æ–‡æœ¬æ–‡ä»¶æ ¼å¼çš„è½»é‡çº§çº¦å®šï¼Œå…¶è®¾è®¡æ˜“äºé˜…è¯»å’Œç¼–å†™ï¼Œä¹Ÿå¾ˆå®¹æ˜“å­¦ä¹ ã€‚ è¿™é‡Œå¼•ç”¨ä¸€ä¸‹æˆ‘çš„åšå®¢ï¼šMarkdown è¯­æ³•ä¸å­¦ä¹ è®°å½• 21.3 ä»£ç å— è¦åœ¨ R Markdown æ–‡æ¡£ä¸­è¿è¡Œä»£ç ï¼Œæˆ‘ä»¬éœ€è¦æ’å…¥ä¸€ä¸ªå—ã€‚æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼š 1. é”®ç›˜å¿«æ·é”® Cmd/Ctrl + Alt + Iã€‚ 2. ç¼–è¾‘å™¨å·¥å…·æ ä¸­çš„ â€œæ’å…¥â€ æŒ‰é’®å›¾æ ‡ã€‚ 3. é€šè¿‡æ‰‹åŠ¨é”®å…¥å—åˆ†éš”ç¬¦ã€‚ æ˜¾ç„¶ï¼Œæˆ‘å»ºè®®ä½ å­¦ä¹ é”®ç›˜å¿«æ·é”®ã€‚ä»é•¿è¿œæ¥çœ‹ï¼Œè¿™å°†ä¸ºæˆ‘ä»¬èŠ‚çœå¤§é‡æ—¶é—´ï¼ ä»£ç å—è¿˜å¯ä»¥å‘½åï¼Œå¦‚ {R by-name}ã€‚å¼•ç´¢åŒæ ·ä¼šæ£€æµ‹å¹¶å±•ç¤ºï¼Œæ–¹ä¾¿ä½ å¿«é€Ÿè·³è½¬ã€‚åŒæ—¶ä½ ä¹Ÿå¯ä»¥ä¸ºå®ƒçš„åŠŸèƒ½åšä¸€äº›é™åˆ¶ã€‚ä¸‹é¢æ˜¯ä¸€äº›é…ç½®é¡¹ï¼ˆå¦‚æœéœ€è¦å½“ç„¶å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªé…ç½®é¡¹ï¼‰ï¼š é€‰æ‹© è¿è¡Œä»£ç  æ˜¾ç¤ºä»£ç  è¾“å‡º è¿è¡Œè¿‡ç¨‹ æç¤º è­¦å‘Š eval = FALSE Ã— Ã— Ã— Ã— Ã— include = FALSE Ã— Ã— Ã— Ã— Ã— echo = FALSE Ã— results = \"hide\" Ã— fig.show = \"hide\" Ã— message = FALSE Ã— warning = FALSE Ã— å¦‚æœä½ éœ€è¦å±•ç¤º R å†…çš„æ•°æ®ï¼ˆå¦‚ tibbleï¼‰ï¼Œè¯·ä½¿ç”¨ knitr::kableï¼š knitr::kable( mtcars[1:5, ], caption = &quot;A knitr kable.&quot; ) è¡¨ 21.1: A knitr kable. mpg cyl disp hp drat wt qsec vs am gear carb Mazda RX4 21.0 6 160 110 3.90 2.620 16.46 0 1 4 4 Mazda RX4 Wag 21.0 6 160 110 3.90 2.875 17.02 0 1 4 4 Datsun 710 22.8 4 108 93 3.85 2.320 18.61 1 1 4 1 Hornet 4 Drive 21.4 6 258 110 3.08 3.215 19.44 1 0 3 1 Hornet Sportabout 18.7 8 360 175 3.15 3.440 17.02 0 0 3 2 é€šå¸¸ï¼Œæ–‡æ¡£çš„æ¯æ¬¡ç”Ÿæˆéƒ½ä»åˆå§‹ç¯å¢ƒå¼€å§‹ã€‚è¿™éå¸¸é€‚åˆé‡ç°ï¼Œä½†å¦‚æœä½ æœ‰ä¸€äº›éœ€è¦å¾ˆé•¿æ—¶é—´çš„è®¡ç®—ï¼Œé‚£å¯èƒ½ä¼šå¾ˆç—›è‹¦ã€‚ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ cache = TRUEã€‚è®¾ç½®åï¼Œè¿™å°†æŠŠå—çš„è¾“å‡ºä¿å­˜åˆ°ç£ç›˜ä¸Šä¸€ä¸ªç‰¹åˆ«å‘½åçš„æ–‡ä»¶ã€‚åœ¨éšåçš„è¿è¡Œä¸­ï¼Œknitr å°†æ£€æŸ¥ä»£ç æ˜¯å¦å·²æ›´æ”¹ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå®ƒå°†é‡ç”¨ç¼“å­˜çš„ç»“æœã€‚ {R raw_data} rawdata &lt;- readr::read_csv(&quot;a_very_large_file.csv&quot;) ``` {R processed_data, cache = TRUE, dependson = &quot;raw_data&quot;} processed_data &lt;- rawdata %&gt;% filter(!is.na(import_var)) %&gt;% mutate(new_variable = complicated_transformation(x, y, z)) ç¼“å­˜ processed_data å—æ„å‘³ç€å¦‚æœ dplyr ç®¡é“æ›´æ”¹ï¼Œå®ƒå°†è¢«é‡æ–°è¿è¡Œï¼Œä½†å¦‚æœread_csv()è°ƒç”¨æ›´æ”¹ï¼Œå®ƒå°†ä¸ä¼šè¢«é‡æ–°è¿è¡Œã€‚æ‚¨å¯ä»¥ä½¿ç”¨ dependsonå—é€‰é¡¹æ¥é¿å…è¿™ä¸ªé—®é¢˜ï¼š {R processed_data, cache = TRUE, dependson = &quot;raw_data&quot;} processed_data &lt;- rawdata %&gt;% filter(!is.na(import_var)) %&gt;% mutate(new_variable = complicated_transformation(x, y, z)) éšç€ç¼“å­˜ç­–ç•¥å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œæœ€å¥½å®šæœŸä½¿ç”¨ knitr::clean_cache() æ¸…é™¤æ‰€æœ‰ç¼“å­˜ã€‚ å¯¹äºåŒºå—è¾“å‡ºæ ¼å¼ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€äº›å…¨å±€é€‰é¡¹ï¼š knitr::opts_chunk$set( comment = &quot;#&gt;&quot;, collapse = TRUE ) # æˆ–æ˜¯å…¨å±€ç¦æ­¢æ˜¾ç¤ºä»£ç  knitr::opts_chunk$set( echo = FALSE ) æˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ç§ç®€å•çš„ä»£ç æ ¼å¼ï¼Œä½¿ç”¨ â€œrâ€ æ¥å±•ç¤ºä¸€äº›ç®€å•çš„æ–‡æœ¬ä¿¡æ¯ã€‚ æœ‰æ—¶æ–‡æœ¬ä¿¡æ¯åƒæ•°å­—ä¸€ç±»ï¼Œå¯èƒ½ä¸é‚£ä¹ˆå®¹æ˜“å±•ç¤ºï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ format() å‡½æ•°ï¼š comma &lt;- function(x) format(x, digits = 2, big.mark = &quot;,&quot;) comma(3452345) #&gt; [1] &quot;3,452,345&quot; comma(.12358124331) #&gt; [1] &quot;0.12&quot; 21.4 YAML æ ‡å¤´ æ ‡å¤´æœ‰å¾ˆå¤šç”¨å¤„ï¼Œå¦‚ä½œä¸ºå…¨å±€å‚æ•°ï¼š --- output: html_document params: my_class: &quot;suv&quot; # ä¹Ÿå¯ä»¥ç”¨ !r å†™æˆè¡¨è¾¾å¼ start: !r lubridate::ymd(&quot;2015-01-01&quot;) --- è°ƒç”¨æ—¶ä½¿ç”¨å½¢å¦‚ params$my_class å³å¯ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨ç”Ÿæˆæ—¶è¿½åŠ  params è¿›è¡Œä¿®æ”¹ï¼š rmarkdown::render(&quot;fuel-economy.Rmd&quot;, params = list(my_class = &quot;suv&quot;)) pandoc ä¹Ÿèƒ½ç”Ÿæˆä¸åŒæ ·å¼çš„å¼•æ–‡å’Œä¹¦ç›®ï¼ˆå†™é…ç½®åˆ° Rmd æ–‡ä»¶çš„ fontmatter ä¸­ï¼‰ï¼š bibliography: rmarkdown.bib æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è®¸å¤šå¸¸è§çš„ä¹¦ç›®æ ¼å¼ï¼ŒåŒ…æ‹¬ BibLaTeXï¼ŒBibTeXï¼Œendnoteï¼Œmedlineã€‚ "],["graphics-for-communication.html", "Chapter 22 Graphics for communication 22.1 å›¾å¤–æ ‡ç­¾ 22.2 å›¾å†…æ ‡æ³¨ 22.3 æ¯”ä¾‹å°ºä¸å‚è€ƒ", " Chapter 22 Graphics for communication åœ¨ä¹‹å‰çš„æ•°æ®åˆ†æä¸­ï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨ç»˜å›¾ä½œä¸ºä¸€ç§å¼ºæœ‰åŠ›çš„ç†è§£æ•°æ®çš„å·¥å…·ã€‚å½“æˆ‘ä»¬è¿›è¡Œç»˜å›¾å¯è§†åŒ–åˆ†ææ—¶ï¼Œä¼šä¸ºæ¯ä¸ªç»†èŠ‚åšäº†ä¸€ä¸ªé’ˆå¯¹æ€§çš„åˆ†æï¼Œæ–¹ä¾¿æˆ‘ä»¬å¿«é€ŸæŸ¥çœ‹å’Œåˆ†æå®ƒä»¬ï¼Œç„¶ååˆ†æä¸‹ä¸€ä¸ªç»†èŠ‚ã€‚åœ¨å¤§å¤šæ•°åˆ†æè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸ä¸€ä¼šå°±ä¼šäº§ç”Ÿæ•°åæˆ–æ•°ç™¾å¼  ggplot å›¾ï¼Œè€Œä¸”å…¶ä¸­å¤§éƒ¨åˆ†ä¼šç«‹å³è¢«æ‰”æ‰ã€‚ å½“æˆ‘ä»¬å·²ç»æ·±åˆ»è®¤è¯†ç†Ÿæ‚‰äº†æ•°æ®ï¼ˆå¦‚ flightsï¼‰åï¼Œæ›´å¤šè¦åšçš„æ˜¯å°†è‡ªå·±çš„ç†è§£ä¼ è¾¾ç»™å…¶ä»–äººã€‚ç„¶è€Œå“ªäº›å—ä¼—äººç¾¤å¯èƒ½ä¸é‚£ä¹ˆé‡è§†å…¶èƒŒæ™¯çŸ¥è¯†ï¼Œä¹Ÿä¸ä¼šæ·±å…¥ç ”ç©¶æ•°æ®ã€‚ä¸ºäº†å¸®åŠ©å…¶ä»–äººå¿«é€Ÿå»ºç«‹è‰¯å¥½çš„æ•°æ®å¿ƒç†æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦æ·±å…¥å­¦ä¹  ggplot2 ä¸ºæˆ‘ä»¬æä¾›çš„ä¸€äº›ç‰¹æ®Šå·¥å…·ï¼Œå› ä¸ºåœ¨å¯å±•ç¤ºæ€§å’Œä¼˜åŒ–æ€§ä¸Šï¼Œå®ƒå¸¦æ¥çš„å®é™…æ€§è¿›å±•ï¼Œå®åœ¨æ˜¯å¤ªå¤šäº†ã€‚ library(tidyverse) 22.1 å›¾å¤–æ ‡ç­¾ è¯•å›¾å°†æ¢ç´¢æ€§å›¾å½¢è½¬æ¢ä¸ºè¯´æ˜æ€§å›¾å½¢æ—¶ï¼Œæœ€ç®€å•çš„èµ·ç‚¹æ˜¯èµ·ä¸ªä¸€çœ¼ä¸çœŸçš„æ ‡é¢˜ã€‚labs çš„ title é…ç½®é¡¹å°±æ˜¯åšè¿™ä¸ªçš„ï¼š ggplot(mpg, aes(displ, hwy)) + geom_point(aes(color = class)) + geom_smooth(se = FALSE) + labs(title = &quot;Fuel efficiency generally decreases with engine size&quot;) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; æ ‡é¢˜çš„ç›®çš„ä¸€èˆ¬æ˜¯æ€»ç»“æœ€ä¸»è¦çš„å‘ç°ã€‚é¿å…ä½¿ç”¨ä»…æè¿°æƒ…èŠ‚çš„æ ‡é¢˜ï¼Œå¦‚ â€œå‘åŠ¨æœºæ’é‡ä¸ç‡ƒæ²¹ç»æµæ€§çš„æ•£ç‚¹å›¾â€ã€‚ æ­¤å¤–è¿˜æœ‰ä¸€äº›å°æ ‡é¢˜ä½ å¯èƒ½ç”¨å¾—ä¸Šï¼š subtitleï¼šå‰¯æ ‡é¢˜ï¼Œåœ¨æ ‡é¢˜ä¸‹æ–¹ä»¥å°å·å­—ä½“æ·»åŠ å…¶ä»–è¯¦ç»†ä¿¡æ¯ã€‚ captionï¼šåœ¨ç»˜å›¾çš„å³ä¸‹è§’æ·»åŠ æ–‡æœ¬ï¼Œé€šå¸¸ç”¨äºæè¿°æ•°æ®æºã€‚ ggplot(mpg, aes(displ, hwy)) + geom_point(aes(color = class)) + geom_smooth(se = FALSE) + labs( title = &quot;Fuel efficiency generally decreases with engine size&quot;, subtitle = &quot;Two seaters (sports cars) are an exception because of their light weight&quot;, caption = &quot;Data from fueleconomy.gov&quot; ) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; æˆ‘ä»¬ä¹Ÿå¯ä»¥æ›¿æ¢è½´å’Œå›¾ä¾‹æ ‡é¢˜ã€‚ä¸è¿‡æœ€å¥½å°†ç®€çŸ­çš„å˜é‡åç§°æ›¿æ¢ä¸ºæ›´è¯¦ç»†çš„æè¿°ï¼Œå¹¶åŒ…å«å•ä½ï¼š ggplot(mpg, aes(displ, hwy)) + geom_point(aes(colour = class)) + geom_smooth(se = FALSE) + labs( x = &quot;Engine displacement (L)&quot;, y = &quot;Highway fuel economy (mpg)&quot;, colour = &quot;Car type&quot; ) #&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39; å¯¹äºæˆ‘ä»¬åœ¨å»ºæ¨¡æ—¶å¸¸å¸¸ä½¿ç”¨åˆ°çš„æ±‚å¯¹æ•°ç­‰è¡¨è¾¾å¼ï¼Œå…¶å®ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨æ•°å­¦æ–¹ç¨‹å¼ä»£æ›¿æ–‡æœ¬å­—ç¬¦ä¸²çš„ã€‚åªéœ€ç”¨ä¸Š quote() å³å¯å®Œæˆè½¬æ¢ï¼ˆæœ‰ç‚¹åƒåœ¨ markdown é‡Œæ’å…¥ Latex å…¬å¼å†…å‘³ï¼Œä½†åœ¨ä¹¦å†™ä¸Šè¦ç®€å•ä¸€äº›ï¼‰ï¼š df &lt;- tibble( x = runif(10), y = runif(10) ) ggplot(df, aes(x, y)) + geom_point() + labs( x = quote(sum(x[i] ^ 2, i == 1, n)), y = quote(alpha + beta + frac(delta, theta)) ) 22.2 å›¾å†…æ ‡æ³¨ é™¤äº†æ ‡è®°å›¾çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ä¹‹å¤–ï¼Œæ ‡è®°å•ä¸ªè§‚æµ‹å€¼æˆ–è§‚æµ‹å€¼ç»„é€šå¸¸ä¹Ÿå¾ˆæœ‰ç”¨ã€‚ best_in_class &lt;- mpg %&gt;% group_by(class) %&gt;% filter(row_number(desc(hwy)) == 1) # ç­›é€‰å‡ºè¡Œåä¸º 1 çš„ï¼Œå³æ¯ç§ç±»å‹çš„ç¬¬ä¸€ä¸ªæ•°æ® ggplot(mpg, aes(displ, hwy)) + geom_point(aes(colour = class)) + geom_text(aes(label = model), data = best_in_class) äº‹æƒ…å¥½åƒå¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•â€¦ æ ‡ç­¾å½¼æ­¤é‡å ï¼Œå¹¶ä¸”ä¸ç‚¹ä¹Ÿé‡å åœ¨ä¸€èµ·ã€‚è¿™å¾ˆéš¾é˜…è¯»ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ‡æ¢åˆ°å“ªä¸ªåœ¨æ–‡æœ¬åé¢ç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢ï¼Œå¹¶å°†æ ‡ç­¾ç§»åŠ¨åˆ°ç›¸åº”ç‚¹çš„ä¸Šæ–¹æ¥è§£å†³é—®é¢˜ï¼š ggplot(mpg, aes(displ, hwy)) + geom_point(aes(colour = class)) + geom_label(aes(label = model), data = best_in_class, nudge_y = 2, alpha = 0.5) # geom_label() èƒ½é¿å…ä¹‹é—´é‡å ï¼Œnudge_y æˆ– nudge_x ç”¨äºè®¾ç½®åç§»é‡ï¼Œéµå¾ªå¹³é¢åæ ‡ç³»æ³•åˆ™ã€‚æ­¤å¤–å‡å°‘ä¸é€æ˜åº¦ä¹Ÿæ˜¯ä¸äºŒä½³é€‰ è¿™æœ‰ç‚¹å¸®åŠ©ï¼Œä½†ä»”ç»†è§‚å¯Ÿï¼Œå…¶å®æ ‡ç­¾ä¹‹é—´è¿˜æ˜¯ä¼šæœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹é‡å å½±å“ã€‚ç”Ÿè¿™ç§æƒ…å†µæ˜¯å› ä¸ºç´§å‡‘å‹å’Œæ¬¡ç´§å‡‘å‹ç±»åˆ«ä¸­æœ€ä½³æ±½è½¦çš„é«˜é€Ÿå…¬è·¯é‡Œç¨‹å’Œæ’é‡å®Œå…¨ç›¸åŒã€‚å½“ä½ æ— æ³•é€šè¿‡å¯¹æ¯ä¸ªæ ‡ç­¾åº”ç”¨ç›¸åŒçš„è½¬æ¢æ¥è§£å†³è¿™äº›é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ ggrepel::geom_label_repel()ã€‚å®ƒå°†è‡ªåŠ¨è°ƒæ•´æ ‡ç­¾ï¼Œä½¿å®ƒä»¬ä¸ä¼šé‡å ï¼š ggplot(mpg, aes(displ, hwy)) + geom_point(aes(colour = class)) + geom_point(size = 3, shape = 1, data = best_in_class) + ggrepel::geom_label_repel(aes(label = model), data = best_in_class) äººå·¥æ™ºéšœæ ‡ç­¾çœŸå¥½ç”¨ã€‚æ³¨æ„è¿™é‡Œæ·»åŠ äº†å¤–åœˆå¤§å·çš„ç©ºå¿ƒç‚¹ï¼Œä»¥çªå‡ºæ˜¾ç¤ºæ‰€æ ‡è®°çš„ç‚¹ã€‚ æ­¤å¤–ä¹Ÿå¯ä»¥ç›´æ¥æŠŠå›¾ä¾‹æŒªåˆ°å›¾ä¸Šå»åšæ ‡æ³¨ã€‚è¿™ç§æ–¹æ³•å¥½åƒå¹¶ä¸ä¼˜é›…ï¼Œä½†ç¡®å®èƒ½è§£å†³é—®é¢˜è€Œä¸”ä¹Ÿä¸ç®—å¾ˆéš¾ç”¨ï¼š class_avg &lt;- mpg %&gt;% group_by(class) %&gt;% summarise( displ = median(displ), hwy = median(hwy) ) ggplot(mpg, aes(displ, hwy, colour = class)) + ggrepel::geom_label_repel(aes(label = class), data = class_avg, label.size = 0, # æŒ‡æ˜æ ‡ç­¾ä¸å ä½ segment.color = NA ) + geom_point() + theme(legend.position = &quot;none&quot;) # éšè—æ—è¾¹çš„å›¾ä¾‹ æ­¤å¤–æˆ‘ä»¬ç”šè‡³å¯ä»¥åœ¨å›¾å†…åŠ ä¸€äº›ä¿¡æ¯è¯´æ˜ï¼š label &lt;- mpg %&gt;% summarise( displ = max(displ), hwy = max(hwy), label = &quot;Increasing engine size is \\nrelated to decreasing fuel economy.&quot; # æ³¨æ„ label åœ¨è¿™é‡Œä¹¦å†™ä¼šè‡ªåŠ¨æ·»åŠ æ–°åˆ— ) # å½“ç„¶å•çº¯å†™ä¸ª label ä¹Ÿå¯ä»¥ä¸è¦é‚£äº›æ•°æ® label &lt;- tibble( displ = Inf, hwy = Inf, label = &quot;Increasing engine size is \\nrelated to decreasing fuel economy.&quot; ) ggplot(mpg, aes(displ, hwy)) + geom_point() + geom_text(aes(label = label), data = label, vjust = &quot;top&quot;, hjust = &quot;right&quot;) # vjust å’Œ hjust ç”¨äºè¯´æ˜åœ¨ç«–ç›´æ–¹å‘å’Œæ°´å¹³æ–¹å‘çš„ç›¸å¯¹ä½ç½® é™¤äº†æ‰‹åŠ¨ç”¨æ¢è¡Œç¬¦å°†å†…å®¹åˆ†è§£ä¸ºå¤šè¡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªåŠ¨æ·»åŠ æ¢è¡Œç¬¦ï¼Œç»™å®šæ¯è¡Œæ‰€éœ€çš„å­—ç¬¦æ•°å³å¯ï¼š &quot;Increasing engine size is related to decreasing fuel economy.&quot; %&gt;% stringr::str_wrap(width = 40) %&gt;% # ä»¥è¡Œå®½åˆ†å‰²å¹¶æ·»åŠ æ¢è¡Œç¬¦ writeLines() #&gt; Increasing engine size is related to #&gt; decreasing fuel economy. å¯¹äºåˆšåˆšçš„ hjust å’Œ vjust å‚æ•°ï¼Œæˆ‘ä»¬è¿™é‡Œç»™å‡ºä¸€ä¸ªå›¾ğŸ‘‡ï¼ˆå¥½è€¶ï¼‰ï¼š â€œhjustâ€ å’Œ â€œvjustâ€ çš„æ‰€æœ‰ä¹ç§ç»„åˆ 22.3 æ¯”ä¾‹å°ºä¸å‚è€ƒ 22.3.1 æ¯”ä¾‹å°º äº‹å®ä¸Šåœ¨ä½ ç»˜åˆ¶å›¾æ—¶ï¼Œggplot ä¼šè‡ªåŠ¨ä¸ºä½ å‡†å¤‡å¥½äº†æ¯”ä¾‹å°ºã€‚å¦‚ï¼š ggplot(mpg, aes(displ, hwy)) + geom_point(aes(colour = class)) # ggplot ä¼šè‡ªåŠ¨å¸®ä½ è¡¥å…¨æˆè¿™æ ·ï¼š ggplot(mpg, aes(displ, hwy)) + geom_point(aes(colour = class)) + scale_x_continuous() + scale_y_continuous() + scale_colour_discrete() ä¸è¿‡ä¹Ÿæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„æ‹‰ã€‚ ggplot(mpg, aes(displ, hwy)) + geom_point() + scale_y_continuous(breaks = seq(15, 40, by = 5)) å»æ‰ä¹Ÿä¸æ˜¯ä¸å¯ä»¥ï¼š ggplot(mpg, aes(displ, hwy)) + geom_point() + scale_x_continuous(labels = NULL) + scale_y_continuous(labels = NULL) labels çš„å¦ä¸€ä¸ªç”¨é€”æ˜¯å½“æˆ‘ä»¬çš„æ•°æ®ç‚¹ç›¸å¯¹è¾ƒå°‘å¹¶ä¸”æƒ³è¦çªå‡ºæ˜¾ç¤ºè§‚æµ‹å€¼å‘ç”Ÿçš„ç¡®åˆ‡ä½ç½®æ—¶ã€‚å¦‚ä¸‹å›¾å°±æ¸…æ™°åœ°å®ƒæ˜¾ç¤ºäº†æ¯ä½ç¾å›½æ€»ç»Ÿä½•æ—¶å¼€å§‹å’Œç»“æŸå…¶ä»»æœŸï¼š presidential %&gt;% mutate(id = 33 + row_number()) %&gt;% ggplot(aes(start, id)) + geom_point() + # ç‚¹å±•å›¾ï¼Œä»¥ç‚¹ä¸ºä¸­å¿ƒå‘ x æ–¹å‘å»¶ä¼¸çº¿æ¡ï¼Œy æ–¹å‘é”™å¼€æ•°æ® geom_segment(aes(xend = end, yend = id)) + scale_x_date(NULL, breaks = presidential$start, date_labels = &quot;&#39;%y&quot;) 22.3.2 å›¾ä¾‹ å›¾ä¾‹ä¹Ÿæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ï¼Œæ¯”å¦‚å®ƒçš„ä½ç½®ï¼š base &lt;- ggplot(mpg, aes(displ, hwy)) + geom_point(aes(colour = class)) base + theme(legend.position = &quot;left&quot;) base + theme(legend.position = &quot;top&quot;) base + theme(legend.position = &quot;bottom&quot;) base + theme(legend.position = &quot;right&quot;) # é»˜è®¤ "],["404.html", "404 Not Found", " 404 Not Found æ‰¾ä¸åˆ°æ‚¨è¦æ‰¾çš„é¡µé¢ï¼ˆå¯èƒ½è¢«ç§»åŠ¨æˆ–é‡å‘½åï¼‰ã€‚ æ‚¨å¯èƒ½éœ€è¦å°è¯•ä½¿ç”¨æœç´¢åŠŸèƒ½æŸ¥æ‰¾é¡µé¢çš„æ–°ä½ç½®ï¼Œæˆ–ä½¿ç”¨å†…å®¹è¡¨æŸ¥æ‰¾æ‰€éœ€çš„é¡µé¢ã€‚ "]]
